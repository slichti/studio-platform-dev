
> api@0.0.0 test:integration
> vitest --config vitest.config.integration.ts test/integration/quizzes.integration.test.ts --run


 RUN  v3.2.4 /Users/slichti/GitHub/studio-platform-dev/packages/api

Using vars defined in .dev.vars
[vpw:debug] Adding `enable_nodejs_tty_module` compatibility flag during tests as this feature is needed to support the Vitest runner.
[vpw:debug] Adding `enable_nodejs_fs_module` compatibility flag during tests as this feature is needed to support the Vitest runner.
[vpw:debug] Adding `enable_nodejs_http_modules` compatibility flag during tests as this feature is needed to support the Vitest runner.
[vpw:debug] Adding `enable_nodejs_perf_hooks_module` compatibility flag during tests as this feature is needed to support the Vitest runner.
[vpw:info] Starting isolated runtimes for vitest.config.integration.ts...
 ❯ test/integration/quizzes.integration.test.ts (3 tests | 3 skipped) 13ms
   ↓ Course Quiz System (Integration) > should create and retrieve a quiz with questions
   ↓ Course Quiz System (Integration) > should calculate score and pass/fail for a submission
   ↓ Course Quiz System (Integration) > should return quizzes within a Course collection

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  test/integration/quizzes.integration.test.ts > Course Quiz System (Integration)
TypeError: Cannot read properties of undefined (reading 'prepare')
 ❯ setupTestDb test/integration/test-utils.ts:32:18
     30| 
     31|     for (const table of tables) {
     32|         await d1.prepare(`DROP TABLE IF EXISTS ${table}`).run();
       |                  ^
     33|     }
     34| 
 ❯ test/integration/quizzes.integration.test.ts:14:29

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/1]⎯


 Test Files  1 failed (1)
      Tests  3 skipped (3)
   Start at  08:54:11
   Duration  1.60s (transform 90ms, setup 22ms, collect 237ms, tests 13ms, environment 0ms, prepare 163ms)

[vpw:debug] Shutting down runtimes...
npm error Lifecycle script `test:integration` failed with error:
npm error code 1
npm error path /Users/slichti/GitHub/studio-platform-dev/packages/api
npm error workspace api@0.0.0
npm error location /Users/slichti/GitHub/studio-platform-dev/packages/api
npm error command failed
npm error command sh -c vitest --config vitest.config.integration.ts test/integration/quizzes.integration.test.ts --run
