import{jsxs as t,jsx as i}from"react/jsx-runtime";import{useLoaderData as g}from"react-router";import{Check as m}from"lucide-react";import{toast as o}from"sonner";import{a as p}from"./server-build-tAMGW7nt.js";import"react-router-dom";import"isbot";import"react-dom/server";import"react";import"@clerk/react-router";import"@clerk/react-router/server";import"@tanstack/react-query";import"isomorphic-dompurify";import"fuse.js";import"clsx";import"tailwind-merge";import"date-fns";import"@headlessui/react";import"class-variance-authority";/* empty css                    */import"react-error-boundary";import"react-easy-crop";import"recharts";import"@stripe/stripe-js";import"@stripe/react-stripe-js";import"react-qr-code";function V(){const{tenant:d,usage:e,plans:h,slug:u,token:b}=g(),l={};(h||[]).forEach(n=>{const s=n.prices?.monthly??0;l[n.slug]={name:n.name,price:s===0?"Free":`$${s/100}/mo`,students:"Unlimited",storage:"Included",...n}});const r=l[d.features?.includes("white_label")?"scale":d.tier||"launch"]||l.launch||{name:"Unknown",price:"N/A"},c=async()=>{try{const n=await p("/tenant/portal",b,{method:"POST",body:JSON.stringify({returnUrl:window.location.href}),headers:{"X-Tenant-Slug":u}});n.url?window.location.href=n.url:o.error("Could not load billing portal. Please contact support.")}catch{o.error("Failed to redirect to billing portal.")}},a=(n,s)=>s==="Unlimited"?0:Math.min(100,n/s*100);return t("div",{className:"max-w-4xl mx-auto py-8 px-4",children:[i("h1",{className:"text-2xl font-bold mb-6 text-zinc-900 dark:text-zinc-100",children:"Billing & Subscription"}),t("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[t("div",{className:"md:col-span-2 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-6 shadow-sm",children:[t("div",{className:"flex justify-between items-start mb-4",children:[t("div",{children:[i("div",{className:"text-sm text-zinc-500 uppercase font-semibold tracking-wide",children:"Current Plan"}),i("h2",{className:"text-3xl font-bold text-zinc-900 dark:text-zinc-100 mt-1",children:r.name}),i("p",{className:"text-zinc-500",children:r.price})]}),i("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide ${d.subscriptionStatus==="active"?"bg-green-100 text-green-800":"bg-amber-100 text-amber-800"}`,children:d.subscriptionStatus||"Active"})]}),t("div",{className:"space-y-4 mt-6",children:[t("div",{children:[t("div",{className:"flex justify-between text-sm mb-1",children:[i("span",{className:"font-medium text-zinc-700 dark:text-zinc-300",children:"Students"}),t("span",{className:"text-zinc-500",children:[e.students," / ",r.students]})]}),i("div",{className:"h-2 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden",children:i("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${a(e.students,r.students)}%`}})})]}),t("div",{children:[t("div",{className:"flex justify-between text-sm mb-1",children:[i("span",{className:"font-medium text-zinc-700 dark:text-zinc-300",children:"Storage (GB)"}),t("span",{className:"text-zinc-500",children:[e.storageGB.toFixed(1)," / ",r.storage," GB"]})]}),i("div",{className:"h-2 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden",children:i("div",{className:"h-full bg-purple-600 rounded-full",style:{width:`${a(e.storageGB,r.storage)}%`}})})]}),(e.streamingLimit===-1||e.streamingLimit>0)&&t("div",{children:[t("div",{className:"flex justify-between text-sm mb-1",children:[i("span",{className:"font-medium text-zinc-700 dark:text-zinc-300",children:"VOD Minutes (Stored)"}),t("span",{className:"text-zinc-500",children:[e.streamingUsage||0," / ",e.streamingLimit===-1?"Unlimited":e.streamingLimit]})]}),i("div",{className:"h-2 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden",children:i("div",{className:`h-full rounded-full ${e.streamingLimit!==-1&&e.streamingUsage>e.streamingLimit?"bg-red-500":"bg-pink-500"}`,style:{width:`${a(e.streamingUsage,e.streamingLimit)}%`}})})]}),t("div",{children:[t("div",{className:"flex justify-between text-sm mb-1",children:[i("span",{className:"font-medium text-zinc-700 dark:text-zinc-300",children:"Emails Sent (Monthly)"}),t("span",{className:"text-zinc-500",children:[e.emailUsage||0," / ",e.emailLimit===-1?"Unlimited":e.emailLimit]})]}),i("div",{className:"h-2 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden",children:i("div",{className:`h-full rounded-full ${e.emailLimit!==-1&&e.emailUsage>e.emailLimit?"bg-red-500":"bg-indigo-500"}`,style:{width:`${a(e.emailUsage,e.emailLimit)}%`}})})]}),(e.smsLimit===-1||e.smsLimit>0)&&t("div",{children:[t("div",{className:"flex justify-between text-sm mb-1",children:[i("span",{className:"font-medium text-zinc-700 dark:text-zinc-300",children:"SMS Sent (Monthly)"}),t("span",{className:"text-zinc-500",children:[e.smsUsage||0," / ",e.smsLimit===-1?"Unlimited":e.smsLimit]})]}),i("div",{className:"h-2 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden",children:i("div",{className:`h-full rounded-full ${e.smsLimit!==-1&&e.smsUsage>e.smsLimit?"bg-red-500":"bg-blue-500"}`,style:{width:`${a(e.smsUsage,e.smsLimit)}%`}})})]})]})]}),t("div",{className:"bg-zinc-50 dark:bg-zinc-900/50 border border-zinc-200 dark:border-zinc-800 rounded-xl p-6",children:[i("h3",{className:"font-semibold text-zinc-900 dark:text-zinc-100 mb-4",children:"Manage Subscription"}),t("div",{className:"space-y-3",children:[i("button",{onClick:c,className:"w-full py-2 bg-white dark:bg-zinc-800 border border-zinc-300 dark:border-zinc-700 text-zinc-700 dark:text-zinc-300 rounded-lg hover:bg-zinc-50 dark:hover:bg-zinc-750 font-medium text-sm transition-colors cursor-pointer",children:"Update Payment Method"}),i("button",{onClick:c,className:"w-full py-2 bg-white dark:bg-zinc-800 border border-zinc-300 dark:border-zinc-700 text-zinc-700 dark:text-zinc-300 rounded-lg hover:bg-zinc-50 dark:hover:bg-zinc-750 font-medium text-sm transition-colors cursor-pointer",children:"View Invoices"}),i("div",{className:"pt-4 border-t border-zinc-200 dark:border-zinc-800",children:i("button",{onClick:c,className:"w-full py-2 bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 rounded-lg hover:bg-zinc-800 dark:hover:opacity-90 font-medium text-sm transition-colors cursor-pointer",children:"Upgrade Plan"})})]})]})]}),t("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl overflow-hidden",children:[i("div",{className:"px-6 py-4 border-b border-zinc-200 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-900/50",children:i("h3",{className:"font-semibold text-zinc-900 dark:text-zinc-100",children:"Plan Features"})}),t("div",{className:"p-6 grid gap-4",children:[t("div",{className:"flex items-center gap-3",children:[i(m,{className:"text-green-600",size:18}),t("span",{className:"text-zinc-700 dark:text-zinc-300",children:["Zoom Integration: ",i("span",{className:"font-medium",children:r.name==="Basic"?"Not Included":"Included"})]})]}),t("div",{className:"flex items-center gap-3",children:[i(m,{className:"text-green-600",size:18}),t("span",{className:"text-zinc-700 dark:text-zinc-300",children:["Locations: ",i("span",{className:"font-medium",children:r.name==="Basic"?"1":r.name==="Growth"?"3":"Unlimited"})]})]})]})]})]})}export{V as default};
