import{jsxs as n,jsx as e,Fragment as re}from"react/jsx-runtime";import{useLoaderData as $t,useNavigate as Ut,Link as Ft}from"react-router";import{a as z,M as R,E as jt,C as G,Y as _t,P as Gt}from"./server-build-DYgJutU4.js";import{useState as s,useEffect as oe,Fragment as qt}from"react";import{useAuth as ce}from"@clerk/react-router";import{Globe as Te,Users as Vt,LogIn as De,Bell as Me,Settings as Wt,AlertCircle as Zt,User as Bt,Trash2 as Yt,Activity as q,Plus as Jt,X as Ht,Loader2 as Kt,CheckSquare as ke,Square as Ce,Download as Qt,AlertTriangle as se,Smartphone as Xt,MessagesSquare as en,CreditCard as Se,Video as tn,Monitor as nn,ShoppingCart as an,MessageSquare as ln,Mail as sn,ChevronDown as rn,ChevronRight as on}from"lucide-react";import"react-router-dom";import"isbot";import"react-dom/server";import"@clerk/react-router/server";import"@tanstack/react-query";import"sonner";import"isomorphic-dompurify";import"fuse.js";import"clsx";import"tailwind-merge";import"date-fns";import"@headlessui/react";import"class-variance-authority";/* empty css                    */import"react-error-boundary";import"react-easy-crop";import"recharts";import"@stripe/stripe-js";import"@stripe/react-stripe-js";import"react-qr-code";function cn({t,showFinancials:a,subscriptionDetails:f,tenantFeatures:r,tenantStats:y,invoices:p,featuresLoading:k,exportLoading:x,platformConfig:w,FEATURES:L,handlers:c}){const C=f[t.id]||{},T=p[t.id]||[];return n("div",{className:"bg-white dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6 shadow-inner space-y-6",children:[n("div",{className:"bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-4 flex flex-col md:flex-row gap-6 justify-between items-center",children:[n("div",{className:"flex items-center gap-4",children:[n("div",{children:[e("div",{className:"text-[10px] uppercase text-zinc-500 font-bold mb-1",children:"Subscription Information"}),n("div",{className:"flex items-center gap-2",children:[e("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium capitalize ${t.subscriptionStatus==="active"?"bg-green-100 text-green-800":t.subscriptionStatus==="past_due"?"bg-orange-100 text-orange-800":t.subscriptionStatus==="canceled"?"bg-red-100 text-red-800":"bg-zinc-200 text-zinc-800"}`,children:t.subscriptionStatus==="past_due"?"Past Due":t.subscriptionStatus||"trialing"}),n("select",{className:"text-xs bg-white dark:bg-zinc-800 border border-zinc-300 dark:border-zinc-700 rounded px-2 py-1 outline-none focus:border-blue-500 text-zinc-900 dark:text-zinc-100",value:C?.interval||"monthly",onChange:l=>c.handleIntervalChange(t.id,l.target.value),children:[e("option",{value:"monthly",children:"Monthly"}),e("option",{value:"annual",children:"Annual"})]})]}),C?.cancelAtPeriodEnd&&e("div",{className:"text-[10px] text-red-600 font-medium mt-1",children:"Cancels at end of period"})]}),e("div",{className:"h-8 w-px bg-zinc-200 dark:bg-zinc-800 hidden md:block"}),n("div",{children:[e("div",{className:"text-[10px] uppercase text-zinc-500 font-bold mb-1",children:"Period Ends"}),n("div",{className:"flex items-center gap-2",children:[e("input",{type:"date",className:"text-xs border border-zinc-300 dark:border-zinc-700 rounded px-2 py-1 bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100 hover:border-zinc-400 transition-colors",defaultValue:t.currentPeriodEnd?new Date(t.currentPeriodEnd).toISOString().split("T")[0]:"",onBlur:l=>{l.target.value&&l.target.value!==(t.currentPeriodEnd?new Date(t.currentPeriodEnd).toISOString().split("T")[0]:"")&&c.setRenewalDateChange({id:t.id,date:l.target.value})}}),n("div",{className:"flex text-[10px] gap-1",children:[e("button",{onClick:l=>{l.stopPropagation(),c.handleSubscriptionUpdate(t.id,30)},className:"px-1.5 py-0.5 bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"+30d"}),e("button",{onClick:l=>{l.stopPropagation(),c.handleSubscriptionUpdate(t.id,9999)},className:"px-1.5 py-0.5 bg-zinc-100 dark:bg-zinc-700 text-zinc-600 dark:text-zinc-300 rounded hover:bg-zinc-200 dark:hover:bg-zinc-600",children:"∞"})]})]}),n("div",{className:"flex gap-2 mt-1",children:[e("button",{onClick:l=>{l.stopPropagation(),c.handleCancelSubscription(t.id)},className:"text-[10px] text-red-600 hover:underline",children:"Cancel Subs"}),e("button",{onClick:l=>{l.stopPropagation(),c.openRefundModal(t.id)},className:"text-[10px] text-zinc-500 hover:text-zinc-800 hover:underline",children:"Refund"})]})]})]}),n("div",{className:"flex items-center gap-6 border-l border-zinc-200 dark:border-zinc-800 pl-6 border-l-0 md:border-l",children:[n("div",{children:[e("label",{className:"text-[10px] uppercase text-zinc-400 font-bold block mb-1",children:"SMS Limit"}),e("input",{type:"number",className:`w-20 text-xs border rounded px-2 py-1 ${t.billingExempt?"bg-zinc-100 dark:bg-zinc-800/50 text-zinc-400 dark:text-zinc-500":"bg-white dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700 text-zinc-900 dark:text-zinc-100"}`,defaultValue:t.smsLimit||0,onBlur:l=>c.handleLimitUpdate(t.id,"smsLimit",parseInt(l.target.value))}),e("div",{className:"mt-2 w-full",children:t.billingExempt?e("div",{className:"text-center",children:e("span",{className:"text-[10px] uppercase font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full",children:"Unlimited"})}):n("div",{className:"space-y-1",children:[n("div",{className:"flex justify-between text-[10px] text-zinc-500",children:[n("span",{children:[t.smsUsage||0," sent"]}),n("span",{children:[Math.round((t.smsUsage||0)/(t.smsLimit||1)*100),"%"]})]}),e("div",{className:"h-1.5 w-24 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden",children:e("div",{className:`h-full rounded-full transition-all ${(t.smsUsage||0)>=(t.smsLimit||0)?"bg-red-500":(t.smsUsage||0)/(t.smsLimit||1)>.8?"bg-amber-400":"bg-emerald-500"}`,style:{width:`${Math.min(100,(t.smsUsage||0)/(t.smsLimit||1)*100)}%`}})}),n("div",{className:"text-[10px] text-zinc-400 text-right",children:[t.smsLimit||0," limit"]})]})})]}),n("div",{children:[e("label",{className:"text-[10px] uppercase text-zinc-400 font-bold block mb-1",children:"Email Limit"}),e("input",{type:"number",className:`w-20 text-xs border rounded px-2 py-1 ${t.billingExempt?"bg-zinc-100 dark:bg-zinc-800/50 text-zinc-400 dark:text-zinc-500":"bg-white dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700 text-zinc-900 dark:text-zinc-100"}`,defaultValue:t.emailLimit||0,onBlur:l=>c.handleLimitUpdate(t.id,"emailLimit",parseInt(l.target.value))}),e("div",{className:"mt-2 w-full",children:t.billingExempt?e("div",{className:"text-center",children:e("span",{className:"text-[10px] uppercase font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full",children:"Unlimited"})}):n("div",{className:"space-y-1",children:[n("div",{className:"flex justify-between text-[10px] text-zinc-500",children:[n("span",{children:[t.emailUsage||0," sent"]}),n("span",{children:[Math.round((t.emailUsage||0)/(t.emailLimit||1)*100),"%"]})]}),e("div",{className:"h-1.5 w-24 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden",children:e("div",{className:`h-full rounded-full transition-all ${(t.emailUsage||0)>=(t.emailLimit||0)?"bg-red-500":(t.emailUsage||0)/(t.emailLimit||1)>.8?"bg-amber-400":"bg-emerald-500"}`,style:{width:`${Math.min(100,(t.emailUsage||0)/(t.emailLimit||1)*100)}%`}})}),n("div",{className:"text-[10px] text-zinc-400 text-right",children:[t.emailLimit||0," limit"]})]})})]}),n("div",{className:"flex flex-col gap-1 pt-0",children:[n("div",{className:"flex items-center gap-2",children:[e("input",{type:"checkbox",id:`exempt-${t.id}`,className:"rounded border-zinc-300 dark:border-zinc-700 dark:bg-zinc-800 text-blue-600 focus:ring-blue-500",defaultChecked:!!t.billingExempt,onChange:l=>c.handleLimitUpdate(t.id,"billingExempt",l.target.checked)}),e("label",{className:"text-xs text-zinc-700 dark:text-zinc-300 cursor-pointer select-none font-medium",htmlFor:`exempt-${t.id}`,children:"Billing Exempt"})]}),t.billingExempt&&e("span",{className:"text-[10px] text-zinc-400 pl-5",children:"Limits ignored"}),!t.billingExempt&&e("button",{onClick:l=>{l.stopPropagation(),c.handleWaiveUsage(t.id)},className:"mt-2 text-[10px] text-zinc-400 hover:text-blue-600 hover:underline text-left pl-5",children:"Waive Usage (Reset)"})]})]})]}),n("div",{className:"bg-white dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 rounded-lg p-4 mt-4 mb-6",children:[e("h4",{className:"text-[10px] uppercase text-zinc-500 font-bold mb-3",children:"Testing & Access"}),n("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[n("a",{href:`/?__studio=${t.slug}`,target:"_blank",rel:"noreferrer",className:"flex items-center gap-2 text-sm text-blue-600 hover:text-blue-800 font-medium bg-blue-50 border border-blue-200 px-3 py-2 rounded-md transition-colors w-fit",onClick:l=>l.stopPropagation(),children:[e(Te,{size:16}),"Open Public Site"]}),n("span",{className:"text-xs text-zinc-500 flex items-center gap-1.5",children:[n("span",{className:"bg-zinc-100 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 px-1.5 py-0.5 rounded text-[10px] font-mono",children:["?__studio=",t.slug]}),e("span",{className:"italic",children:"Use Incognito window to view as guest."})]})]})]}),n("div",{className:"bg-white dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 rounded-lg p-4 mt-4 mb-6",children:[e("h4",{className:"text-[10px] uppercase text-zinc-500 font-bold mb-3",children:"Ownership & Access"}),n("div",{className:"flex flex-wrap items-center gap-3",children:[n("button",{onClick:l=>{l.stopPropagation(),c.setSelectedTenantForOwners({id:t.id,name:t.name}),c.setOwnersModalOpen(!0)},className:"flex items-center gap-2 text-sm text-zinc-700 dark:text-zinc-300 font-medium bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 px-3 py-2 rounded-md hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors",children:[e(Vt,{size:16}),"Manage Owners"]}),n("button",{className:"flex items-center gap-2 text-sm text-zinc-700 dark:text-zinc-300 font-medium bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 px-3 py-2 rounded-md hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors",onClick:l=>{l.stopPropagation(),c.handleImpersonate({id:t.id,name:t.name})},children:[e(De,{size:16}),"Log in as Owner"]}),n("button",{className:"flex items-center gap-2 text-sm text-zinc-700 dark:text-zinc-300 font-medium bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 px-3 py-2 rounded-md hover:bg-zinc-100 dark:hover:bg-zinc-800 transition-colors",onClick:l=>{l.stopPropagation(),c.openNotifyModal(t.id)},children:[e(Me,{size:16}),"Send Notification"]})]})]}),n("div",{className:"bg-white dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 rounded-lg p-4 mt-4 mb-6",children:[n("div",{className:"flex items-center justify-between mb-4",children:[e("div",{className:"text-[10px] uppercase text-zinc-500 font-bold",children:"Lifecycle & Data"}),e("div",{className:"flex gap-2",children:t.status==="archived"?e("button",{onClick:l=>{l.stopPropagation(),c.handleRestore(t.id)},className:"text-xs bg-emerald-100 text-emerald-800 px-2 py-1 rounded hover:bg-emerald-200",children:"Restore Tenant"}):n(re,{children:[e("button",{onClick:l=>{l.stopPropagation(),c.handleGracePeriod(t.id,!t.studentAccessDisabled)},className:`text-xs px-3 py-1.5 rounded-md border font-medium transition-colors ${t.studentAccessDisabled?"bg-amber-100 border-amber-200 text-amber-800 hover:bg-amber-200":"bg-white border-zinc-300 text-zinc-700 hover:bg-zinc-50"}`,children:t.studentAccessDisabled?"Enable Student Access":"Start Grace Period"}),e("button",{onClick:l=>{l.stopPropagation(),c.handleArchive(t.id)},className:"text-xs bg-red-50 text-red-600 border border-red-100 px-2 py-1 rounded hover:bg-red-100",children:"Archive"})]})})]}),n("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[n("button",{onClick:l=>{l.stopPropagation(),c.setExportModal({isOpen:!0,tenantId:t.id,tenantName:t.name,dataType:"subscribers"})},className:"text-left bg-zinc-50 border border-zinc-200 rounded p-2 hover:bg-zinc-100 group transition-all",children:[n("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e("span",{className:"bg-white p-0.5 rounded border border-zinc-200 text-zinc-500 group-hover:text-blue-600 text-[10px]",children:"⬇"}),e("span",{className:"text-xs font-bold text-zinc-700",children:"Subscribers"})]}),e("div",{className:"text-[10px] text-zinc-500 truncate",children:"View & select members"})]}),n("button",{onClick:l=>{l.stopPropagation(),c.setExportModal({isOpen:!0,tenantId:t.id,tenantName:t.name,dataType:"financials"})},className:"text-left bg-zinc-50 border border-zinc-200 rounded p-2 hover:bg-zinc-100 group transition-all",children:[n("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e("span",{className:"bg-white p-0.5 rounded border border-zinc-200 text-zinc-500 group-hover:text-green-600 text-[10px]",children:"⬇"}),e("span",{className:"text-xs font-bold text-zinc-700",children:"Financials"})]}),e("div",{className:"text-[10px] text-zinc-500 truncate",children:"View & select transactions"})]}),n("button",{onClick:l=>{l.stopPropagation(),c.setExportModal({isOpen:!0,tenantId:t.id,tenantName:t.name,dataType:"products"})},className:"text-left bg-zinc-50 border border-zinc-200 rounded p-2 hover:bg-zinc-100 group transition-all",children:[n("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e("span",{className:"bg-white p-0.5 rounded border border-zinc-200 text-zinc-500 group-hover:text-purple-600 text-[10px]",children:"⬇"}),e("span",{className:"text-xs font-bold text-zinc-700",children:"Products"})]}),e("div",{className:"text-[10px] text-zinc-500 truncate",children:"View & select products"})]}),n("button",{onClick:l=>{l.stopPropagation(),c.handleExport(t.id,"classes")},disabled:!!x,className:"text-left bg-zinc-50 border border-zinc-200 rounded p-2 hover:bg-zinc-100 disabled:opacity-50 group transition-all",children:[n("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e("span",{className:"bg-white p-0.5 rounded border border-zinc-200 text-zinc-500 group-hover:text-amber-600 text-[10px]",children:"⬇"}),e("span",{className:"text-xs font-bold text-zinc-700",children:"Classes"})]}),e("div",{className:"text-[10px] text-zinc-500 truncate",children:"Schedule & Attendance"})]}),n("button",{onClick:l=>{l.stopPropagation(),c.handleExport(t.id,"vod")},disabled:!!x,className:"text-left bg-zinc-50 border border-zinc-200 rounded p-2 hover:bg-zinc-100 disabled:opacity-50 group transition-all",children:[n("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e("span",{className:"bg-white p-0.5 rounded border border-zinc-200 text-zinc-500 group-hover:text-red-500 text-[10px]",children:"⬇"}),e("span",{className:"text-xs font-bold text-zinc-700",children:"VOD Usage"})]}),e("div",{className:"text-[10px] text-zinc-500 truncate",children:"Storage & Streaming"})]})]})]}),n("div",{children:[e("h4",{className:"text-xs font-bold text-zinc-500 uppercase tracking-wider mb-3",children:"Recent Payments"}),e("div",{className:"bg-white border border-zinc-200 rounded-lg overflow-hidden",children:n("table",{className:"w-full text-left text-xs",children:[e("thead",{className:"bg-zinc-50 border-b border-zinc-200 text-zinc-500",children:n("tr",{children:[e("th",{className:"px-4 py-2 font-medium",children:"Date"}),e("th",{className:"px-4 py-2 font-medium",children:"Amount"}),e("th",{className:"px-4 py-2 font-medium",children:"Status"}),e("th",{className:"px-4 py-2 font-medium text-right",children:"Actions"})]})}),e("tbody",{className:"divide-y divide-zinc-100",children:T.length?T.map(l=>n("tr",{className:"hover:bg-zinc-50",children:[e("td",{className:"px-4 py-2 text-zinc-600",children:new Date(l.date).toLocaleDateString()}),n("td",{className:"px-4 py-2 font-medium text-zinc-900",children:["$",(l.amount/100).toFixed(2)]}),e("td",{className:"px-4 py-2",children:e("span",{className:`inline-flex px-1.5 py-0.5 rounded text-[10px] font-medium capitalize ${l.status==="paid"?"bg-emerald-100 text-emerald-800":l.status==="open"?"bg-blue-100 text-blue-800":"bg-zinc-100 text-zinc-600"}`,children:l.status})}),n("td",{className:"px-4 py-2 text-right flex justify-end gap-3",children:[l.hostedUrl&&e("a",{href:l.hostedUrl,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:underline",children:"Invoice"}),l.paymentIntentId&&l.amount>0&&l.status==="paid"&&e("button",{onClick:()=>{c.setSelectedTenantForRefund(t.id),c.setRefundPaymentIntent(l.paymentIntentId),c.setRefundAmount(""),c.setRefundModalOpen(!0)},className:"text-zinc-500 hover:text-red-600",children:"Refund"})]})]},l.id)):e("tr",{children:e("td",{colSpan:4,className:"px-4 py-4 text-center text-zinc-400 italic",children:"No payment history available"})})})]})})]}),k?e("div",{className:"text-sm text-zinc-500 py-2",children:"Loading capabilities..."}):e("div",{className:"space-y-6",children:e("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:L.map(l=>{const u=(r[t.id]||{})[l.key]||{enabled:!1,source:"manual"},A=`feature_${l.key}`,D=w?.find(E=>E.key===A),v=!D||!D.enabled;return n("div",{className:`flex items-center justify-between p-3 border rounded-md ${v?"bg-zinc-100 opacity-60":"bg-zinc-50"}`,children:[n("div",{className:"flex items-center gap-3",children:[e(l.icon,{size:18,className:v?"text-zinc-400":"text-zinc-500"}),n("div",{children:[e("div",{className:`text-sm font-medium ${v?"text-zinc-500":"text-zinc-900"}`,children:l.label}),e("div",{className:"text-xs text-zinc-500",children:v?"Disabled by Platform":`Source: ${u.source}`}),e("div",{className:"text-[10px] text-zinc-400 mt-0.5 truncate max-w-[180px]",title:l.sections,children:l.sections})]})]}),n("div",{className:"flex items-center gap-2",children:[l.key==="zoom"&&u.enabled&&!v&&e("button",{onClick:E=>{E.stopPropagation(),c.openZoomConfig(t.id)},className:"p-1 text-zinc-500 hover:text-blue-600 hover:bg-zinc-200 rounded",title:"Configure Zoom Credentials",children:e(Wt,{size:16})}),e("button",{onClick:E=>{E.stopPropagation(),!v&&c.handleFeatureToggle(t.id,l.key,u.enabled)},disabled:v,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 ${v?"bg-zinc-300 cursor-not-allowed":u.enabled?"bg-blue-600":"bg-gray-200"}`,children:e("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${u.enabled?"translate-x-6":"translate-x-1"}`})})]})]},l.key)})})})]})}function dn({isOpen:t,onClose:a,tenantId:f,tenantName:r}){const{getToken:y}=ce(),[p,k]=s([]),[x,w]=s(!1),[L,c]=s(!1),[C,T]=s(""),[l,u]=s(null),[A,D]=s(null);oe(()=>{t&&f?v():(k([]),T(""),u(null),D(null))},[t,f]);const v=async()=>{if(f){w(!0);try{const m=await y(),b=await z(`/admin/tenants/${f}/owners`,m);k(b)}catch(m){u(m.message||"Failed to load owners")}finally{w(!1)}}},E=async m=>{if(m.preventDefault(),!(!f||!C)){c(!0),u(null);try{const b=await y(),I=await z(`/admin/tenants/${f}/owners`,b,{method:"POST",body:JSON.stringify({email:C})});if(I.error)throw new Error(I.error);I.message?D(I.message):(D(`Successfully added ${C} as an owner.`),T(""),v())}catch(b){u(b.message||"Failed to add owner")}finally{c(!1)}}},g=async m=>{if(f&&confirm("Are you sure you want to remove this owner? They will lose administrative access.")){w(!0);try{const b=await y(),I=await z(`/admin/tenants/${f}/owners/${m}`,b,{method:"DELETE"});if(I.error)throw new Error(I.error);D("Owner removed successfully."),v()}catch(b){u(b.message||"Failed to remove owner")}finally{w(!1)}}};return e(R,{isOpen:t,onClose:a,title:`Manage Owners: ${r}`,maxWidth:"max-w-2xl",children:n("div",{className:"space-y-6",children:[l&&n("div",{className:"bg-red-50 dark:bg-red-900/30 text-red-700 dark:text-red-200 p-3 rounded-lg text-sm flex items-start gap-2",children:[e(Zt,{size:16,className:"mt-0.5 shrink-0"}),e("div",{children:l})]}),A&&e("div",{className:"bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-200 p-3 rounded-lg text-sm",children:A}),n("div",{className:"space-y-2",children:[e("h4",{className:"text-sm font-semibold text-zinc-700 dark:text-zinc-300",children:"Current Owners"}),e("div",{className:"bg-zinc-50 dark:bg-zinc-800/50 rounded-lg border border-zinc-200 dark:border-zinc-800 divide-y divide-zinc-200 dark:divide-zinc-800",children:x&&p.length===0?e("div",{className:"p-4 text-center text-sm text-zinc-500",children:"Loading..."}):p.length===0?e("div",{className:"p-4 text-center text-sm text-zinc-500",children:"No owners found (this should not happen)."}):p.map(m=>n("div",{className:"p-3 flex items-center justify-between",children:[n("div",{className:"flex items-center gap-3",children:[e("div",{className:"h-8 w-8 bg-blue-100 dark:bg-blue-900/50 rounded-full flex items-center justify-center text-blue-700 dark:text-blue-300",children:e(Bt,{size:16})}),n("div",{children:[n("div",{className:"text-sm font-medium text-zinc-900 dark:text-zinc-100",children:[m.profile?.firstName||"User"," ",m.profile?.lastName||""]}),e("div",{className:"text-xs text-zinc-500 dark:text-zinc-400",children:m.email})]})]}),e("button",{onClick:()=>g(m.userId),className:"text-zinc-400 hover:text-red-600 transition-colors p-1",title:"Remove Owner Access",disabled:p.length<=1,children:e(Yt,{size:16})})]},m.userId))}),p.length<=1&&p.length>0&&e("p",{className:"text-xs text-zinc-400 italic",children:"You cannot remove the last owner."})]}),n("div",{className:"border-t border-zinc-200 dark:border-zinc-800 pt-6",children:[e("h4",{className:"text-sm font-semibold text-zinc-700 dark:text-zinc-300 mb-3",children:"Add New Owner"}),n("form",{onSubmit:E,className:"flex gap-2",children:[e("input",{type:"email",required:!0,placeholder:"Enter user email address",className:"flex-1 text-sm border border-zinc-300 dark:border-zinc-700 rounded-lg px-3 py-2 bg-white dark:bg-zinc-800 focus:ring-2 focus:ring-blue-500 outline-none",value:C,onChange:m=>T(m.target.value)}),n("button",{type:"submit",disabled:L||!C,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-medium text-sm flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[L?e(q,{className:"animate-spin",size:16}):e(Jt,{size:16}),"Add Owner"]})]}),e("p",{className:"text-xs text-zinc-500 mt-2",children:"The user must already have a platform account."})]})]})})}const mn={subscribers:{title:"Subscribers",endpoint:"subscribers",columns:[{key:"email",label:"Email"},{key:"firstName",label:"First Name"},{key:"lastName",label:"Last Name"},{key:"roles",label:"Roles"},{key:"status",label:"Status"},{key:"joinedAt",label:"Joined"}]},financials:{title:"Financial Transactions",endpoint:"transactions",columns:[{key:"memberEmail",label:"Member Email"},{key:"memberName",label:"Member Name"},{key:"planName",label:"Plan"},{key:"amount",label:"Amount"},{key:"status",label:"Status"},{key:"createdAt",label:"Date"}]},products:{title:"Products",endpoint:"products",columns:[{key:"sku",label:"SKU"},{key:"name",label:"Name"},{key:"price",label:"Price"},{key:"quantity",label:"Qty"},{key:"category",label:"Category"},{key:"isActive",label:"Active"}]}};function un({isOpen:t,onClose:a,tenantId:f,tenantName:r,dataType:y}){const[p,k]=s([]),[x,w]=s(new Set),[L,c]=s(!1),[C,T]=s(null),{getToken:l}=ce(),u=mn[y];oe(()=>{t?A():(k([]),w(new Set),T(null))},[t,f,y]);const A=async()=>{c(!0),T(null);try{const g=await l(),m=await z(`/admin/tenants/${f}/${u.endpoint}`,g);k(m)}catch(g){T(g.message)}finally{c(!1)}},D=g=>{const m=new Set(x);m.has(g)?m.delete(g):m.add(g),w(m)},v=()=>{x.size===p.length?w(new Set):w(new Set(p.map(g=>g.id)))},E=()=>{const g=p.filter(_=>x.has(_.id));if(g.length===0)return;const m=u.columns.map(_=>_.label),b=g.map(_=>u.columns.map(j=>{let N=_[j.key];return(N instanceof Date||typeof N=="number"&&j.key.includes("At"))&&(N=new Date(N).toLocaleDateString()),typeof N=="boolean"&&(N=N?"Yes":"No"),(j.key==="amount"||j.key==="price"||j.key==="costPrice")&&(N=`$${(N/100).toFixed(2)}`),typeof N=="string"&&(N.includes(",")||N.includes('"'))&&(N=`"${N.replace(/"/g,'""')}"`),N??""}).join(",")),I=[m.join(","),...b].join(`
`),X=new Blob([I],{type:"text/csv"}),B=URL.createObjectURL(X),F=document.createElement("a");F.href=B,F.download=`${r.replace(/\s+/g,"_")}_${y}_export.csv`,document.body.appendChild(F),F.click(),document.body.removeChild(F),URL.revokeObjectURL(B)};return t?e("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n("div",{className:"bg-white rounded-xl w-full max-w-5xl max-h-[90vh] flex flex-col shadow-2xl",children:[n("div",{className:"px-6 py-4 border-b border-zinc-200 flex items-center justify-between",children:[n("div",{children:[e("h2",{className:"text-lg font-semibold text-zinc-900",children:u.title}),e("p",{className:"text-sm text-zinc-500",children:r})]}),e("button",{onClick:a,className:"p-2 hover:bg-zinc-100 rounded-lg",children:e(Ht,{size:20})})]}),e("div",{className:"flex-1 overflow-auto p-6",children:L?n("div",{className:"flex items-center justify-center py-12",children:[e(Kt,{className:"animate-spin text-blue-600",size:32}),e("span",{className:"ml-3 text-zinc-600",children:"Loading data..."})]}):C?n("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg",children:["Error: ",C]}):p.length===0?n("div",{className:"text-center py-12 text-zinc-500",children:["No ",u.title.toLowerCase()," found for this tenant."]}):e("div",{className:"border border-zinc-200 rounded-lg overflow-hidden",children:n("table",{className:"w-full text-sm",children:[e("thead",{className:"bg-zinc-50",children:n("tr",{children:[e("th",{className:"w-12 px-4 py-3 text-left",children:e("button",{onClick:v,className:"text-zinc-600 hover:text-zinc-900",children:x.size===p.length?e(ke,{size:18,className:"text-blue-600"}):e(Ce,{size:18})})}),u.columns.map(g=>e("th",{className:"px-4 py-3 text-left font-medium text-zinc-700",children:g.label},g.key))]})}),e("tbody",{className:"divide-y divide-zinc-100",children:p.map(g=>n("tr",{className:`hover:bg-zinc-50 ${x.has(g.id)?"bg-blue-50":""}`,onClick:()=>D(g.id),children:[e("td",{className:"px-4 py-3",children:x.has(g.id)?e(ke,{size:18,className:"text-blue-600"}):e(Ce,{size:18,className:"text-zinc-400"})}),u.columns.map(m=>{let b=g[m.key];return(b instanceof Date||typeof b=="number"&&m.key.includes("At"))&&(b=new Date(b).toLocaleDateString()),typeof b=="boolean"&&(b=b?e("span",{className:"text-green-600",children:"Yes"}):e("span",{className:"text-zinc-400",children:"No"})),(m.key==="amount"||m.key==="price")&&(b=`$${((b||0)/100).toFixed(2)}`),e("td",{className:"px-4 py-3 text-zinc-700",children:b??"-"},m.key)})]},g.id))})]})})}),n("div",{className:"px-6 py-4 border-t border-zinc-200 flex items-center justify-between bg-zinc-50",children:[n("div",{className:"text-sm text-zinc-600",children:[x.size," of ",p.length," selected"]}),n("div",{className:"flex gap-2",children:[e("button",{onClick:a,className:"px-4 py-2 text-zinc-600 hover:bg-zinc-100 rounded-lg",children:"Cancel"}),n("button",{onClick:E,disabled:x.size===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[e(Qt,{size:16}),"Export Selected to CSV"]})]})]})]})}):null}function pn({state:t,handlers:a,FEATURES:f}){return n(re,{children:[e(jt,{isOpen:t.errorDialog.isOpen,onClose:()=>a.setErrorDialog({...t.errorDialog,isOpen:!1}),title:"Error",message:t.errorDialog.message}),e(R,{isOpen:t.successDialog.isOpen,onClose:()=>{a.setSuccessDialog({...t.successDialog,isOpen:!1}),t.successDialog.shouldRefresh&&window.location.reload()},title:"Success",children:n("div",{className:"space-y-4",children:[e("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:t.successDialog.message}),e("div",{className:"flex justify-end",children:e("button",{onClick:()=>{a.setSuccessDialog({...t.successDialog,isOpen:!1}),t.successDialog.shouldRefresh&&window.location.reload()},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium",children:"Dismiss"})})]})}),e(G,{isOpen:!!t.tierChange,onClose:()=>a.setTierChange(null),onConfirm:a.confirmTierChange,title:"Change Tenant Tier",message:`Are you sure you want to change this tenant to ${t.tierChange?.tier}?`,confirmText:"Change Tier"}),e(G,{isOpen:!!t.intervalChange,onClose:()=>a.setIntervalChange(null),onConfirm:a.confirmIntervalChange,title:"Change Billing Interval",message:`Switch billing interval to ${t.intervalChange?.interval}? This will update the Stripe Subscription immediately.`,confirmText:"Update Interval"}),e(G,{isOpen:!!t.renewalDateChange,onClose:()=>a.setRenewalDateChange(null),onConfirm:a.confirmRenewalDateUpdate,title:"Update Renewal Date",message:`Are you sure you want to update the renewal date to ${t.renewalDateChange?.date}?`,confirmText:"Update Date"}),e(G,{isOpen:!!t.waiveUsageId,onClose:()=>a.setWaiveUsageId(null),onConfirm:a.confirmWaiveUsage,title:"Waive Usage",message:"Are you sure you want to WAIVE all current usage for this tenant? This resets counters to 0.",confirmText:"Waive Usage",isDestructive:!0}),e(G,{isOpen:!!t.restoreId,onClose:()=>a.setRestoreId(null),onConfirm:a.confirmRestore,title:"Restore Tenant",message:"Restore this tenant to active status?",confirmText:"Restore"}),e(R,{isOpen:!!t.archiveId,onClose:()=>{a.setArchiveId(null),a.setArchiveInput("")},title:"Archive Tenant",children:n("div",{className:"space-y-4",children:[n("div",{className:"p-4 bg-red-50 dark:bg-red-950/30 text-red-800 dark:text-red-200 rounded-lg text-sm border border-red-100 dark:border-red-900/50 flex gap-3",children:[e(se,{className:"shrink-0 mt-0.5",size:16}),n("div",{children:[e("strong",{children:"Warning:"})," This will disable all access for the tenant. Data will be retained but the studio will be offline."]})]}),n("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:["To confirm, please type ",e("strong",{children:"ARCHIVE"})," below:"]}),e("input",{type:"text",className:"w-full border border-zinc-300 dark:border-zinc-700 rounded-lg px-3 py-2 text-sm bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100 focus:ring-2 focus:ring-red-500 outline-none",placeholder:"Type ARCHIVE",value:t.archiveInput,onChange:r=>a.setArchiveInput(r.target.value)}),n("div",{className:"flex justify-end gap-2 pt-2",children:[e("button",{onClick:()=>{a.setArchiveInput(""),a.setArchiveId(null)},className:"px-3 py-2 text-zinc-600 dark:text-zinc-400 text-sm",children:"Cancel"}),n("button",{onClick:a.handleArchiveConfirm,disabled:t.archiveInput!=="ARCHIVE"||t.archiveLoading,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-medium disabled:opacity-50 flex items-center gap-2",children:[t.archiveLoading&&e(q,{className:"animate-spin",size:14}),"Archive Tenant"]})]})]})}),e(R,{isOpen:t.deleteModalOpen,onClose:()=>{a.setDeleteModalOpen(!1),a.setTenantToDelete(null),a.setDeleteInput("")},title:"Delete Tenant",children:n("div",{className:"space-y-4",children:[n("div",{className:"p-3 bg-red-50 text-red-700 text-sm rounded border border-red-100 flex items-start gap-2",children:[e(se,{className:"shrink-0 mt-0.5",size:16}),n("div",{children:[e("span",{className:"font-bold block mb-1",children:"Danger: Irreversible Action"}),"This will explicitly delete the tenant and all associated data."]})]}),n("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:["To confirm, please type ",e("strong",{children:"DELETE"})," below:"]}),e("input",{type:"text",className:"w-full text-sm border border-zinc-300 dark:border-zinc-700 rounded px-3 py-2 bg-white dark:bg-zinc-800",placeholder:"DELETE",value:t.deleteInput,onChange:r=>a.setDeleteInput(r.target.value)}),n("div",{className:"flex justify-end gap-2 pt-2",children:[e("button",{onClick:()=>{a.setDeleteModalOpen(!1),a.setTenantToDelete(null),a.setDeleteInput("")},className:"px-3 py-2 text-zinc-600 dark:text-zinc-400 text-sm",children:"Cancel"}),n("button",{onClick:a.handleDeleteTenant,disabled:t.deleteInput!=="DELETE"||t.deleteLoading,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-medium flex items-center gap-2 disabled:opacity-50",children:[t.deleteLoading&&e(q,{className:"animate-spin",size:14}),"Delete Tenant"]})]})]})}),e(dn,{isOpen:t.ownersModalOpen,onClose:()=>{a.setOwnersModalOpen(!1),a.setSelectedTenantForOwners(null)},tenantId:t.selectedTenantForOwners?.id||null,tenantName:t.selectedTenantForOwners?.name||""}),e(R,{isOpen:t.seedModalOpen,onClose:()=>a.setSeedModalOpen(!1),title:"Seed Test Tenant",children:n("div",{className:"space-y-4",children:[e("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:"Configure the parameters for the generated test tenant."}),n("div",{className:"grid grid-cols-2 gap-4",children:[n("div",{children:[e("label",{className:"block text-xs font-semibold text-zinc-700 dark:text-zinc-300 mb-1",children:"Tenant Name (Optional)"}),e("input",{type:"text",className:"w-full text-sm border border-zinc-300 dark:border-zinc-700 rounded px-2 py-1.5 bg-white dark:bg-zinc-800",placeholder:"Auto-generated",value:t.seedOptions.tenantName,onChange:r=>a.setSeedOptions({...t.seedOptions,tenantName:r.target.value})})]}),n("div",{children:[e("label",{className:"block text-xs font-semibold text-zinc-700 dark:text-zinc-300 mb-1",children:"Slug (Optional)"}),e("input",{type:"text",className:"w-full text-sm border border-zinc-300 dark:border-zinc-700 rounded px-2 py-1.5 bg-white dark:bg-zinc-800",placeholder:"Auto-generated",value:t.seedOptions.tenantSlug,onChange:r=>a.setSeedOptions({...t.seedOptions,tenantSlug:r.target.value})})]})]}),n("div",{className:"space-y-3 pt-2",children:[n("div",{children:[e("label",{className:"block text-xs font-semibold text-zinc-700 dark:text-zinc-300 mb-1",children:"Tier"}),n("select",{className:"w-full text-sm border border-zinc-300 dark:border-zinc-700 rounded px-2 py-1.5 bg-white dark:bg-zinc-800",value:t.seedOptions.tier,onChange:r=>a.setSeedOptions({...t.seedOptions,tier:r.target.value}),children:[e("option",{value:"basic",children:"Launch"}),e("option",{value:"growth",children:"Growth"}),e("option",{value:"scale",children:"Scale"})]})]}),n("div",{children:[n("div",{className:"flex justify-between items-center mb-1",children:[e("label",{className:"block text-xs font-semibold text-zinc-700 dark:text-zinc-300",children:"Features"}),n("div",{className:"flex gap-2 text-xs",children:[e("button",{className:`px-2 py-0.5 rounded border ${t.seedOptions.featureMode==="all"?"bg-blue-50 border-blue-200 text-blue-700":"bg-transparent border-zinc-200 text-zinc-500"}`,onClick:()=>a.setSeedOptions({...t.seedOptions,featureMode:"all"}),children:"All"}),e("button",{className:`px-2 py-0.5 rounded border ${t.seedOptions.featureMode==="none"?"bg-blue-50 border-blue-200 text-blue-700":"bg-transparent border-zinc-200 text-zinc-500"}`,onClick:()=>a.setSeedOptions({...t.seedOptions,featureMode:"none"}),children:"None"}),e("button",{className:`px-2 py-0.5 rounded border ${t.seedOptions.featureMode==="custom"?"bg-blue-50 border-blue-200 text-blue-700":"bg-transparent border-zinc-200 text-zinc-500"}`,onClick:()=>a.setSeedOptions({...t.seedOptions,featureMode:"custom"}),children:"Custom"})]})]}),t.seedOptions.featureMode==="custom"&&e("div",{className:"grid grid-cols-2 gap-2 p-2 bg-zinc-50 dark:bg-zinc-800/50 rounded border border-zinc-100 dark:border-zinc-800 h-24 overflow-y-auto",children:f.map(r=>n("label",{className:"flex items-center gap-2 cursor-pointer",children:[e("input",{type:"checkbox",className:"rounded border-zinc-300 text-blue-600 focus:ring-blue-500",checked:t.seedOptions.features.includes(r.key),onChange:y=>{const p=y.target.checked?[...t.seedOptions.features,r.key]:t.seedOptions.features.filter(k=>k!==r.key);a.setSeedOptions({...t.seedOptions,features:p})}}),e("span",{className:"text-xs text-zinc-600 dark:text-zinc-400",children:r.label})]},r.key))})]}),n("div",{children:[n("div",{className:"flex justify-between text-xs font-medium mb-1",children:[e("span",{children:"Owners"}),e("span",{children:t.seedOptions.ownerCount})]}),e("input",{type:"range",min:"1",max:"5",step:"1",className:"w-full accent-blue-600 h-1.5 bg-zinc-200 rounded-lg appearance-none cursor-pointer dark:bg-zinc-700",value:t.seedOptions.ownerCount,onChange:r=>a.setSeedOptions({...t.seedOptions,ownerCount:parseInt(r.target.value)})})]}),n("div",{children:[n("div",{className:"flex justify-between text-xs font-medium mb-1",children:[e("span",{children:"Instructors"}),e("span",{children:t.seedOptions.instructorCount})]}),e("input",{type:"range",min:"0",max:"10",step:"1",className:"w-full accent-blue-600 h-1.5 bg-zinc-200 rounded-lg appearance-none cursor-pointer dark:bg-zinc-700",value:t.seedOptions.instructorCount,onChange:r=>a.setSeedOptions({...t.seedOptions,instructorCount:parseInt(r.target.value)})})]}),n("div",{children:[n("div",{className:"flex justify-between text-xs font-medium mb-1",children:[e("span",{children:"Customers (Students)"}),e("span",{children:t.seedOptions.studentCount})]}),e("input",{type:"range",min:"0",max:"50",step:"1",className:"w-full accent-blue-600 h-1.5 bg-zinc-200 rounded-lg appearance-none cursor-pointer dark:bg-zinc-700",value:t.seedOptions.studentCount,onChange:r=>a.setSeedOptions({...t.seedOptions,studentCount:parseInt(r.target.value)})})]})]}),n("div",{className:"flex justify-end gap-2 pt-4",children:[e("button",{onClick:()=>a.setSeedModalOpen(!1),className:"px-3 py-2 text-zinc-600 dark:text-zinc-400 text-sm",children:"Cancel"}),n("button",{onClick:a.handleSeedConfirm,disabled:t.seedingLoading,className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 text-sm font-medium flex items-center gap-2 disabled:opacity-50",children:[t.seedingLoading&&e(q,{className:"animate-spin",size:14}),"Generate Tenant"]})]})]})}),n(R,{isOpen:t.zoomModalOpen,onClose:()=>a.setZoomModalOpen(!1),title:"Configure Zoom Integration",children:[e("div",{className:"mb-4 text-sm text-zinc-500",children:"Provide the Server-to-Server OAuth credentials from the Zoom App Marketplace. This allows the platform to create meetings on behalf of this tenant."}),n("form",{onSubmit:a.saveZoomCredentials,className:"space-y-4",children:[n("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Account ID"}),e("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:t.zoomData.accountId,onChange:r=>a.setZoomData({...t.zoomData,accountId:r.target.value})})]}),n("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Client ID"}),e("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:t.zoomData.clientId,onChange:r=>a.setZoomData({...t.zoomData,clientId:r.target.value})})]}),n("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Client Secret"}),e("input",{type:"password",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:t.zoomData.clientSecret,onChange:r=>a.setZoomData({...t.zoomData,clientSecret:r.target.value})})]}),n("div",{className:"pt-4 flex gap-3",children:[e("button",{type:"button",onClick:()=>a.setZoomModalOpen(!1),className:"flex-1 px-4 py-2 border border-zinc-300 text-zinc-700 rounded-md hover:bg-zinc-50 font-medium",children:"Cancel"}),e("button",{type:"submit",disabled:t.loading,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium disabled:opacity-50",children:t.loading?"Saving...":"Save Credentials"})]})]})]}),n(R,{isOpen:t.refundModalOpen,onClose:()=>a.setRefundModalOpen(!1),title:"Issue Refund",children:[e("div",{className:"mb-4 text-sm text-zinc-500",children:"Refund a payment for this tenant. You need the Stripe Payment Intent ID (from Stripe Dashboard)."}),n("form",{onSubmit:a.handleRefundSubmit,className:"space-y-4",children:[n("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Payment Intent ID"}),e("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"pi_...",value:t.refundPaymentIntent,onChange:r=>a.setRefundPaymentIntent(r.target.value)})]}),n("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Amount (Optional - leave empty for full)"}),n("div",{className:"relative",children:[e("span",{className:"absolute left-3 top-2 text-zinc-500",children:"$"}),e("input",{type:"number",step:"0.01",className:"w-full pl-8 pr-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"0.00",value:t.refundAmount,onChange:r=>a.setRefundAmount(r.target.value)})]})]}),n("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Reason"}),n("select",{className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:t.refundReason,onChange:r=>a.setRefundReason(r.target.value),children:[e("option",{value:"requested_by_customer",children:"Requested by Customer"}),e("option",{value:"duplicate",children:"Duplicate"}),e("option",{value:"fraudulent",children:"Fraudulent"})]})]}),n("div",{className:"pt-4 flex gap-3",children:[e("button",{type:"button",onClick:()=>a.setRefundModalOpen(!1),className:"flex-1 px-4 py-2 border border-zinc-300 text-zinc-700 rounded-md hover:bg-zinc-50 font-medium",children:"Cancel"}),e("button",{type:"submit",disabled:t.loading,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 font-medium disabled:opacity-50",children:t.loading?"Processing...":"Issue Refund"})]})]})]}),n(R,{isOpen:t.isCreateOpen,onClose:()=>a.setIsCreateOpen(!1),title:"Spin Up New Tenant",children:[e("div",{className:"mb-6",children:e("p",{className:"text-zinc-500 text-sm",children:"Automated provisioning: This will create a database record, set up initial owner permissions, and allocate resources."})}),n("form",{onSubmit:a.handleCreate,className:"space-y-4",children:[n("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Studio Name"}),e("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"e.g. Zen Garden Yoga",value:t.formData.name,onChange:r=>{const y=r.target.value;a.setFormData(p=>{const k=L=>L.toLowerCase().replace(/[^a-z0-9]/g,"-"),x=k(p.name),w=!p.slug||p.slug===x;return{...p,name:y,slug:w?k(y):p.slug}})}})]}),n("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"URL Slug"}),n("div",{className:"flex",children:[e("span",{className:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-zinc-300 bg-zinc-50 text-zinc-500 text-sm",children:"/studio/"}),e("input",{type:"text",required:!0,className:"flex-1 px-3 py-2 border border-zinc-300 rounded-r-md focus:ring-2 focus:ring-blue-500 outline-none font-mono text-sm",placeholder:"zen-garden",value:t.formData.slug,onChange:r=>a.setFormData({...t.formData,slug:r.target.value})})]})]}),n("div",{className:"grid grid-cols-2 gap-4",children:[n("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Plan Tier"}),n("select",{className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none bg-white",value:t.formData.plan,onChange:r=>a.setFormData({...t.formData,plan:r.target.value}),children:[e("option",{value:"basic",children:"Launch (Basic)"}),e("option",{value:"growth",children:"Growth"}),e("option",{value:"scale",children:"Scale"})]})]}),n("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Trial Period (Days)"}),e("input",{type:"number",min:"0",className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"14",value:t.formData.trialDays||"",onChange:r=>a.setFormData({...t.formData,trialDays:parseInt(r.target.value)})}),e("p",{className:"text-xs text-zinc-500 mt-1",children:"Leave empty for no trial"})]})]}),n("div",{className:"pt-4 flex gap-3",children:[e("button",{type:"button",onClick:()=>a.setIsCreateOpen(!1),className:"flex-1 px-4 py-2 border border-zinc-300 text-zinc-700 rounded-md hover:bg-zinc-50 font-medium",children:"Cancel"}),e("button",{type:"submit",disabled:t.loading,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium disabled:opacity-50",children:t.loading?"Provisioning...":"Launch Studio"})]})]})]}),t.cancelModalOpen&&e("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full shadow-xl border border-red-100",children:[n("div",{className:"flex items-center gap-3 mb-4 text-red-600",children:[e(se,{className:"h-6 w-6"}),e("h3",{className:"text-lg font-bold",children:"Cancel Subscription?"})]}),e("p",{className:"text-sm text-zinc-600 mb-6",children:"Are you sure you want to cancel the subscription for this tenant? This action will disable billing at the end of the current period."}),n("div",{className:"flex justify-end gap-3",children:[e("button",{onClick:()=>a.setCancelModalOpen(!1),className:"px-4 py-2 text-sm text-zinc-600 hover:bg-zinc-100 rounded",children:"No, Keep It"}),e("button",{onClick:a.confirmCancelSubscription,disabled:t.loading,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50 font-medium",children:t.loading?"Cancelling...":"Yes, Cancel Subscription"})]})]})}),t.gracePeriodModalOpen&&e("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:n("div",{className:"bg-white rounded-lg p-6 max-md w-full shadow-xl border border-amber-100",children:[n("div",{className:"flex items-center gap-3 text-amber-600 mb-4 bg-amber-50 p-3 rounded-lg",children:[e(q,{className:"h-6 w-6"}),e("span",{className:"font-bold",children:t.selectedTenantForGrace?.enabled?"Start Grace Period":"End Grace Period"})]}),t.selectedTenantForGrace?.enabled?n(re,{children:[n("p",{className:"text-zinc-600 text-sm mb-4",children:["Enabling ",e("strong",{children:"Grace Period"})," will disable access to the Student Portal and Mobile App immediately."]}),n("p",{className:"text-zinc-600 text-sm mb-6",children:["- Admins will retain access.",e("br",{}),"- Public schedules will be hidden.",e("br",{}),'- Tenant status remains "Active" for billing purposes unless changed.']})]}):e("p",{className:"text-zinc-600 text-sm mb-6",children:"Re-enabling access will restore Student Portal and Mobile App functionality immediately."}),n("div",{className:"flex justify-end gap-3",children:[e("button",{onClick:()=>a.setGracePeriodModalOpen(!1),className:"px-4 py-2 text-sm text-zinc-600 hover:bg-zinc-100 rounded",children:"Cancel"}),e("button",{onClick:a.confirmGracePeriod,disabled:t.loading,className:`px-4 py-2 text-sm font-medium text-white rounded-md disabled:opacity-50 ${t.selectedTenantForGrace?.enabled?"bg-amber-600 hover:bg-amber-700":"bg-green-600 hover:bg-green-700"}`,children:t.loading?"Processing...":t.selectedTenantForGrace?.enabled?"Disable Access":"Restore Access"})]})]})}),e(R,{isOpen:t.editModalOpen,onClose:()=>a.setEditModalOpen(!1),title:`Edit Tenant: ${t.tenantToEdit?.name}`,children:n("form",{onSubmit:a.handleSaveEdit,className:"space-y-4",children:[n("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Owner Email"}),e("input",{type:"email",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:t.editEmail,onChange:r=>a.setEditEmail(r.target.value)})]}),n("div",{className:"pt-4 flex gap-3",children:[e("button",{type:"button",onClick:()=>a.setEditModalOpen(!1),className:"flex-1 px-4 py-2 border border-zinc-300 text-zinc-700 rounded-md hover:bg-zinc-50 font-medium",children:"Cancel"}),e("button",{type:"submit",disabled:t.loading,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium disabled:opacity-50",children:t.loading?"Saving...":"Update Owner"})]})]})}),t.exportModal&&e(un,{isOpen:t.exportModal.isOpen,onClose:()=>a.setExportModal(null),tenantId:t.exportModal.tenantId,tenantName:t.exportModal.tenantName,dataType:t.exportModal.dataType}),e(G,{isOpen:t.impersonateModalOpen,onClose:()=>a.setImpersonateModalOpen(!1),onConfirm:a.confirmImpersonate,title:"Impersonate Tenant Owner",message:`Are you sure you want to log in as the owner of ${t.tenantToImpersonate?.name}? You will be logged out of your admin account.`,confirmText:"Log In as Owner",isDestructive:!1}),e(R,{isOpen:t.notifyModalOpen,onClose:()=>a.setNotifyModalOpen(!1),title:"Send System Notification",children:n("form",{onSubmit:a.handleNotifySend,className:"space-y-4",children:[n("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Subject"}),e("input",{type:"text",value:t.notifySubject,onChange:r=>a.setNotifySubject(r.target.value),className:"w-full px-3 py-2 border border-zinc-300 dark:border-zinc-700 rounded-md bg-white dark:bg-zinc-800"})]}),n("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Message"}),e("textarea",{value:t.notifyMessage,onChange:r=>a.setNotifyMessage(r.target.value),className:"w-full px-3 py-2 border border-zinc-300 dark:border-zinc-700 rounded-md bg-white dark:bg-zinc-800 min-h-[100px]",required:!0})]}),n("div",{className:"flex justify-end gap-2 pt-2",children:[e("button",{type:"button",onClick:()=>a.setNotifyModalOpen(!1),className:"px-4 py-2 text-zinc-600 hover:bg-zinc-100 rounded-md",children:"Cancel"}),e("button",{type:"submit",disabled:t.loading,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:t.loading?"Sending...":"Send Notification"})]})]})})]})}const Oe=[{key:"mobile_app",label:"White-Label Mobile App",icon:Xt,sections:"Settings > Mobile App"},{key:"website_builder",label:"Website Builder",icon:Te,sections:"Settings > Website Widgets"},{key:"chat",label:"Chat System",icon:en,sections:"Settings > Chat Settings, Chat Widget"},{key:"financials",label:"Financials & Payouts",icon:Se,sections:"Management > Finances, My Payouts"},{key:"vod",label:"Video on Demand",icon:tn,sections:"Operations > Media Library"},{key:"zoom",label:"Zoom Integration",icon:nn,sections:"Backend Integrations"},{key:"pos",label:"POS & Retail",icon:an,sections:"Commerce > POS, Coupons, Gift Cards"},{key:"sms",label:"SMS Messaging",icon:ln,sections:"Backend Capability (Notifications)"},{key:"marketing",label:"Marketing & CRM",icon:sn,sections:"CRM > Email Automations"},{key:"payroll",label:"Payroll & Compensation",icon:Se,sections:"Management > Payroll Admin"}];function ei(){const{tenants:t,platformConfig:a}=$t(),[f,r]=s(t),[y,p]=s(!1),[k,x]=s(!1),[w,L]=s(!1),[c,C]=s(!1),[T,l]=s({tenantName:"",tenantSlug:"",ownerCount:1,instructorCount:2,studentCount:10,tier:"growth",features:[],featureMode:"all"}),[u,A]=s(new Set),[D,v]=s({}),[E,g]=s({}),[m,b]=s({}),[I,X]=s({}),[B,F]=s(!1),[_,j]=s(null),[N,$]=s({isOpen:!1,message:""}),[Ae,Y]=s({isOpen:!1,message:"",shouldRefresh:!1}),[Ee,Ie]=s(null),[ee,Pe]=s(null),[J,Re]=s(null),[te,Le]=s(null),[$e,Ue]=s(null),[Fe,je]=s(null),[_e,Ge]=s(""),[qe,bn]=s(!1),[Ve,gn]=s(!1),[We,xn]=s(null),[Ze,hn]=s(""),[Be,fn]=s(!1),[Ye,de]=s(!1),[zn,Je]=s(null),[He,me]=s(""),[Ke,ue]=s(""),[Qe,vn]=s(!1),[Xe,Nn]=s(null),[et,yn]=s(""),[tt,nt]=s(!1),[it,at]=s(null),[lt,pe]=s(!1),[wn,st]=s(null),[rt,be]=s({accountId:"",clientId:"",clientSecret:""}),[ot,ne]=s(!1),[ie,ge]=s(null),[ct,xe]=s(!1),[kn,he]=s(null),[dt,fe]=s(""),[mt,ut]=s("requested_by_customer"),[pt,ze]=s(""),[bt,gt]=s(!1),[H,Cn]=s(null),[xt,ht]=s(!1),[ft,zt]=s(null),[vt,Nt]=s(null),[yt,Sn]=s({name:"",slug:"",ownerEmail:"",plan:"basic"}),[ae,wt]=s("createdAt"),[ve,Ne]=s("desc"),[K,kt]=s("all"),[le,Ct]=s("all"),[V,ye]=s(!1),{getToken:P}=ce();Ut(),oe(()=>{typeof window<"u"&&localStorage.getItem("admin_show_financials")==="true"&&ye(!0)},[]);const St=async()=>{if(!ee)return;const{id:i,interval:o}=ee;x(!0);try{const d=await P(),h=await z(`/admin/tenants/${i}/subscription`,d,{method:"PATCH",body:JSON.stringify({interval:o})});if(h.error)throw new Error(h.error);Y({isOpen:!0,message:"Subscription interval updated.",shouldRefresh:!1});const S=await z(`/admin/tenants/${i}/billing/details`,d);b(O=>({...O,[i]:S}))}catch(d){$({isOpen:!0,message:d.message})}finally{x(!1),Pe(null)}},Ot=async()=>{if(J){x(!0);try{const i=await P(),o=await z(`/admin/tenants/${J}/billing/waive`,i,{method:"POST"});if(o.error)throw new Error(o.error);Y({isOpen:!0,message:"Usage waived.",shouldRefresh:!1}),r(f.map(d=>d.id===J?{...d,smsUsage:0,emailUsage:0,streamingUsage:0}:d))}catch(i){$({isOpen:!0,message:i.message})}finally{x(!1),Re(null)}}},Tt=async()=>{if(te)try{const i=await P(),o=await z(`/admin/tenants/${te}/lifecycle/restore`,i,{method:"POST"});if(o.error)throw new Error(o.error);window.location.reload()}catch(i){$({isOpen:!0,message:i.message})}},Dt=async()=>{if(H){x(!0);try{const i=await P(),o=await z(`/admin/tenants/${H}/subscription/cancel`,i,{method:"POST",body:JSON.stringify({immediate:!1})});if(o.error)throw new Error(o.error);Y({isOpen:!0,message:"Subscription set to cancel.",shouldRefresh:!1});const d=await z(`/admin/tenants/${H}/billing/details`,i);b(h=>({...h,[H]:d})),gt(!1)}catch(i){$({isOpen:!0,message:i.message})}finally{x(!1)}}},Mt=async()=>{if(ie){x(!0);try{const i=await P(),o=await z(`/admin/tenants/${ie.id}/impersonate`,i,{method:"POST"});if(o.error)throw new Error(o.error);localStorage.setItem("impersonation_token",o.token),window.location.href=o.redirectUrl||`/studio/${o.slug||"studio"}`}catch(i){$({isOpen:!0,message:i.message})}finally{x(!1),ne(!1)}}},At=async(i,o,d)=>{const h=D[i]||{},S={...h,[o]:{...h[o],enabled:!d,source:"manual"}};v(O=>({...O,[i]:S}));try{const O=await P();await z(`/admin/tenants/${i}/features`,O,{method:"POST",body:JSON.stringify({featureKey:o,enabled:!d,source:"manual"})})}catch{v(M=>({...M,[i]:h}))}},Et=async i=>{if(u.has(i)){const d=new Set(u);d.delete(i),A(d);return}const o=new Set(u);o.add(i),A(o),F(!0);try{const d=await P(),[h,S,O,M]=await Promise.all([z(`/admin/tenants/${i}/features`,d),z(`/admin/tenants/${i}/stats`,d),z(`/admin/tenants/${i}/billing/details`,d).catch(()=>({})),z(`/admin/tenants/${i}/billing/history`,d).catch(()=>({invoices:[]}))]);v(U=>({...U,[i]:h.features})),g(U=>({...U,[i]:S})),b(U=>({...U,[i]:O})),X(U=>({...U,[i]:M.invoices||[]}))}catch(d){console.error(d)}finally{F(!1)}},W=i=>{ae===i?Ne(ve==="asc"?"desc":"asc"):(wt(i),Ne("asc"))},Z=()=>{if(!Array.isArray(f))return[];let i=[...f];return K==="system"?i=i.filter(o=>o.slug==="platform"):(i=i.filter(o=>o.slug!=="platform"),K!=="all"&&(i=i.filter(o=>(o.status||"active")===K))),le!=="all"&&(i=i.filter(o=>(o.tier||"basic")===le)),i.sort((o,d)=>{const h=(U,Rt)=>Rt.split(".").reduce((we,Lt)=>we&&we[Lt],U),S=h(o,ae),O=h(d,ae);if(S===O)return 0;const M=S>O?1:-1;return ve==="asc"?M:-M})},It=()=>{u.size===Z().length?A(new Set):A(new Set(Z().map(i=>i.id)))},Pt=()=>{const i=!V;ye(i),localStorage.setItem("admin_show_financials",String(i))},Q={setErrorDialog:$,setSuccessDialog:Y,setRenewalDateChange:Ue,setOwnersModalOpen:nt,setSelectedTenantForOwners:at,setSeedModalOpen:C,setSeedOptions:l,setZoomModalOpen:pe,setZoomData:be,setRefundPaymentIntent:ze,setRefundAmount:fe,setRefundReason:ut,setExportModal:Nt,setNotifyModalOpen:de,setNotifySubject:ue,setNotifyMessage:me,setRefundModalOpen:xe,openZoomConfig:i=>{st(i),be({accountId:"",clientId:"",clientSecret:""}),pe(!0)},openNotifyModal:i=>{Je(i),ue("System Notification"),me(""),de(!0)},openRefundModal:i=>{he(i),fe(""),ze(""),xe(!0)},handleIntervalChange:St,handleSubscriptionUpdate:async(i,o)=>{try{const d=await P();await z(`/admin/tenants/${i}/subscription`,d,{method:"PATCH",body:JSON.stringify({trialDays:o})});const h=await z("/admin/tenants",d);r(h)}catch(d){$({isOpen:!0,message:d.message})}},handleCancelSubscription:Dt,handleLimitUpdate:async(i,o,d)=>{try{const h=await P();await z(`/admin/tenants/${i}/quotas`,h,{method:"PATCH",body:JSON.stringify({[o]:d})}),r(f.map(S=>S.id===i?{...S,[o]:d}:S))}catch(h){$({isOpen:!0,message:h.message})}},handleWaiveUsage:Ot,handleExport:async(i,o)=>{j(o);try{const d=await P(),h=await fetch(`${Gt}/admin/tenants/${i}/export?type=${o}`,{headers:{Authorization:`Bearer ${d}`}});if(!h.ok)throw new Error("Export failed");const S=await h.blob(),O=window.URL.createObjectURL(S),M=document.createElement("a");M.href=O,M.download=`export_${o}_${i}.csv`,document.body.appendChild(M),M.click(),M.remove()}catch{$({isOpen:!0,message:"Export failed"})}finally{j(null)}},handleGracePeriod:(i,o)=>{zt({id:i,enabled:o}),ht(!0)},handleArchive:i=>{je(i),Ge("")},handleRestore:i=>{Le(i),Tt()},handleImpersonate:i=>{ge(i),ne(!0)},handleFeatureToggle:At,setSelectedTenantForRefund:he,setImpersonateModalOpen:ne,setTenantToImpersonate:ge,confirmImpersonate:Mt};return n("div",{className:"dark:text-zinc-100 p-8",children:[e(pn,{state:{errorDialog:N,successDialog:Ae,tierChange:Ee,intervalChange:ee,renewalDateChange:$e,waiveUsageId:J,restoreId:te,archiveId:Fe,archiveInput:_e,archiveLoading:qe,deleteModalOpen:Ve,tenantToDelete:We,deleteInput:Ze,deleteLoading:Be,ownersModalOpen:tt,selectedTenantForOwners:it,seedModalOpen:c,seedOptions:T,seedingLoading:w,zoomModalOpen:lt,zoomData:rt,refundModalOpen:ct,refundPaymentIntent:pt,refundAmount:dt,refundReason:mt,cancelModalOpen:bt,gracePeriodModalOpen:xt,selectedTenantForGrace:ft,editModalOpen:Qe,tenantToEdit:Xe,editEmail:et,isCreateOpen:y,formData:yt,loading:k,exportModal:vt,notifyModalOpen:Ye,notifySubject:Ke,notifyMessage:He,impersonateModalOpen:ot,tenantToImpersonate:ie},handlers:Q,FEATURES:Oe}),n("div",{className:"flex justify-between items-center mb-6",children:[n("div",{className:"flex items-center gap-4",children:[e("h2",{className:"text-2xl font-bold",children:"Tenant Management"}),n("div",{className:"flex gap-2 items-center",children:[n("select",{className:"text-xs border border-zinc-300 dark:border-zinc-700 rounded px-2 py-1 bg-white dark:bg-zinc-800",value:K,onChange:i=>kt(i.target.value),children:[e("option",{value:"all",children:"Status: All"}),e("option",{value:"active",children:"Active"}),e("option",{value:"paused",children:"Paused"}),e("option",{value:"suspended",children:"Suspended"}),e("option",{value:"archived",children:"Archived"}),e("option",{value:"system",children:"System"})]}),n("select",{className:"text-sm border border-zinc-300 dark:border-zinc-700 rounded-md px-2 py-1 bg-white dark:bg-zinc-800",value:le,onChange:i=>Ct(i.target.value),children:[e("option",{value:"all",children:"All Tiers"}),e("option",{value:"basic",children:"Launch"}),e("option",{value:"growth",children:"Growth"}),e("option",{value:"scale",children:"Scale"})]}),e("button",{onClick:It,className:"text-xs font-medium text-zinc-600 dark:text-zinc-400 bg-zinc-100 dark:bg-zinc-800 px-3 py-1 rounded-md",children:u.size===Z().length&&Z().length>0?"Collapse All":"Expand All"}),n("button",{onClick:()=>C(!0),className:"text-xs font-medium bg-emerald-100 text-emerald-700 px-3 py-1 rounded-md flex items-center gap-1.5",children:[e(q,{size:12})," Seed Test Tenant"]}),e("button",{onClick:Pt,className:`relative inline-flex h-6 w-11 items-center rounded-full ${V?"bg-indigo-600":"bg-zinc-200 dark:bg-zinc-700"}`,children:e("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${V?"translate-x-6":"translate-x-1"}`})})]})]}),n("button",{onClick:()=>p(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 font-medium text-sm flex items-center gap-2",children:[e("span",{className:"text-lg",children:"+"})," Spin Up Tenant"]})]}),e("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg overflow-hidden shadow-sm",children:n("table",{className:"w-full text-left",children:[e("thead",{className:"bg-zinc-50 dark:bg-zinc-950/50 border-b border-zinc-200 dark:border-zinc-800",children:n("tr",{children:[e("th",{className:"w-8"}),e("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 uppercase cursor-pointer",onClick:()=>W("name"),children:"Tenant"}),e("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 uppercase cursor-pointer",onClick:()=>W("tier"),children:"Tier"}),e("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 uppercase text-center cursor-pointer",onClick:()=>W("stats.owners"),children:"People"}),e("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 uppercase text-center cursor-pointer",onClick:()=>W("storageUsage"),children:"Usage"}),e("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 uppercase cursor-pointer",onClick:()=>W("status"),children:"Status"}),e("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 uppercase",children:"Actions"})]})}),e("tbody",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:Z().map(i=>n(qt,{children:[n("tr",{className:"hover:bg-zinc-50 dark:hover:bg-zinc-800/50 cursor-pointer",onClick:()=>Et(i.id),children:[e("td",{className:"pl-4",children:u.has(i.id)?e(rn,{size:16}):e(on,{size:16})}),n("td",{className:"px-6 py-4",children:[e("div",{className:"font-medium",children:i.name}),e("div",{className:"text-zinc-500 text-xs font-mono",children:i.slug})]}),e("td",{className:"px-6 py-4",onClick:o=>o.stopPropagation(),children:n("select",{value:i.tier||"basic",onChange:o=>Ie({id:i.id,tier:o.target.value}),className:`text-xs border rounded px-2 py-0.5 ${i.tier==="scale"?"bg-purple-100 text-purple-800":i.tier==="growth"?"bg-blue-100 text-blue-800":"bg-zinc-100 text-zinc-600"}`,children:[e("option",{value:"basic",children:"Launch"}),e("option",{value:"growth",children:"Growth"}),e("option",{value:"scale",children:"Scale"})]})}),e("td",{className:"px-6 py-4",children:n("div",{className:"flex gap-4 justify-center",children:[n("div",{className:"flex flex-col items-center",children:[e("span",{className:"text-[10px] text-zinc-400 font-bold uppercase",children:"Own"}),e("span",{className:"text-sm font-bold",children:i.stats?.owners||0})]}),n("div",{className:"flex flex-col items-center",children:[e("span",{className:"text-[10px] text-zinc-400 font-bold uppercase",children:"Cust"}),e(_t,{revealed:V,placeholder:"***",children:e("span",{className:"text-sm font-bold text-blue-600",children:i.stats?.totalStudents||0})})]})]})}),e("td",{className:"px-6 py-4",children:e("div",{className:"flex gap-4 justify-center",children:n("div",{className:"flex flex-col items-center",children:[e("span",{className:"text-[10px] text-zinc-400 font-bold uppercase",children:"Storage"}),n("span",{className:"text-xs font-bold",children:[(i.storageUsage/(1024*1024*1024)).toFixed(1),"G"]})]})})}),e("td",{className:"px-6 py-4",children:e("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${i.status==="suspended"?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:i.status||"Active"})}),e("td",{className:"px-6 py-4",children:n("div",{className:"flex items-center gap-3",children:[e(Ft,{to:`/studio/${i.slug}`,className:"text-blue-600 text-xs font-bold border border-blue-200 bg-blue-50 px-3 py-1 rounded-full",onClick:o=>o.stopPropagation(),children:"Enter"}),e("button",{onClick:o=>{o.stopPropagation(),Q.handleImpersonate(i)},children:e(De,{size:16,className:"text-zinc-400"})}),e("button",{onClick:o=>{o.stopPropagation(),Q.openNotifyModal(i.id)},children:e(Me,{size:16,className:"text-zinc-400"})})]})})]}),u.has(i.id)&&e("tr",{children:e("td",{colSpan:7,className:"px-6 pb-6 mt-2",children:e(cn,{t:i,showFinancials:V,subscriptionDetails:m,tenantFeatures:D,tenantStats:E,invoices:I[i.id]||[],featuresLoading:B,exportLoading:_,platformConfig:a,FEATURES:Oe,handlers:Q})})})]},i.id))})]})})]})}export{ei as default};
