import{jsx as e,jsxs as l}from"react/jsx-runtime";import{useState as c,useEffect as A}from"react";import{M as y,a as N}from"./server-build-DYgJutU4.js";import{useParams as D,useRevalidator as $}from"react-router";import{CheckCircle2 as E,Globe as P,DollarSign as F,Calendar as j,ArrowRight as B}from"lucide-react";import"react-router-dom";import"isbot";import"react-dom/server";import"@clerk/react-router";import"@clerk/react-router/server";import"@tanstack/react-query";import"sonner";import"isomorphic-dompurify";import"fuse.js";import"clsx";import"tailwind-merge";import"date-fns";import"@headlessui/react";import"class-variance-authority";/* empty css                    */import"react-error-boundary";import"react-easy-crop";import"recharts";import"@stripe/stripe-js";import"@stripe/react-stripe-js";import"react-qr-code";function oe({isOpen:d,onClose:o,tenant:n,token:b}){const[r,m]=c(1),{slug:g}=D(),f=$(),[u,h]=c(!1),[x,v]=c(null),[i,a]=c({name:n.name,timezone:n.locations?.[0]?.timezone||"UTC",currency:n.currency||"usd",branding:{primaryColor:n.branding?.primaryColor||"#2563EB"},firstClass:{title:"Morning Flow",date:"",time:"09:00",duration:60}});A(()=>{const t=Intl.DateTimeFormat().resolvedOptions().timeZone,p=new Date().toLocaleDateString("en-CA");a(s=>({...s,timezone:n.locations?.[0]?.timezone||t,firstClass:{...s.firstClass,date:p}}))},[]);const C=["UTC","America/New_York","America/Los_Angeles","America/Chicago","America/Denver","Europe/London","Europe/Paris","Europe/Berlin","Asia/Tokyo","Asia/Singapore","Australia/Sydney","Pacific/Auckland"],z=Intl.DateTimeFormat().resolvedOptions().timeZone,w=Array.from(new Set([z,...C,...Intl.supportedValuesOf("timeZone")])).sort(),k=[{code:"usd",label:"USD ($)"},{code:"eur",label:"EUR (€)"},{code:"gbp",label:"GBP (£)"},{code:"aud",label:"AUD ($)"},{code:"cad",label:"CAD ($)"}],S=()=>m(r+1),T=async()=>{h(!0),v(null);try{const t=new Date(`${i.firstClass.date}T${i.firstClass.time}`),p={tenantId:n.id,name:i.name,timezone:i.timezone,currency:i.currency,branding:i.branding,firstClass:{title:i.firstClass.title,startTime:t.toISOString(),duration:Number(i.firstClass.duration)}},s=await N("/onboarding/quick-start",b,{method:"POST",body:JSON.stringify(p)});if(s.error)throw new Error(s.error);m(3),f.revalidate()}catch(t){v(t.message||"Something went wrong.")}finally{h(!1)}};return d?r===3?e(y,{isOpen:d,onClose:o,title:"Setup Complete!",maxWidth:"max-w-lg",children:l("div",{className:"text-center py-6 space-y-6",children:[e("div",{className:"w-16 h-16 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto",children:e(E,{size:32})}),l("div",{children:[e("h3",{className:"text-2xl font-bold text-zinc-900 mb-2",children:"You're ready to go!"}),e("p",{className:"text-zinc-500",children:"Your studio is set up and your first class is scheduled."})]}),l("div",{className:"bg-zinc-50 border border-zinc-200 rounded-lg p-4 text-left",children:[e("div",{className:"text-xs font-medium text-zinc-500 uppercase mb-1",children:"Your Public Page"}),l("a",{href:`/studio/${g}/public`,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:underline break-all font-mono text-sm",children:[window.location.origin,"/studio/",g,"/public"]})]}),e("button",{onClick:o,className:"w-full py-3 bg-zinc-900 text-white rounded-lg font-medium hover:bg-zinc-800 transition",children:"Go to Dashboard"})]})}):e(y,{isOpen:d,onClose:()=>{},title:r===1?"Studio Basics":"Schedule First Class",maxWidth:"max-w-2xl",children:l("div",{className:"space-y-6",children:[l("div",{className:"flex items-center gap-2 mb-6",children:[e("div",{className:`h-2 flex-1 rounded-full ${r>=1?"bg-blue-600":"bg-zinc-100"}`}),e("div",{className:`h-2 flex-1 rounded-full ${r>=2?"bg-blue-600":"bg-zinc-100"}`}),e("div",{className:`h-2 flex-1 rounded-full ${r>=3?"bg-blue-600":"bg-zinc-100"}`})]}),x&&e("div",{className:"p-3 bg-red-50 text-red-600 text-sm rounded-lg",children:x}),r===1&&l("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l("div",{className:"space-y-4",children:[l("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Studio Name"}),e("input",{type:"text",value:i.name,onChange:t=>a({...i,name:t.target.value}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),l("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Timezone"}),l("div",{className:"relative",children:[e(P,{className:"absolute left-3 top-2.5 text-zinc-400",size:16}),e("select",{value:i.timezone,onChange:t=>a({...i,timezone:t.target.value}),className:"w-full pl-9 pr-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white",children:w.map(t=>e("option",{value:t,children:t},t))})]})]}),l("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Currency"}),l("div",{className:"relative",children:[e(F,{className:"absolute left-3 top-2.5 text-zinc-400",size:16}),e("select",{value:i.currency,onChange:t=>a({...i,currency:t.target.value}),className:"w-full pl-9 pr-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white",children:k.map(t=>e("option",{value:t.code,children:t.label},t.code))})]})]})]}),l("div",{className:"space-y-4",children:[e("label",{className:"block text-sm font-medium text-zinc-700",children:"Brand Color"}),l("div",{className:"p-4 border rounded-lg flex flex-col gap-4 items-center justify-center bg-zinc-50",children:[e("div",{className:"w-24 h-24 rounded-2xl shadow-lg flex items-center justify-center text-white font-bold text-2xl transition-colors",style:{backgroundColor:i.branding.primaryColor},children:i.name.charAt(0)}),e("input",{type:"color",value:i.branding.primaryColor,onChange:t=>a({...i,branding:{...i.branding,primaryColor:t.target.value}}),className:"w-full h-10 cursor-pointer"}),e("span",{className:"text-xs text-zinc-500 font-mono",children:i.branding.primaryColor})]})]})]}),r===2&&l("div",{className:"space-y-6",children:[l("div",{className:"bg-blue-50 text-blue-700 p-4 rounded-lg text-sm flex gap-3",children:[e(j,{className:"shrink-0",size:20}),l("div",{children:[e("p",{className:"font-semibold",children:"Let's schedule your first class!"}),e("p",{children:"This will create a class type and add it to your schedule."})]})]}),l("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l("div",{className:"col-span-2",children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Class Title"}),e("input",{type:"text",value:i.firstClass.title,onChange:t=>a({...i,firstClass:{...i.firstClass,title:t.target.value}}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"e.g. Morning Vinyasa Flow"})]}),l("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Date"}),e("input",{type:"date",value:i.firstClass.date,onChange:t=>a({...i,firstClass:{...i.firstClass,date:t.target.value}}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),l("div",{children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Time"}),e("input",{type:"time",value:i.firstClass.time,onChange:t=>a({...i,firstClass:{...i.firstClass,time:t.target.value}}),className:"w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),l("div",{className:"col-span-2",children:[e("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Duration (minutes)"}),e("div",{className:"flex items-center gap-4",children:[30,45,50,60,90,120].map(t=>l("button",{onClick:()=>a({...i,firstClass:{...i.firstClass,duration:t}}),className:`px-4 py-2 rounded-lg border text-sm font-medium transition ${i.firstClass.duration===t?"bg-blue-600 text-white border-blue-600":"bg-white text-zinc-600 hover:bg-zinc-50"}`,children:[t," min"]},t))})]})]})]}),l("div",{className:"flex justify-between pt-4 border-t mt-6",children:[r===2?e("button",{onClick:()=>m(1),className:"px-4 py-2 text-zinc-600 text-sm font-medium hover:text-zinc-900",children:"Back"}):e("div",{}),l("div",{className:"flex gap-3",children:[e("button",{onClick:async()=>{try{await N("/onboarding/quick-start/skip",b,{method:"POST",body:JSON.stringify({tenantId:n.id})}),f.revalidate(),o()}catch(t){console.error("Failed to skip setup",t),o()}},className:"px-4 py-2 text-zinc-500 text-sm hover:text-zinc-700",children:"Skip Setup"}),l("button",{onClick:r===1?S:T,disabled:u,className:"px-6 py-2 bg-zinc-900 text-white rounded-lg font-medium hover:bg-zinc-800 transition flex items-center gap-2 disabled:opacity-50",children:[u?"Saving...":r===1?"Next Step":"Launch Studio",!u&&e(B,{size:16})]})]})]})]})}):null}export{oe as QuickStartModal};
