import{w as M,e as _,u as X,g as Y}from"./chunk-EPOLDU6W-CxxYD-cd.js";import{j as e}from"./vendor-puck-aUaaDwmz.js";import{a as r}from"./vendor-livekit-D3VpklN2.js";import{a as d}from"./api-D1U4i9fn.js";import{t as K}from"./index-BFgzoDOP.js";import{C as Q}from"./Dialogs-C3BiSLFk.js";import{I as W}from"./image-B4UGPaq8.js";import{U as L}from"./upload-DoKnH7Yo.js";import{V as Z}from"./video-C2qC2935.js";import{C as ee}from"./circle-check-big-DvZS8AIf.js";import{T as te}from"./trash-2-BHPWr9eo.js";import"./Modal-RrMUvIY-.js";import"./createLucideIcon-CcD9UNCP.js";const be=M(function(){const{tenant:n}=_(),{assets:p}=X(),b=Y(),[i,h]=r.useState(p),[m,f]=r.useState(null),[v,k]=r.useState(n.branding?.primaryColor||"#4f46e5"),[z,F]=r.useState(n.branding?.logoUrl||""),[N,E]=r.useState(n.branding?.emailReplyTo||""),[w,R]=r.useState(n.branding?.emailFooterText||""),[C,I]=r.useState(n.branding?.hidePoweredBy||!1),[j,S]=r.useState(!1),[l,x]=r.useState(null),[T,o]=r.useState(null),[U,u]=r.useState(null),$=async t=>{t.preventDefault(),S(!0),o(null),u(null);try{const s=await window.Clerk?.session?.getToken();await d("/tenant/settings",s,{method:"PATCH",headers:{"X-Tenant-Slug":n.slug},body:JSON.stringify({branding:{primaryColor:v,logoUrl:z,emailReplyTo:N,emailFooterText:w,hidePoweredBy:C}})}),u("Branding saved successfully."),b.revalidate()}catch(s){o(s.message||"Failed to save branding.")}finally{S(!1)}},V=async t=>{x("logo"),o(null);try{const s=await window.Clerk?.session?.getToken(),a=new FormData;a.append("file",t),a.append("title",`Logo - ${t.name}`);const c=await d("/uploads/r2-image",s,{method:"POST",body:a});F(c.url),u("Logo uploaded. Don't forget to save settings.")}catch(s){console.error(s),o("Logo upload failed: "+s.message)}finally{x(null)}},D=async(t,s)=>{x(s),o(null);try{const a=await window.Clerk?.session?.getToken(),{uploadUrl:c,uid:y}=await d("/video-management/branding/upload-url",a,{method:"POST",body:JSON.stringify({type:s})}),B=new FormData;if(B.append("file",t),!(await fetch(c,{method:"POST",body:B})).ok)throw new Error("Upload to video server failed");await d("/video-management/branding",a,{method:"POST",body:JSON.stringify({type:s,title:t.name,cloudflareStreamId:y})});const J=await d("/video-management/branding",a);h(J),u(`Uploaded ${s} video successfully.`)}catch(a){console.error(a),o("Upload failed: "+a.message)}finally{x(null)}},P=async t=>{try{const s=await window.Clerk?.session?.getToken();await d(`/video-management/branding/${t}/activate`,s,{method:"PATCH"}),h(i.map(a=>{if(a.id===t)return{...a,active:!0};const c=i.find(y=>y.id===t);return c&&a.type===c.type&&a.id!==t?{...a,active:!1}:a}))}catch{o("Failed to activate asset")}},A=t=>{f(t)},H=async()=>{if(m)try{const t=await window.Clerk?.session?.getToken();await d(`/video-management/branding/${m}`,t,{method:"DELETE"}),h(i.filter(s=>s.id!==m)),f(null),K.success("Asset deleted successfully")}catch{o("Failed to delete asset")}},q=i.filter(t=>t.type==="intro"),G=i.filter(t=>t.type==="outro");return e.jsxs("div",{className:"max-w-4xl pb-10 space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-zinc-900 dark:text-zinc-100 mb-2",children:"Customize Branding"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400",children:"Manage your studio's look, feel, and video assets."})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6 shadow-sm",children:[T&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 p-3 rounded mb-4 text-sm",children:T}),U&&e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 p-3 rounded mb-4 text-sm",children:U}),e.jsx("h2",{className:"text-lg font-semibold text-zinc-900 dark:text-zinc-100 mb-6",children:"General Appearance"}),e.jsxs("form",{onSubmit:$,className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-2",children:"Studio Logo"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"h-24 w-24 bg-zinc-100 dark:bg-zinc-800 rounded-lg border border-zinc-200 dark:border-zinc-700 flex items-center justify-center overflow-hidden relative group",children:[z?e.jsx("img",{src:z,alt:"Studio Logo",className:"object-cover w-full h-full"}):e.jsx(W,{className:"text-zinc-300",size:32}),e.jsxs("label",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center cursor-pointer transition-opacity text-white text-xs font-medium",children:["Change",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:t=>t.target.files?.[0]&&V(t.target.files[0]),disabled:l==="logo"})]})]}),e.jsxs("div",{className:"flex-1 text-sm text-zinc-500",children:[e.jsx("p",{children:"Upload a square image for best results. Used in emails and header."}),l==="logo"&&e.jsx("p",{className:"text-blue-600 animate-pulse mt-1",children:"Uploading..."})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-2",children:"Primary Brand Color"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"color",value:v,onChange:t=>k(t.target.value),className:"w-10 h-10 p-0 border-none rounded cursor-pointer bg-transparent"}),e.jsx("input",{type:"text",value:v,onChange:t=>k(t.target.value),className:"flex-1 bg-transparent text-zinc-900 dark:text-zinc-100 border border-zinc-200 dark:border-zinc-700 rounded-md px-3 py-2 text-sm font-mono focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"#000000"})]})]})]}),e.jsxs("div",{className:"border-t border-zinc-200 dark:border-zinc-800 pt-6",children:[e.jsx("h2",{className:"text-base font-semibold text-zinc-900 dark:text-zinc-100 mb-4",children:"Email Settings"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-2",children:"Reply-To Address"}),e.jsx("input",{type:"email",value:N,onChange:t=>E(t.target.value),className:"w-full bg-transparent text-zinc-900 dark:text-zinc-100 border border-zinc-200 dark:border-zinc-700 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"hello@yourstudio.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-2",children:"Email Footer Text"}),e.jsx("textarea",{value:w,onChange:t=>R(t.target.value),className:"w-full min-h-[80px] bg-transparent text-zinc-900 dark:text-zinc-100 border border-zinc-200 dark:border-zinc-700 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none resize-y",placeholder:"e.g. 123 Yoga St, City, ST"})]})]}),e.jsxs("div",{className:"border-t border-zinc-200 dark:border-zinc-800 pt-6",children:[e.jsx("h2",{className:"text-base font-semibold text-zinc-900 dark:text-zinc-100 mb-4",children:"Platform Branding"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{id:"hidePoweredBy",type:"checkbox",checked:C,onChange:t=>I(t.target.checked),disabled:n.tier?.toLowerCase()!=="scale",className:"h-4 w-4 mt-0.5 rounded border-zinc-300 text-blue-600 focus:ring-blue-500 disabled:opacity-50"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("label",{htmlFor:"hidePoweredBy",className:`font-medium ${n.tier?.toLowerCase()!=="scale"?"text-zinc-400 dark:text-zinc-500":"text-zinc-900 dark:text-zinc-100"}`,children:'Hide "Powered by StudioPlatform" badge'}),e.jsxs("p",{className:"text-zinc-500 dark:text-zinc-400 text-xs mt-0.5",children:["Remove the branding badge from your site footer.",n.tier?.toLowerCase()!=="scale"&&e.jsx("span",{className:"text-pink-600 dark:text-pink-400 ml-1 font-medium",children:"Requires Scale tier."})]})]})]})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",disabled:j,className:`bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 px-5 py-2.5 rounded-md font-medium text-sm hover:opacity-90 transition-opacity ${j?"opacity-70 cursor-not-allowed":""}`,children:j?"Saving...":"Save General Settings"})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-zinc-900 dark:text-zinc-100",children:"Video Branding"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400",children:"Intros and Outros to automatically stitch to your VOD uploads."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-zinc-900",children:"Intro Videos"}),e.jsxs("label",{className:"cursor-pointer bg-zinc-100 hover:bg-zinc-200 text-zinc-800 px-3 py-1.5 rounded-md text-xs font-medium transition flex items-center gap-2",children:[e.jsx(L,{size:14}),l==="intro"?"Uploading...":"Upload Intro",e.jsx("input",{type:"file",accept:"video/*",className:"hidden",onChange:t=>t.target.files?.[0]&&D(t.target.files[0],"intro"),disabled:!!l})]})]}),e.jsx(O,{assets:q,onActivate:P,onDelete:A,emptyMessage:"No intros uploaded. Upload a short video to play before your classes."})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-zinc-900",children:"Outro Videos"}),e.jsxs("label",{className:"cursor-pointer bg-zinc-100 hover:bg-zinc-200 text-zinc-800 px-3 py-1.5 rounded-md text-xs font-medium transition flex items-center gap-2",children:[e.jsx(L,{size:14}),l==="outro"?"Uploading...":"Upload Outro",e.jsx("input",{type:"file",accept:"video/*",className:"hidden",onChange:t=>t.target.files?.[0]&&D(t.target.files[0],"outro"),disabled:!!l})]})]}),e.jsx(O,{assets:G,onActivate:P,onDelete:A,emptyMessage:"No outros uploaded. Upload a short video to play after your classes."})]})]})]}),e.jsx(Q,{isOpen:!!m,onClose:()=>f(null),onConfirm:H,title:"Delete Branding Asset",message:"Are you sure you want to delete this branding asset? This action cannot be undone.",confirmText:"Delete",isDestructive:!0})]})});function O({assets:g,onActivate:n,onDelete:p,emptyMessage:b}){return g.length===0?e.jsx("div",{className:"text-zinc-400 text-sm py-8 text-center bg-zinc-50 rounded-lg border border-dashed border-zinc-200 px-10",children:b}):e.jsx("div",{className:"space-y-3",children:g.map(i=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${i.active?"border-indigo-200 bg-indigo-50/50":"border-zinc-200 hover:bg-zinc-50"} transition`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-zinc-200 rounded flex items-center justify-center text-zinc-400",children:e.jsx(Z,{size:14})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-zinc-900",children:i.title}),i.active&&e.jsxs("div",{className:"text-xs text-indigo-600 font-medium flex items-center gap-1",children:[e.jsx(ee,{size:10})," Active"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!i.active&&e.jsx("button",{onClick:()=>n(i.id),className:"text-xs text-zinc-500 hover:text-indigo-600 px-2 py-1 rounded hover:bg-indigo-50 transition",children:"Set Active"}),e.jsx("button",{onClick:()=>p(i.id),className:"p-1.5 text-zinc-400 hover:text-red-600 rounded transition",children:e.jsx(te,{size:14})})]})]},i.id))})}export{be as default};
