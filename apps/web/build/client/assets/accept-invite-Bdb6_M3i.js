import{w as h,a as p,b as f}from"./chunk-JMJ3UQ3L-DR3wp0kw.js";import{j as e}from"./vendor-puck-By1A5E5K.js";import{a}from"./vendor-sentry-BD1MTpLq.js";import{a as j}from"./api-OnQO3erh.js";import{a as v,R as g,S as b}from"./chunk-VMBS36YX-BqsXR-ha.js";import"./index-Dua1JDqF.js";import{u as N}from"./index-D9ERMtIL.js";import"./chunk-OT5FTIRN-BigJMP2-.js";import"./runtimeEnvironment-BB2sO-19-DQnzQjGy.js";import"./chunk-6WD75OPE-C6oZKFq7.js";import"./vendor-charts-BzoqY3DK.js";const M=h(function(){const{isLoaded:n,isSignedIn:o,user:k}=N(),[m]=p(),l=f(),t=m.get("token"),[i,s]=a.useState("validating"),[x,r]=a.useState(null);a.useEffect(()=>{if(n){if(!t){s("error"),r("Invalid invitation link (no token).");return}o&&u()}},[n,o,t]);const u=async()=>{s("accepting");try{const c=await window.Clerk?.session?.getToken(),d=await j("/members/accept-invite",c,{method:"POST",body:JSON.stringify({token:t})});d.success?(s("success"),setTimeout(()=>{l("/")},2e3)):(s("error"),r(d.error||"Failed to accept invitation."))}catch(c){s("error"),r(c.message||"An unexpected error occurred.")}};return n?t?e.jsxs("div",{className:"min-h-screen bg-zinc-50 flex flex-col justify-center items-center p-4",children:[e.jsx(v,{children:e.jsxs("div",{className:"bg-white p-8 rounded shadow text-center max-w-md w-full",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"You've been invited!"}),e.jsx("p",{className:"text-zinc-600 mb-6",children:"Please sign in or create an account to accept this invitation."}),e.jsx("div",{className:"flex justify-center",children:e.jsx(g,{afterSignInUrl:`/accept-invite?token=${t}`})})]})}),e.jsx(b,{children:e.jsxs("div",{className:"bg-white p-8 rounded shadow text-center max-w-md w-full",children:[i==="accepting"&&e.jsxs("div",{children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-zinc-900 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold",children:"Accepting Invitation..."}),e.jsx("p",{className:"text-zinc-500",children:"Linking your account to the studio."})]}),i==="success"&&e.jsxs("div",{children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 mb-4",children:e.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"text-xl font-bold text-green-600",children:"Welcome!"}),e.jsx("p",{className:"text-zinc-600 mt-2",children:"Invitation accepted successfully."}),e.jsx("p",{className:"text-xs text-zinc-400 mt-4",children:"Redirecting you..."})]}),i==="error"&&e.jsxs("div",{children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:e.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-xl font-bold text-red-600",children:"Error"}),e.jsx("p",{className:"text-zinc-600 mt-2",children:x}),e.jsx("button",{onClick:()=>l("/"),className:"mt-6 px-4 py-2 bg-zinc-900 text-white rounded hover:bg-zinc-800",children:"Go Home"})]})]})})]}):e.jsx("div",{className:"min-h-screen bg-zinc-50 flex flex-col justify-center items-center p-4",children:e.jsxs("div",{className:"bg-white p-8 rounded shadow text-center max-w-md",children:[e.jsx("h2",{className:"text-red-600 font-bold mb-2",children:"Invalid Link"}),e.jsx("p",{className:"text-zinc-600",children:"This invitation link appears to be missing a token."})]})}):e.jsx("div",{className:"p-10 text-center",children:"Loading..."})});export{M as default};
