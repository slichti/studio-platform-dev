import{w as k,u as z}from"./chunk-EPOLDU6W-CxxYD-cd.js";import{j as e}from"./vendor-puck-aUaaDwmz.js";import{a as o}from"./vendor-livekit-D3VpklN2.js";import{t as C,c as S,n as D,s as j,a as N,f as u}from"./format-fLJrjEXu.js";function E(n,s,r){const a=C(n,r?.in);return isNaN(s)?S(n,NaN):(s&&a.setDate(a.getDate()+s),a)}function p(n,s,r){const[a,x]=D(r?.in,n,s);return+j(a)==+j(x)}function M({tenantSlug:n}){const[s,r]=o.useState([]),[a,x]=o.useState(!0),[l,w]=o.useState(new Date),[c,b]=o.useState(null),[i,g]=o.useState({name:"",email:""}),[f,d]=o.useState("idle");o.useEffect(()=>{v()},[n,l]);const v=async()=>{x(!0);try{const t=N(l).toISOString(),h=await(await fetch(`https://studio-platform-api.slichti.workers.dev/guest/schedule/${n}?start=${t}`)).json();r(h.classes||[])}catch(t){console.error("Failed to load schedule",t)}finally{x(!1)}},y=async()=>{d("submitting");try{(await fetch("https://studio-platform-api.slichti.workers.dev/guest/booking",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({classId:c.id,tenantId:c.tenantId,guestDetails:i})})).ok?d("success"):d("error")}catch{d("error")}};return f==="success"?e.jsxs("div",{className:"p-8 text-center bg-green-50 rounded-xl",children:[e.jsx("h3",{className:"text-2xl font-bold text-green-800",children:"Booking Confirmed!"}),e.jsx("p",{className:"mt-2 text-green-700",children:"Check your email for details."}),e.jsx("button",{onClick:()=>{d("idle"),b(null)},className:"mt-6 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Book Another Class"})]}):e.jsxs("div",{className:"w-full max-w-4xl mx-auto bg-white rounded-xl shadow-sm border border-zinc-200 overflow-hidden flex flex-col md:flex-row h-[600px]",children:[e.jsxs("div",{className:"w-full md:w-1/3 bg-zinc-50 border-r border-zinc-200 p-6 flex flex-col",children:[e.jsx("h2",{className:"text-xl font-bold text-zinc-900 mb-6",children:"Select a Date"}),e.jsx("div",{className:"space-y-2",children:[0,1,2,3,4,5,6].map(t=>{const m=E(N(l),t),h=p(m,l);return e.jsxs("button",{onClick:()=>w(m),className:`w-full text-left px-4 py-3 rounded-lg transition-colors flex justify-between items-center ${h?"bg-blue-600 text-white shadow-md":"hover:bg-zinc-200 text-zinc-700"}`,children:[e.jsx("span",{className:"font-medium",children:u(m,"EEEE")}),e.jsx("span",{className:h?"text-blue-200":"text-zinc-500",children:u(m,"MMM d")})]},t)})})]}),e.jsxs("div",{className:"flex-1 p-6 overflow-y-auto bg-white",children:[e.jsxs("h2",{className:"text-xl font-bold text-zinc-900 mb-6 sticky top-0 bg-white py-2 z-10",children:["Classes for ",u(l,"MMMM do")]}),a?e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(t=>e.jsx("div",{className:"h-24 bg-zinc-100 rounded-lg"},t))}):s.filter(t=>p(new Date(t.startTime),l)).length===0?e.jsx("div",{className:"text-center py-12 text-zinc-500",children:"No classes scheduled for this day."}):e.jsx("div",{className:"space-y-4",children:s.filter(t=>p(new Date(t.startTime),l)).map(t=>e.jsx("div",{className:"group border border-zinc-200 rounded-xl p-4 hover:border-blue-300 hover:shadow-md transition-all",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-zinc-900 text-lg",children:u(new Date(t.startTime),"h:mm a")}),e.jsx("h3",{className:"text-zinc-800 font-semibold mt-1",children:t.title}),e.jsx("p",{className:"text-sm text-zinc-500 mt-1",children:t.instructor?.user?.name||t.instructor?.user?.email||"Instructor"})]}),e.jsx("button",{onClick:()=>b(t),className:"px-4 py-2 bg-white border border-zinc-300 text-zinc-700 font-medium rounded-lg hover:bg-zinc-50 group-hover:border-blue-500 group-hover:text-blue-600 transition-colors",children:"Book"})]})},t.id))})]}),c&&e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6 animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-zinc-900",children:"Complete Booking"}),e.jsxs("button",{onClick:()=>b(null),className:"text-zinc-400 hover:text-zinc-600",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),e.jsxs("div",{className:"bg-zinc-50 p-4 rounded-xl mb-6",children:[e.jsx("p",{className:"font-bold text-zinc-900",children:c.title}),e.jsx("p",{className:"text-sm text-zinc-600 mt-1",children:u(new Date(c.startTime),"EEEE, MMMM do @ h:mm a")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:i.name,onChange:t=>g({...i,name:t.target.value}),className:"w-full px-3 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",placeholder:"Jane Doe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:i.email,onChange:t=>g({...i,email:t.target.value}),className:"w-full px-3 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",placeholder:"jane@example.com"})]})]}),e.jsx("div",{className:"mt-8",children:e.jsx("button",{onClick:y,disabled:!i.name||!i.email||f==="submitting",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold rounded-xl shadow-sm transition-all transform active:scale-[0.98]",children:f==="submitting"?"Booking...":"Confirm Booking"})})]})})]})}const I=k(function(){const{slug:s}=z();return e.jsx("div",{className:"min-h-screen bg-transparent flex items-center justify-center p-4 font-sans",children:e.jsx(M,{tenantSlug:s})})});export{I as default};
