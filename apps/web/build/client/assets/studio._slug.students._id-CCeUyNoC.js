import{w as V,d as q,c as R,b as B,r as a,F as d}from"./chunk-JMJ3UQ3L-C0Hu5JKs.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{A as H}from"./api-LAgipKeK.js";import{U as W}from"./user-Dp3F9fs-.js";import{c as G}from"./createLucideIcon-gSJn62ry.js";import{M as A}from"./mail-CU_4t7tJ.js";import{E as J}from"./ellipsis-BdR2wdv8.js";import{P}from"./plus-CvcafwRV.js";import{F as Q}from"./file-text-BXg5nGZM.js";import{C as X}from"./check-DpAwQKjv.js";import{P as Y}from"./pencil-AgqcFXCY.js";import{T as K}from"./trash-2-D-WZnS1m.js";import{f as r}from"./format-gSCb7gQz.js";const Z=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],ee=G("camera",Z),be=V(function(){const{member:t,notes:f,availablePacks:M,coupons:o}=q(),{tenant:D}=R(),N=B(),n=t.user.profile||{},[l,I]=a.useState("overview"),[E,m]=a.useState(null),[v,y]=a.useState(!1),[U,x]=a.useState(!1),[z,h]=a.useState(!1),[_,u]=a.useState(!1),[$,p]=a.useState(!1),[w,k]=a.useState(!1),b=[n.firstName,n.lastName].filter(Boolean).join(" ")||t.user.email,T=t.roles.map(s=>s.role).join(", ")||"Student",F=(t.purchasedPacks||[]).reduce((s,i)=>s+i.remainingCredits,0),O=t.bookings.filter(s=>{if(s.status!=="confirmed")return!1;const i=new Date(s.class?.startTime||s.createdAt)<new Date,c=!s.checkedInAt;return i&&c}).length,j=t.memberships.some(s=>s.status==="active"),S=j?"Active":"Inactive",L=async s=>{const i=s.target.files?.[0];if(i)try{k(!0);const c=await window.Clerk?.session?.getToken(),g=new FormData;g.append("file",i),g.append("memberId",t.id);const C=await(await fetch(`${H}/uploads/portrait`,{method:"POST",headers:{Authorization:`Bearer ${c}`,"X-Tenant-Slug":D.slug},body:g})).json();if(C.error)throw new Error(C.error);window.location.reload()}catch(c){alert(c.message||"Failed to upload photo")}finally{k(!1)}};return e.jsxs("div",{className:"max-w-5xl mx-auto pb-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"relative h-20 w-20 bg-zinc-100 rounded-full flex items-center justify-center border border-zinc-200 overflow-hidden cursor-pointer group",children:[n.portraitUrl?e.jsx("img",{src:n.portraitUrl,alt:b,className:"h-full w-full object-cover"}):e.jsx(W,{className:"h-8 w-8 text-zinc-400"}),e.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:w?e.jsx("span",{className:"text-white text-xs",children:"Uploading..."}):e.jsx(ee,{className:"h-6 w-6 text-white"})}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:L,disabled:w})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-3xl font-bold text-zinc-900",children:b}),e.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium border ${j?"bg-green-100 text-green-800 border-green-200":"bg-zinc-100 text-zinc-600 border-zinc-200"}`,children:S})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-zinc-500 text-sm",children:[e.jsx(A,{className:"h-4 w-4"}),e.jsx("span",{children:t.user.email}),e.jsx("span",{className:"mx-1",children:"•"}),e.jsx("span",{className:"capitalize px-2 py-0.5 bg-zinc-100 rounded-full text-xs font-medium border border-zinc-200",children:T})]}),e.jsxs("div",{className:"text-xs text-zinc-400 mt-1",children:["Joined ",r(new Date(t.joinedAt),"MMM d, yyyy")]})]})]}),e.jsxs("div",{className:"flex gap-2 relative",children:[e.jsx("button",{onClick:()=>x(!0),className:"px-3 py-2 border border-zinc-300 rounded-md text-sm font-medium hover:bg-zinc-50",children:"Edit Profile"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>h(!z),className:"px-3 py-2 bg-zinc-900 text-white rounded-md text-sm font-medium hover:bg-zinc-800 flex items-center gap-2",children:["Actions",e.jsx(J,{className:"h-4 w-4"})]}),z&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-zinc-200 rounded-md shadow-lg z-10 py-1",children:[e.jsx("button",{onClick:()=>{h(!1),u(!0)},className:"block w-full text-left px-4 py-2 text-sm text-zinc-700 hover:bg-zinc-50",children:"Send Email"}),e.jsx("div",{className:"border-t border-zinc-100 my-1"}),e.jsx("button",{onClick:()=>{h(!1),p(!0)},className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:"Deactivate Member"})]})]})]})]}),_&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg shadow-xl",children:[e.jsxs("h2",{className:"text-lg font-bold mb-4",children:["Send Email to ",b]}),e.jsxs(d,{method:"post",onSubmit:()=>u(!1),children:[e.jsx("input",{type:"hidden",name:"intent",value:"send_email"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Subject"}),e.jsx("input",{type:"text",name:"subject",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md text-sm",placeholder:"e.g. Important Update regarding your membership"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Message"}),e.jsx("textarea",{name:"body",rows:6,required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md text-sm",placeholder:"Write your message here..."})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>u(!1),className:"px-4 py-2 text-sm border border-zinc-300 rounded-md hover:bg-zinc-50",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(A,{className:"h-4 w-4"}),"Send"]})]})]})]})}),$&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md shadow-xl",children:[e.jsx("h2",{className:"text-lg font-bold text-red-600 mb-2",children:"Deactivate Member?"}),e.jsx("p",{className:"text-sm text-zinc-600 mb-6",children:"This will prevent the member from booking classes or accessing studio content. Their history will be preserved. You can reactivate them later."}),e.jsxs(d,{method:"post",onSubmit:()=>p(!1),children:[e.jsx("input",{type:"hidden",name:"intent",value:"update_status"}),e.jsx("input",{type:"hidden",name:"status",value:"inactive"}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>p(!1),className:"px-4 py-2 text-sm border border-zinc-300 rounded-md hover:bg-zinc-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm bg-red-600 text-white rounded-md hover:bg-red-700",children:"Deactivate"})]})]})]})}),U&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md shadow-xl",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Edit Profile"}),e.jsxs(d,{method:"post",onSubmit:()=>x(!1),children:[e.jsx("input",{type:"hidden",name:"intent",value:"update_profile"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"First Name"}),e.jsx("input",{type:"text",name:"firstName",defaultValue:n.firstName,className:"w-full px-3 py-2 border border-zinc-300 rounded-md text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Last Name"}),e.jsx("input",{type:"text",name:"lastName",defaultValue:n.lastName,className:"w-full px-3 py-2 border border-zinc-300 rounded-md text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",defaultValue:n.phone,className:"w-full px-3 py-2 border border-zinc-300 rounded-md text-sm"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 text-sm border border-zinc-300 rounded-md hover:bg-zinc-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm bg-zinc-900 text-white rounded-md hover:bg-zinc-800",children:"Save Changes"})]})]})]})}),e.jsx("div",{className:"flex border-b border-zinc-200 mb-6",children:[{id:"overview",label:"Overview"},{id:"memberships",label:"Memberships & Credits"},{id:"coupons",label:"Generated Coupons"},{id:"attendance",label:"Attendance"},{id:"documents",label:"Documents"},{id:"notes",label:"Staff Notes"}].map(s=>e.jsx("button",{onClick:()=>I(s.id),className:`px-4 py-2 text-sm font-medium border-b-2 text-zinc-600 hover:text-zinc-900 ${l===s.id?"border-blue-600 text-blue-600":"border-transparent"}`,children:s.label},s.id))}),e.jsxs("div",{className:"min-h-[400px]",children:[l==="overview"&&e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsx("div",{className:"col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white border border-zinc-200 rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Quick Stats"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-zinc-50 rounded border border-zinc-100",children:[e.jsx("div",{className:"text-2xl font-bold text-zinc-900",children:t.bookings.length}),e.jsx("div",{className:"text-xs text-zinc-500 uppercase tracking-wide mt-1",children:"Classes Taken"})]}),e.jsxs("div",{className:"p-4 bg-zinc-50 rounded border border-zinc-100",children:[e.jsx("div",{className:"text-2xl font-bold text-zinc-900",children:F}),e.jsx("div",{className:"text-xs text-zinc-500 uppercase tracking-wide mt-1",children:"Available Credits"})]}),e.jsxs("div",{className:"p-4 bg-zinc-50 rounded border border-zinc-100",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:O}),e.jsx("div",{className:"text-xs text-zinc-500 uppercase tracking-wide mt-1",children:"No Shows"})]}),e.jsxs("div",{className:"p-4 bg-zinc-50 rounded border border-zinc-100",children:[e.jsx("div",{className:`text-2xl font-bold ${j?"text-green-600":"text-zinc-400"}`,children:S}),e.jsx("div",{className:"text-xs text-zinc-500 uppercase tracking-wide mt-1",children:"Membership Status"})]})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"bg-white border border-zinc-200 rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"font-semibold text-sm mb-4 uppercase text-zinc-500 tracking-wider",children:"Contact Info"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-zinc-400",children:"Email"}),e.jsx("div",{className:"text-zinc-800",children:t.user.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-zinc-400",children:"Phone"}),e.jsx("div",{className:"text-zinc-800",children:n.phone||"Not provided"})]})]})]})})]}),l==="memberships"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs("button",{onClick:()=>y(!v),className:"flex items-center gap-2 px-3 py-2 bg-white border border-zinc-300 rounded-md text-sm font-medium hover:bg-zinc-50",children:[e.jsx(P,{className:"h-4 w-4"}),"Assign Pack"]}),e.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-zinc-300 rounded-md text-sm font-medium hover:bg-zinc-50",children:[e.jsx(P,{className:"h-4 w-4"}),"Add Plan"]})]}),v&&e.jsxs("div",{className:"bg-zinc-50 border border-zinc-200 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"font-semibold text-sm mb-3",children:"Assign Class Pack (Internal / POS)"}),e.jsxs(d,{method:"post",onSubmit:()=>y(!1),className:"flex gap-4 items-end",children:[e.jsx("input",{type:"hidden",name:"intent",value:"assign_pack"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-500 mb-1",children:"Select Pack"}),e.jsx("select",{name:"packId",className:"w-full text-sm border-zinc-300 rounded-md",children:(M||[]).map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.credits," credits) - $",(s.price/100).toFixed(2)]},s.id))})]}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700",children:"Assign & Charge"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-zinc-900 mb-3",children:"Active Memberships"}),t.memberships&&t.memberships.length>0?e.jsx("div",{className:"space-y-3",children:t.memberships.map(s=>e.jsxs("div",{className:"bg-white border border-zinc-200 rounded-lg p-4 shadow-sm flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-zinc-900",children:s.plan?.name||"Unknown Plan"}),e.jsxs("div",{className:"text-sm text-zinc-500 mt-1",children:["Status: ",e.jsx("span",{className:"capitalize font-medium text-zinc-700",children:s.status}),e.jsx("span",{className:"mx-2",children:"•"}),"Started ",r(new Date(s.startDate),"MMM d, yyyy")]})]}),e.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium border ${s.status==="active"?"bg-green-50 text-green-700 border-green-200":"bg-zinc-100 text-zinc-600 border-zinc-200"}`,children:s.status.toUpperCase()})]},s.id))}):e.jsx("div",{className:"text-sm text-zinc-500 italic",children:"No active memberships."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-zinc-900 mb-3",children:"Class Packs & Credits"}),t.purchasedPacks&&t.purchasedPacks.length>0?e.jsx("div",{className:"space-y-3",children:t.purchasedPacks.map(s=>e.jsxs("div",{className:"bg-white border border-zinc-200 rounded-lg p-4 shadow-sm flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-zinc-900",children:s.definition?.name||"Unknown Pack"}),e.jsxs("div",{className:"text-sm text-zinc-500 mt-1 flex items-center gap-3",children:[e.jsxs("span",{children:["Purchased ",r(new Date,"MMM d, yyyy")]})," ",s.expiresAt&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{className:new Date(s.expiresAt)<new Date?"text-red-600":"",children:["Expires ",r(new Date(s.expiresAt),"MMM d, yyyy")]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-zinc-900",children:[s.remainingCredits," / ",s.initialCredits]}),e.jsx("div",{className:"text-xs text-zinc-500 uppercase",children:"Credits Left"})]})]},s.id))}):e.jsx("div",{className:"text-sm text-zinc-500 italic",children:"No packs purchased."})]})]}),l==="coupons"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:e.jsx("p",{className:"text-sm text-blue-800",children:"These are coupons automatically generated for this student by marketing automations. If a student missed their window, you can manually reactivate a coupon for 7 days."})}),o&&o.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.map(s=>{const i=new Date(s.expiresAt)<new Date,c=!s.active||i;return e.jsxs("div",{className:"bg-white border border-zinc-200 rounded-lg p-4 shadow-sm relative",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("div",{className:"font-mono text-lg font-bold text-zinc-900 bg-zinc-100 px-2 py-1 rounded",children:s.code}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${s.active?i?"bg-red-100 text-red-700":"bg-green-100 text-green-700":"bg-zinc-100 text-zinc-500"}`,children:s.active?i?"Expired":"Active":"Inactive"})]}),e.jsxs("div",{className:"text-sm text-zinc-600 mb-4",children:[s.type==="percent"?`${s.value}% Off`:`$${s.value} Off`,e.jsxs("div",{className:"text-xs text-zinc-400 mt-1",children:["Expires: ",r(new Date(s.expiresAt),"MMM d, yyyy")]})]}),c&&e.jsxs(d,{method:"post",children:[e.jsx("input",{type:"hidden",name:"intent",value:"reactivate_coupon"}),e.jsx("input",{type:"hidden",name:"couponId",value:s.id}),e.jsx("button",{type:"submit",className:"w-full py-2 text-sm font-medium text-blue-600 bg-blue-50 rounded hover:bg-blue-100 transition-colors",children:"Reactivate for 7 Days"})]})]},s.id)})}):e.jsx("div",{className:"text-center py-10 bg-zinc-50 rounded-lg border border-zinc-200 text-zinc-500",children:"No coupons have been generated for this student."})]}),l==="attendance"&&e.jsx("div",{className:"bg-white border border-zinc-200 rounded-lg overflow-hidden shadow-sm",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-zinc-50 border-b border-zinc-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-medium text-zinc-500",children:"Date"}),e.jsx("th",{className:"px-4 py-3 font-medium text-zinc-500",children:"Class"}),e.jsx("th",{className:"px-4 py-3 font-medium text-zinc-500",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-100",children:t.bookings.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-4 py-8 text-center text-zinc-400",children:"No attendance history"})}):t.bookings.map(s=>e.jsxs("tr",{className:"hover:bg-zinc-50",children:[e.jsx("td",{className:"px-4 py-3 text-zinc-600",children:r(new Date(s.createdAt),"MMM d, yyyy h:mm a")}),e.jsx("td",{className:"px-4 py-3 text-zinc-900 font-medium",children:s.class?.title||"Unknown Class"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium capitalize
                                                    ${s.status==="confirmed"?"bg-green-100 text-green-800":s.status==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})})]},s.id))})]})}),l==="documents"&&e.jsx("div",{className:"bg-white border border-zinc-200 rounded-lg overflow-hidden shadow-sm",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-zinc-50 border-b border-zinc-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-medium text-zinc-500",children:"Document"}),e.jsx("th",{className:"px-4 py-3 font-medium text-zinc-500",children:"Signed Date"}),e.jsx("th",{className:"px-4 py-3 font-medium text-zinc-500",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-100",children:t.waiverSignatures?.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-4 py-8 text-center text-zinc-400",children:"No signed documents"})}):t.waiverSignatures?.map(s=>e.jsxs("tr",{className:"hover:bg-zinc-50",children:[e.jsxs("td",{className:"px-4 py-3 text-zinc-900 font-medium flex items-center gap-2",children:[e.jsx(Q,{size:16,className:"text-zinc-400"}),s.template?.title||"Waiver"]}),e.jsx("td",{className:"px-4 py-3 text-zinc-600",children:r(new Date(s.signedAt),"MMM d, yyyy h:mm a")}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(X,{size:12}),"Signed"]})})]},s.id))})]})}),l==="notes"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsx("div",{children:e.jsxs("div",{className:"bg-zinc-50 border border-zinc-200 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-sm mb-3",children:"Add Note"}),e.jsxs(d,{method:"post",children:[e.jsx("input",{type:"hidden",name:"intent",value:"add_note"}),e.jsx("textarea",{name:"note",rows:4,className:"w-full border border-zinc-300 rounded p-3 text-sm focus:ring-2 focus:ring-blue-500 outline-none mb-3 bg-white",placeholder:"Enter confidential notes about this student...",required:!0}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:N.state==="submitting",className:"px-4 py-2 bg-blue-600 text-white rounded text-sm font-medium hover:bg-blue-700 disabled:opacity-50",children:N.state==="submitting"?"Saving...":"Save Note"})})]})]})}),e.jsx("div",{className:"space-y-4",children:f.length===0?e.jsx("div",{className:"text-center text-zinc-400 py-10 italic",children:"No notes added yet."}):f.map(s=>e.jsx("div",{className:"bg-white border border-zinc-200 rounded-lg p-4 shadow-sm relative group",children:E===s.id?e.jsxs(d,{method:"post",onSubmit:()=>m(null),children:[e.jsx("input",{type:"hidden",name:"intent",value:"edit_note"}),e.jsx("input",{type:"hidden",name:"noteId",value:s.id}),e.jsx("textarea",{name:"note",defaultValue:s.note,rows:3,className:"w-full border border-zinc-300 rounded p-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none mb-2",required:!0,autoFocus:!0}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>m(null),className:"px-3 py-1 text-xs border border-zinc-300 rounded hover:bg-zinc-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700",children:"Save"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-zinc-800 whitespace-pre-wrap pr-8",children:s.note}),e.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-1 opacity-100 sm:opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>m(s.id),className:"p-1.5 text-zinc-400 hover:text-blue-600 hover:bg-zinc-50 rounded",title:"Edit",children:e.jsx(Y,{className:"h-3.5 w-3.5"})}),e.jsxs(d,{method:"post",onSubmit:i=>{confirm("Are you sure you want to delete this note?")||i.preventDefault()},children:[e.jsx("input",{type:"hidden",name:"intent",value:"delete_note"}),e.jsx("input",{type:"hidden",name:"noteId",value:s.id}),e.jsx("button",{type:"submit",className:"p-1.5 text-zinc-400 hover:text-red-600 hover:bg-zinc-50 rounded",title:"Delete",children:e.jsx(K,{className:"h-3.5 w-3.5"})})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs text-zinc-400 border-t border-zinc-50 pt-2",children:[e.jsxs("span",{children:["Add by ",s.author?.user?.profile?.firstName||s.author?.user?.email||"Unknown Staff"]}),e.jsx("span",{children:r(new Date(s.createdAt),"MMM d, yyyy")})]})]})},s.id))})]})]})]})});export{be as default};
