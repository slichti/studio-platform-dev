import{i as y,w as z,u as N}from"./chunk-EPOLDU6W-BNyyBaiR.js";import{j as e}from"./vendor-puck-aUaaDwmz.js";import{a as u}from"./api-D1U4i9fn.js";import{a as d}from"./vendor-livekit-D3VpklN2.js";import{c as v}from"./createLucideIcon-CcD9UNCP.js";const k=[["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M19.38 6.813A9 9 0 0 1 20.8 10.2a2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"11xh7x"}],["path",{d:"M9 12h.01",key:"157uk2"}]],w=v("baby",k);function S({token:a}){const s=y(),[n,l]=d.useState([]),[c,x]=d.useState(!1),[b,o]=d.useState(null);d.useEffect(()=>{a&&u("/users/me/family",a).then(t=>{t.family&&l(t.family)}).catch(t=>{console.error("Failed to load family",t),o("Failed to load family members")})},[a]),d.useEffect(()=>{s.data?.success&&s.data?.child&&(l(t=>[...t,s.data.child]),x(!1))},[s.data]);const m=async t=>{try{const r=await u("/users/me/switch-profile",a,{method:"POST",body:JSON.stringify({targetUserId:t})});r.token&&(document.cookie=`__impersonate_token=${r.token}; path=/; SameSite=Lax`,localStorage.setItem("impersonation_token",r.token),window.location.reload())}catch(r){console.error(r),o(r.message||"Failed to switch profile")}};return e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border border-zinc-200 dark:border-zinc-800 p-6 mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-zinc-900 dark:text-zinc-100",children:"Family Members"}),e.jsx("p",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:"Manage household accounts and dependents."})]}),e.jsx("button",{onClick:()=>x(!c),className:"text-sm font-medium text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors",children:c?"Cancel":"+ Add Child"})]}),b&&e.jsx("div",{className:"p-3 mb-4 text-sm text-red-600 bg-red-50 dark:bg-red-900/20 dark:text-red-400 rounded-md border border-red-200 dark:border-red-800",children:b}),c&&e.jsxs(s.Form,{method:"post",className:"mb-6 p-4 bg-zinc-50 dark:bg-zinc-900/50 rounded-md border border-zinc-200 dark:border-zinc-800 animate-in fade-in slide-in-from-top-2",children:[e.jsx("input",{type:"hidden",name:"intent",value:"add_child"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase mb-1",children:"First Name"}),e.jsx("input",{name:"firstName",required:!0,className:"w-full px-3 py-2 bg-white dark:bg-zinc-950 border border-zinc-300 dark:border-zinc-700 rounded-md text-sm text-zinc-900 dark:text-zinc-100 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",placeholder:"e.g. Leo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase mb-1",children:"Last Name"}),e.jsx("input",{name:"lastName",required:!0,className:"w-full px-3 py-2 bg-white dark:bg-zinc-950 border border-zinc-300 dark:border-zinc-700 rounded-md text-sm text-zinc-900 dark:text-zinc-100 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",placeholder:"e.g. Smith"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase mb-1",children:"Date of Birth"}),e.jsx("input",{name:"dob",type:"date",className:"w-full px-3 py-2 bg-white dark:bg-zinc-950 border border-zinc-300 dark:border-zinc-700 rounded-md text-sm text-zinc-900 dark:text-zinc-100 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all"})]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsx("button",{type:"submit",disabled:s.state==="submitting",className:"bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 px-4 py-2 text-sm font-medium rounded-md hover:bg-zinc-800 dark:hover:bg-zinc-200 disabled:opacity-50 transition-colors shadow-sm",children:s.state==="submitting"?"Adding Profile...":"Create Child Profile"})})]}),e.jsxs("div",{className:"space-y-3",children:[n.length===0&&!c&&e.jsxs("div",{className:"text-center py-8 bg-zinc-50 dark:bg-zinc-900/50 rounded-lg border border-dashed border-zinc-200 dark:border-zinc-800",children:[e.jsx(T,{className:"w-8 h-8 text-zinc-300 mx-auto mb-2"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400 text-sm",children:"No family members linked yet."})]}),n.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-zinc-100 dark:border-zinc-800 rounded-lg bg-zinc-50 dark:bg-zinc-900/30 hover:bg-zinc-100 dark:hover:bg-zinc-900/50 transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 flex items-center justify-center font-bold text-sm shadow-sm ring-1 ring-white dark:ring-zinc-800",children:t.firstName[0]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"font-medium text-sm text-zinc-900 dark:text-zinc-100",children:[t.firstName," ",t.lastName]}),t.memberId&&e.jsx("span",{className:"text-[10px] font-medium bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 px-1.5 py-0.5 rounded-full",children:"Member"})]}),e.jsx("div",{className:"flex items-center gap-3 mt-0.5",children:t.dob&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-zinc-500 dark:text-zinc-400",children:[e.jsx(w,{size:12}),e.jsx("span",{children:new Date(t.dob).toLocaleDateString()})]})})]})]}),e.jsx("button",{onClick:()=>m(t.userId),className:"bg-white dark:bg-black border border-zinc-200 dark:border-zinc-700 text-zinc-700 dark:text-zinc-300 px-3 py-1.5 text-xs font-medium rounded-md hover:border-blue-500 hover:text-blue-600 dark:hover:text-blue-400 transition-colors shadow-sm opacity-0 group-hover:opacity-100",children:"Switch Profile"})]},t.userId))]})]})}function T({className:a}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:a,children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})}function M({token:a,tenantSlug:s}){const[n,l]=d.useState([]),[c,x]=d.useState(!0),[b,o]=d.useState(!1),m=[{id:1,label:"Monday"},{id:2,label:"Tuesday"},{id:3,label:"Wednesday"},{id:4,label:"Thursday"},{id:5,label:"Friday"},{id:6,label:"Saturday"},{id:0,label:"Sunday"}];d.useEffect(()=>{t()},[]);async function t(){try{const i=await u("/appointments/availability/settings",a,{headers:{"X-Tenant-Slug":s}});i.availabilities&&l(i.availabilities)}catch(i){console.error("Failed to load availability",i)}finally{x(!1)}}async function r(i){i.preventDefault(),o(!0);const h=i.target,f=new FormData(h),p=Number(f.get("dayOfWeek")),g=f.get("startTime"),j=f.get("endTime");try{await u("/appointments/availability",a,{method:"POST",headers:{"X-Tenant-Slug":s},body:JSON.stringify({dayOfWeek:p,startTime:g,endTime:j})}),await t(),h.reset()}catch{alert("Failed to save")}finally{o(!1)}}return c?e.jsx("div",{children:"Loading availability..."}):e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Instructor Availability"}),e.jsx("p",{className:"text-sm text-zinc-500 mb-4",children:"Set your weekly recurring available hours for private sessions."}),e.jsxs("div",{className:"space-y-2 mb-6",children:[n.length===0&&e.jsx("p",{className:"text-sm text-zinc-400 italic",children:"No availability set."}),n.map(i=>e.jsxs("div",{className:"flex items-center justify-between bg-zinc-50 px-3 py-2 rounded text-sm",children:[e.jsx("span",{className:"font-medium text-zinc-700",children:m.find(h=>h.id===i.dayOfWeek)?.label}),e.jsxs("span",{className:"text-zinc-600",children:[i.startTime," - ",i.endTime]})]},i.id))]}),e.jsxs("form",{onSubmit:r,className:"flex gap-3 items-end border-t border-zinc-100 pt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600 mb-1",children:"Day"}),e.jsx("select",{name:"dayOfWeek",className:"text-sm border border-zinc-300 rounded px-2 py-1.5 focus:ring-2 focus:ring-blue-500 outline-none",children:m.map(i=>e.jsx("option",{value:i.id,children:i.label},i.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600 mb-1",children:"Start"}),e.jsx("input",{name:"startTime",type:"time",required:!0,className:"text-sm border border-zinc-300 rounded px-2 py-1.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600 mb-1",children:"End"}),e.jsx("input",{name:"endTime",type:"time",required:!0,className:"text-sm border border-zinc-300 rounded px-2 py-1.5"})]}),e.jsx("button",{type:"submit",disabled:b,className:"bg-zinc-900 text-white px-3 py-1.5 rounded text-sm font-medium hover:bg-zinc-800 disabled:opacity-50",children:b?"Adding...":"Add Slot"})]})]})}function F({token:a,slug:s}){const[n,l]=d.useState(null),[c,x]=d.useState(!1);d.useEffect(()=>{u("/members/me",a,{headers:{"X-Tenant-Slug":s}}).then(m=>{m.member&&l(m.member.settings||{})}).catch(console.error)},[a,s]);async function b(){if(!n)return;x(!0);const t=!(n.notifications||{}).sms;try{const r=await u("/members/me/settings",a,{method:"PATCH",headers:{"X-Tenant-Slug":s},body:JSON.stringify({notifications:{sms:t}})});r.settings&&l(r.settings)}catch{alert("Failed to update settings")}finally{x(!1)}}if(!n)return null;const o=n.notifications?.sms===!0;return e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Notifications"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-zinc-900",children:"SMS Notifications"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Receive class reminders and updates via text."})]}),e.jsx("button",{onClick:b,disabled:c,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${o?"bg-zinc-900":"bg-zinc-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${o?"translate-x-6":"translate-x-1"}`})})]})]})}const O=z(function(){const{user:s,token:n,slug:l}=N();return e.jsxs("div",{className:"max-w-2xl mx-auto py-8 px-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-zinc-900 mb-2",children:"Your Profile"}),e.jsx("p",{className:"text-zinc-500 mb-8",children:"Manage your information and family members."}),e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Personal Info"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-zinc-500 uppercase",children:"First Name"}),e.jsx("p",{className:"text-zinc-900",children:s.profile?.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-zinc-500 uppercase",children:"Last Name"}),e.jsx("p",{className:"text-zinc-900",children:s.profile?.lastName})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-xs font-semibold text-zinc-500 uppercase",children:"Email"}),e.jsx("p",{className:"text-zinc-900",children:s.email})]})]})]}),e.jsx(F,{token:n,slug:l}),e.jsx(M,{token:n,tenantSlug:l}),e.jsx(S,{token:n})]})});export{O as default};
