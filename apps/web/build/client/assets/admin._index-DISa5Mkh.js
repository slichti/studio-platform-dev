import{w as m,d as h,r as u}from"./chunk-JMJ3UQ3L-C0Hu5JKs.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{C as d,a as j,b as p,d as x}from"./Card-IOiQbqBT.js";import{B as f}from"./Badge-BS0VuEA_.js";function N({children:s,className:t=""}){return e.jsx("div",{className:`w-full overflow-auto ${t}`,children:e.jsx("table",{className:"w-full text-sm text-left",children:s})})}function b({children:s}){return e.jsx("thead",{className:"text-xs text-zinc-500 uppercase bg-zinc-50/50 border-b border-zinc-200",children:s})}function l({children:s,className:t=""}){return e.jsx("tr",{className:`border-b border-zinc-100 last:border-0 hover:bg-zinc-50/50 transition-colors ${t}`,children:s})}function c({children:s,className:t=""}){return e.jsx("th",{className:`px-6 py-3 font-medium ${t}`,children:s})}function a({children:s,className:t="",...r}){return e.jsx("td",{className:`px-6 py-4 ${t}`,...r,children:s})}function i({title:s,value:t,status:r,trend:n}){const o={success:"text-emerald-600",warning:"text-amber-600",error:"text-red-600",neutral:"text-zinc-900"};return e.jsx(d,{children:e.jsx(x,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-zinc-500",children:s}),e.jsx("h4",{className:`text-2xl font-bold mt-2 ${o[r||"neutral"]}`,children:t})]}),n&&e.jsx("span",{className:"text-xs font-medium px-2 py-1 bg-zinc-100 rounded-full text-zinc-600",children:n})]})})})}function g({details:s}){if(!s)return e.jsx("span",{className:"text-zinc-400",children:"-"});try{const t=typeof s=="string"?JSON.parse(s):s,r=Object.keys(t);return r.length===0?e.jsx("span",{className:"text-zinc-400",children:"-"}):e.jsx("div",{className:"flex flex-wrap gap-1",children:r.map(n=>e.jsxs("div",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[10px] bg-zinc-100 text-zinc-600 border border-zinc-200",children:[e.jsxs("span",{className:"font-medium mr-1",children:[n,":"]}),e.jsx("span",{className:"text-zinc-500 truncate max-w-[100px]",title:String(t[n]),children:String(t[n])})]},n))})}catch{return e.jsx("span",{className:"text-zinc-500 truncate",children:String(s)})}}const T=m(function(){const{logs:t,health:r}=h();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight text-zinc-900",children:"Dashboard Overview"}),e.jsx("p",{className:"text-zinc-500",children:"System performance and activity monitoring."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(i,{title:"System Status",value:r?.status==="error"?"Error":r?.status==="healthy"?"Operational":"Degraded",status:r?.status==="error"?"error":r?.status==="healthy"?"success":"warning",trend:r?.status==="error"?r?.error||"Unknown Error":`Latency: ${r?.dbLatencyMs||0}ms`}),e.jsx(i,{title:"Active Tenants",value:String(r?.activeTenants||0),status:"neutral"}),e.jsx(i,{title:"Total Users",value:String(r?.totalUsers||0),status:"neutral"}),e.jsx(i,{title:"Recent Errors",value:String(r?.recentErrors||0),status:r?.recentErrors>0?"error":"success",trend:"Last 24h"})]}),e.jsxs(d,{children:[e.jsx(j,{children:e.jsx(p,{children:"Recent Audit Logs"})}),e.jsx(x,{className:"p-0",children:e.jsxs(N,{children:[e.jsx(b,{children:e.jsxs(l,{children:[e.jsx(c,{className:"w-[50px]"}),e.jsx(c,{children:"Time"}),e.jsx(c,{children:"Action"}),e.jsx(c,{children:"Target"}),e.jsx(c,{children:"IP Address"})]})}),e.jsxs("tbody",{children:[t.map(n=>e.jsx(z,{log:n},n.id)),t.length===0&&e.jsx(l,{children:e.jsx(a,{className:"text-center text-zinc-500 py-8",colSpan:5,children:"No recent activity found."})})]})]})})]})]})});function z({log:s}){const[t,r]=u.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(l,{className:"cursor-pointer hover:bg-zinc-50 transition-colors",onClick:()=>r(!t),children:[e.jsx(a,{className:"p-2 text-center text-zinc-400",children:e.jsx("span",{className:`transform transition-transform inline-block ${t?"rotate-90":""}`,children:"â€º"})}),e.jsx(a,{className:"font-mono text-xs text-zinc-500",children:new Date(s.createdAt).toISOString().replace("T"," ").substring(0,16)}),e.jsx(a,{children:e.jsx(f,{variant:s.action==="USER_LOGIN"?"success":(s.action==="USER_LOGOUT","outline"),children:s.action})}),e.jsx(a,{className:"font-mono text-xs",children:s.targetId||"-"}),e.jsx(a,{className:"font-mono text-xs text-zinc-400",children:s.ipAddress})]}),t&&e.jsx(l,{className:"bg-zinc-50/50 hover:bg-zinc-50/50",children:e.jsx(a,{colSpan:5,className:"p-4 pl-12",children:e.jsxs("div",{className:"bg-white border border-zinc-200 rounded p-3 shadow-sm text-xs font-mono text-zinc-600 overflow-auto max-h-[300px]",children:[e.jsx(g,{details:s.details}),e.jsxs("div",{className:"mt-2 text-[10px] text-zinc-400 border-t pt-2 flex gap-4",children:[e.jsxs("span",{children:["ID: ",s.id]}),e.jsxs("span",{children:["User Agent: ",s.details?.userAgent||"N/A"]})]})]})})})]})}export{T as default};
