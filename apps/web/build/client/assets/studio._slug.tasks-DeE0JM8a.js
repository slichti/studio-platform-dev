import{w as E,c as M,r as o}from"./chunk-JMJ3UQ3L-ksN8Xei4.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{a as u}from"./api-D1U4i9fn.js";import{M as I}from"./Modal-Copm4b-l.js";import{C as k}from"./circle-check-big-DTYMKqtr.js";import{P as z}from"./plus-DIimcOTd.js";import{C as F}from"./calendar-BMqFr-28.js";import{T as L}from"./trash-2-DGlI0wOF.js";import{f as X}from"./format-CLi5Eqkk.js";import"./createLucideIcon-mmuW3u_I.js";const W=E(function(){const{initialTasks:y,me:x,token:l,slug:c}=M(),[m,b]=o.useState(y),[N,d]=o.useState(!1),[g,p]=o.useState(!1),[h,f]=o.useState("all"),[a,j]=o.useState(null),[i,n]=o.useState({title:"",description:"",priority:"medium",status:"todo",dueDate:"",assignedToId:x?.id||""}),w=async()=>{const t=await u("/tasks",l,{headers:{"X-Tenant-Slug":c}});b(t||[])},v=()=>{j(null),n({title:"",description:"",priority:"medium",status:"todo",dueDate:"",assignedToId:x?.id||""}),d(!0)},T=t=>{j(t),n({title:t.title,description:t.description||"",priority:t.priority,status:t.status,dueDate:t.dueDate?new Date(t.dueDate).toISOString().split("T")[0]:"",assignedToId:t.assignedToId||""}),d(!0)},D=async t=>{t.preventDefault(),p(!0);try{const r=a?`/tasks/${a.id}`:"/tasks";await u(r,l,{method:a?"PATCH":"POST",headers:{"X-Tenant-Slug":c},body:JSON.stringify(i)}),await w(),d(!1)}catch(r){alert("Failed to save task: "+r.message)}finally{p(!1)}},C=async t=>{if(confirm("Delete this task?"))try{await u(`/tasks/${t}`,l,{method:"DELETE",headers:{"X-Tenant-Slug":c}}),b(m.filter(r=>r.id!==t)),a?.id===t&&d(!1)}catch(r){console.error(r)}},S=async(t,r)=>{b(m.map(s=>s.id===t?{...s,status:r}:s));try{await u(`/tasks/${t}`,l,{method:"PATCH",headers:{"X-Tenant-Slug":c},body:JSON.stringify({status:r})})}catch(s){console.error(s)}},P=m.filter(t=>h==="mine"?t.assignedToId===x?.id:!0),$=t=>{switch(t){case"high":return"text-red-700 bg-red-50 border-red-200";case"medium":return"text-orange-700 bg-orange-50 border-orange-200";case"low":return"text-blue-700 bg-blue-50 border-blue-200";default:return"text-gray-700 bg-gray-50"}},O=[{id:"todo",title:"To Do",color:"bg-zinc-100 dark:bg-zinc-800/50",border:"border-zinc-200 dark:border-zinc-700"},{id:"in_progress",title:"In Progress",color:"bg-blue-50/50 dark:bg-blue-900/10",border:"border-blue-200 dark:border-blue-800"},{id:"done",title:"Done",color:"bg-green-50/50 dark:bg-green-900/10",border:"border-green-200 dark:border-green-800"}];return e.jsxs("div",{className:"p-6 h-[calc(100vh-64px)] flex flex-col",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[e.jsx("div",{children:e.jsxs("h1",{className:"text-2xl font-bold text-zinc-900 dark:text-zinc-100 flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-blue-100 text-blue-600 rounded-lg",children:e.jsx(k,{size:24})}),"Tasks Board"]})}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("div",{className:"flex bg-zinc-100 dark:bg-zinc-800 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>f("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-all ${h==="all"?"bg-white dark:bg-zinc-700 shadow-sm text-zinc-900 dark:text-zinc-100":"text-zinc-500 hover:text-zinc-900 dark:hover:text-zinc-300"}`,children:"All Tasks"}),e.jsx("button",{onClick:()=>f("mine"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-all ${h==="mine"?"bg-white dark:bg-zinc-700 shadow-sm text-zinc-900 dark:text-zinc-100":"text-zinc-500 hover:text-zinc-900 dark:hover:text-zinc-300"}`,children:"My Tasks"})]}),e.jsxs("button",{onClick:v,className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 flex items-center gap-2 shadow-sm transition-all hover:scale-105 active:scale-95",children:[e.jsx(z,{size:18}),"New Task"]})]})]}),e.jsx("div",{className:"flex-1 overflow-x-auto overflow-y-hidden",children:e.jsx("div",{className:"flex gap-6 h-full min-w-[1000px]",children:O.map(t=>{const r=P.filter(s=>s.status===t.id);return e.jsxs("div",{className:`flex-1 flex flex-col rounded-xl border ${t.border} ${t.color} backdrop-blur-sm min-w-[300px]`,children:[e.jsxs("div",{className:"p-4 flex items-center justify-between border-b border-inherit",children:[e.jsxs("h3",{className:"font-semibold text-zinc-700 dark:text-zinc-200 flex items-center gap-2",children:[t.title,e.jsx("span",{className:"bg-white/50 dark:bg-black/20 px-2 py-0.5 rounded-full text-xs",children:r.length})]}),t.id==="todo"&&e.jsx("button",{onClick:v,className:"text-zinc-400 hover:text-zinc-700 dark:hover:text-zinc-200",children:e.jsx(z,{size:16})})]}),e.jsx("div",{className:"p-3 flex-1 overflow-y-auto space-y-3",children:r.map(s=>e.jsxs("div",{onClick:()=>T(s),className:"bg-white dark:bg-zinc-800 p-4 rounded-lg shadow-sm border border-zinc-200 dark:border-zinc-700 hover:border-blue-400 dark:hover:border-blue-500 hover:shadow-md transition-all cursor-pointer group animate-in fade-in slide-in-from-bottom-2 duration-300",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wide border ${$(s.priority)}`,children:s.priority}),t.id!=="done"&&e.jsx("button",{onClick:A=>{A.stopPropagation(),S(s.id,"done")},className:"text-zinc-300 hover:text-green-500 opacity-0 group-hover:opacity-100 transition-opacity",title:"Mark as Done",children:e.jsx(k,{size:16})})]}),e.jsx("h4",{className:"font-medium text-zinc-900 dark:text-zinc-100 mb-1 leading-snug",children:s.title}),s.description&&e.jsx("p",{className:"text-xs text-zinc-500 dark:text-zinc-400 line-clamp-2 mb-3",children:s.description}),e.jsx("div",{className:"flex items-center justify-between mt-3 pt-3 border-t border-zinc-100 dark:border-zinc-700/50",children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.assignee?.userProfile?.firstName&&e.jsx("div",{className:"w-5 h-5 rounded-full bg-indigo-100 text-indigo-700 flex items-center justify-center text-[10px] font-bold",title:s.assignee.userProfile.firstName,children:s.assignee.userProfile.firstName[0]}),s.dueDate&&e.jsxs("div",{className:`flex items-center gap-1 text-[10px] ${new Date(s.dueDate)<new Date&&s.status!=="done"?"text-red-500 font-bold":"text-zinc-400"}`,children:[e.jsx(F,{size:10}),X(new Date(s.dueDate),"MMM d")]})]})})]},s.id))})]},t.id)})})}),e.jsx(I,{isOpen:N,onClose:()=>d(!1),title:a?"Edit Task":"Create New Task",children:e.jsxs("form",{onSubmit:D,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-zinc-300",children:"Task Title"}),e.jsx("input",{required:!0,className:"w-full px-3 py-2 border rounded-lg dark:bg-zinc-800 dark:border-zinc-700 dark:text-zinc-100 focus:ring-2 focus:ring-blue-500 outline-none transition-all",value:i.title,onChange:t=>n({...i,title:t.target.value}),placeholder:"e.g. Follow up with John"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-zinc-300",children:"Description"}),e.jsx("textarea",{className:"w-full px-3 py-2 border rounded-lg dark:bg-zinc-800 dark:border-zinc-700 dark:text-zinc-100 focus:ring-2 focus:ring-blue-500 outline-none transition-all h-24 resize-none",value:i.description,onChange:t=>n({...i,description:t.target.value}),placeholder:"Details about the task..."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-zinc-300",children:"Status"}),e.jsxs("select",{className:"w-full px-3 py-2 border rounded-lg dark:bg-zinc-800 dark:border-zinc-700 dark:text-zinc-100",value:i.status,onChange:t=>n({...i,status:t.target.value}),children:[e.jsx("option",{value:"todo",children:"To Do"}),e.jsx("option",{value:"in_progress",children:"In Progress"}),e.jsx("option",{value:"done",children:"Done"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-zinc-300",children:"Priority"}),e.jsxs("select",{className:"w-full px-3 py-2 border rounded-lg dark:bg-zinc-800 dark:border-zinc-700 dark:text-zinc-100",value:i.priority,onChange:t=>n({...i,priority:t.target.value}),children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1 dark:text-zinc-300",children:"Due Date"}),e.jsx("input",{type:"date",className:"w-full px-3 py-2 border rounded-lg dark:bg-zinc-800 dark:border-zinc-700 dark:text-zinc-100",value:i.dueDate,onChange:t=>n({...i,dueDate:t.target.value})})]})}),e.jsxs("div",{className:"flex gap-3 justify-end pt-6 border-t dark:border-zinc-700",children:[a&&e.jsxs("button",{type:"button",onClick:()=>C(a.id),className:"px-4 py-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg mr-auto flex items-center gap-2",children:[e.jsx(L,{size:16}),"Delete"]}),e.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 text-zinc-600 dark:text-zinc-400 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-lg font-medium",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:g,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium disabled:opacity-50 shadow-sm hover:shadow active:scale-95 transition-all",children:g?"Saving...":a?"Save Changes":"Create Task"})]})]})})]})});export{W as default};
