import{w as S,d as A,e as k,r as d}from"./chunk-JMJ3UQ3L-CSq87dux.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{Z as g}from"./zap-B64fcun8.js";import{P as N}from"./plus-DB1258a-.js";import{U as _}from"./users-Dm4m26s8.js";import{C as M}from"./calendar-ChqeGSdO.js";import{T as v}from"./target-Ddys_6Cw.js";import{C as h}from"./clock-zZjniR5E.js";import{c as z}from"./createLucideIcon-pjmwgCcP.js";import{P as T}from"./play-CstvSI4M.js";import{T as D}from"./trash-2-BDP03pl4.js";import{X as P}from"./x-C7XfQc6H.js";import{M as $}from"./mail-CyYX8Lfw.js";import{M as E}from"./message-square-DsiSLrUZ.js";const I=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],R=z("bell",I);const B=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],O=z("pause",B),y=[{id:"new_member",label:"New Member Signs Up",icon:_},{id:"class_booked",label:"Class Booked",icon:M},{id:"class_missed",label:"Class No-Show",icon:v},{id:"inactive_days",label:"Inactive for X Days",icon:h},{id:"birthday",label:"Member Birthday",icon:R},{id:"membership_expiring",label:"Membership Expiring",icon:h}],f=[{id:"send_email",label:"Send Email",icon:$},{id:"send_sms",label:"Send SMS",icon:E},{id:"add_tag",label:"Add Tag",icon:v},{id:"wait",label:"Wait (Delay)",icon:h}],se=S(function(){const{automations:o,stats:n}=A(),l=k(),[c,a]=d.useState(!1),r=s=>{l({intent:"toggle",id:s},{method:"post"})},m=s=>{confirm("Delete this automation?")&&l({intent:"delete",id:s},{method:"post"})};return e.jsxs("div",{className:"flex flex-col h-full bg-zinc-50",children:[e.jsx("header",{className:"bg-white border-b border-zinc-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-violet-500 to-purple-600 rounded-lg text-white",children:e.jsx(g,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-zinc-900",children:"Automations"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Set up automated email & SMS campaigns"})]})]}),e.jsxs("button",{onClick:()=>a(!0),className:"px-4 py-2 bg-zinc-900 text-white rounded-lg text-sm font-medium hover:bg-zinc-800 flex items-center gap-2",children:[e.jsx(N,{size:16})," Create Automation"]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[n&&e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-zinc-900",children:n.totalAutomations||0}),e.jsx("div",{className:"text-xs text-zinc-500",children:"Total Automations"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.activeCount||0}),e.jsx("div",{className:"text-xs text-zinc-500",children:"Active"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.emailsSent||0}),e.jsx("div",{className:"text-xs text-zinc-500",children:"Emails Sent (30d)"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.smsSent||0}),e.jsx("div",{className:"text-xs text-zinc-500",children:"SMS Sent (30d)"})]})]}),o.length===0?e.jsxs("div",{className:"text-center py-20 bg-white rounded-xl border border-zinc-200",children:[e.jsx(g,{size:48,className:"mx-auto mb-4 text-zinc-300"}),e.jsx("p",{className:"text-zinc-500 mb-4",children:"No automations yet"}),e.jsx("button",{onClick:()=>a(!0),className:"text-sm text-zinc-900 underline",children:"Create your first"})]}):e.jsx("div",{className:"space-y-4",children:o.map(s=>{const i=y.find(p=>p.id===s.trigger),x=i?.icon||g;return e.jsx("div",{className:`bg-white rounded-xl border ${s.isActive?"border-green-200":"border-zinc-200"} p-5`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${s.isActive?"bg-green-100":"bg-zinc-100"}`,children:e.jsx(x,{size:24,className:s.isActive?"text-green-600":"text-zinc-400"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold text-zinc-900",children:s.name}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${s.isActive?"bg-green-100 text-green-700":"bg-zinc-100 text-zinc-500"}`,children:s.isActive?"Active":"Paused"})]}),e.jsxs("p",{className:"text-sm text-zinc-500 mt-1",children:["Trigger: ",i?.label||s.trigger]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-zinc-400",children:[e.jsxs("span",{children:["Actions: ",s.actions?.length||0]}),e.jsxs("span",{children:["Runs: ",s.runCount||0]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>r(s.id),className:`p-2 rounded-lg ${s.isActive?"hover:bg-yellow-50 text-yellow-600":"hover:bg-green-50 text-green-600"}`,title:s.isActive?"Pause":"Activate",children:s.isActive?e.jsx(O,{size:16}):e.jsx(T,{size:16})}),e.jsx("button",{onClick:()=>m(s.id),className:"p-2 hover:bg-red-50 rounded-lg text-red-500",children:e.jsx(D,{size:16})})]})]})},s.id)})})]}),c&&e.jsx(U,{onClose:()=>a(!1),onSave:s=>{const i=new FormData;i.append("intent","create"),i.append("name",s.name),i.append("trigger",s.trigger),i.append("triggerConfig",JSON.stringify(s.triggerConfig||{})),i.append("actions",JSON.stringify(s.actions||[])),i.append("isActive","true"),l(i,{method:"post"}),a(!1)}})]})});function U({onClose:u,onSave:o}){const[n,l]=d.useState(1),[c,a]=d.useState(""),[r,m]=d.useState(""),[s,i]=d.useState([]),x=t=>{i([...s,{type:t,config:{}}])},p=()=>{o({name:c,trigger:r,actions:s})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Create Automation"}),e.jsx("button",{onClick:u,children:e.jsx(P,{size:20,className:"text-zinc-400 hover:text-zinc-600"})})]}),e.jsxs("div",{className:"p-6",children:[n===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Automation Name"}),e.jsx("input",{type:"text",value:c,onChange:t=>a(t.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg",placeholder:"e.g., Welcome Series"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-2",children:"Trigger"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:y.map(t=>e.jsxs("button",{onClick:()=>m(t.id),className:`p-3 rounded-lg border text-left flex items-center gap-2 ${r===t.id?"border-purple-500 bg-purple-50":"border-zinc-200 hover:bg-zinc-50"}`,children:[e.jsx(t.icon,{size:16,className:r===t.id?"text-purple-600":"text-zinc-400"}),e.jsx("span",{className:"text-sm",children:t.label})]},t.id))})]})]}),n===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-2",children:"Actions"}),s.map((t,b)=>{const w=f.find(j=>j.id===t.type);return e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-zinc-50 rounded-lg",children:[e.jsxs("span",{className:"text-sm font-medium",children:[b+1,". ",w?.label]}),e.jsx("button",{onClick:()=>i(s.filter((j,C)=>C!==b)),className:"ml-auto text-red-500 text-xs",children:"Remove"})]},b)}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:f.map(t=>e.jsxs("button",{onClick:()=>x(t.id),className:"p-2 rounded-lg border border-dashed border-zinc-300 hover:border-purple-500 hover:bg-purple-50 flex items-center gap-2 text-sm",children:[e.jsx(N,{size:14})," ",t.label]},t.id))})]})]}),e.jsxs("div",{className:"p-4 border-t border-zinc-200 flex justify-between",children:[n>1&&e.jsx("button",{onClick:()=>l(n-1),className:"px-4 py-2 text-sm text-zinc-500",children:"Back"}),n<2?e.jsx("button",{onClick:()=>l(2),disabled:!c||!r,className:"ml-auto px-4 py-2 bg-zinc-900 text-white rounded-lg text-sm disabled:opacity-50",children:"Next"}):e.jsx("button",{onClick:p,disabled:s.length===0,className:"ml-auto px-4 py-2 bg-zinc-900 text-white rounded-lg text-sm disabled:opacity-50",children:"Create"})]})]})})}export{se as default};
