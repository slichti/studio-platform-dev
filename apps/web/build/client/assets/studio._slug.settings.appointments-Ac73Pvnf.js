import{w as P,u as A,c as F,L}from"./chunk-JZWAC4HX-Cg_gv2PJ.js";import{j as e}from"./vendor-puck-D_CB0wXL.js";import{a as b}from"./api-ChCisjdG.js";import{a as o}from"./vendor-sentry-DugYw-Ne.js";import{t as i}from"./index-CNiSO0Vl.js";import{C as M}from"./Dialogs-3wFUFLtR.js";import{A as O}from"./arrow-left-1bqtOZ-B.js";import{P as y}from"./plus-7j3qtkRM.js";import{S as $}from"./save-BsFOcTUD.js";import{C as I}from"./calendar-DJnC92HA.js";import{C as U}from"./clock-D0h4zxra.js";import{D as _}from"./dollar-sign-BvRwH14e.js";import{P as R}from"./pen-DxlJW1R3.js";import{T as q}from"./trash-2-vh4T49GQ.js";import"./Modal-D1QwNVP6.js";import"./createLucideIcon-BOpDDQ2B.js";const j=typeof window<"u"?window.ENV?.API_URL:"",ae=P(function(){const{services:S,slug:d,token:x}=A(),{roles:v=[]}=F()||{},C=v.includes("owner")||v.includes("admin"),[n,p]=o.useState(S),[r,N]=o.useState(null),[h,f]=o.useState(!1),[l,g]=o.useState(null),[z,m]=o.useState(!1),[t,a]=o.useState({title:"",description:"",durationMinutes:60,price:0,currency:"usd"}),u=()=>{a({title:"",description:"",durationMinutes:60,price:0,currency:"usd"}),N(null),f(!1)},k=async()=>{if(!t.title.trim()){i.error("Title is required");return}m(!0);try{const s=await b("/appointments/services",x,{method:"POST",headers:{"X-Tenant-Slug":d},body:JSON.stringify(t)},j);s.id?(p([...n,{...t,id:s.id,isActive:!0}]),i.success("Service created!"),u()):i.error(s.error||"Failed to create service")}catch(s){i.error("Error: "+s.message)}finally{m(!1)}},D=async()=>{if(!r||!t.title.trim()){i.error("Title is required");return}m(!0);try{const s=await b(`/appointments/services/${r}`,x,{method:"PUT",headers:{"X-Tenant-Slug":d},body:JSON.stringify(t)},j);s.success?(p(n.map(c=>c.id===r?{...c,...t}:c)),i.success("Service updated!"),u()):i.error(s.error||"Failed to update service")}catch(s){i.error("Error: "+s.message)}finally{m(!1)}},T=async()=>{if(l){try{const s=await b(`/appointments/services/${l.id}`,x,{method:"DELETE",headers:{"X-Tenant-Slug":d}},j);s.success?(p(n.filter(c=>c.id!==l.id)),i.success("Service deleted!")):i.error(s.error||"Failed to delete service")}catch(s){i.error("Error: "+s.message)}g(null)}},E=s=>{a({title:s.title,description:s.description||"",durationMinutes:s.durationMinutes,price:s.price,currency:s.currency}),N(s.id),f(!1)},w=()=>{u(),f(!0)};return C?e.jsxs("div",{className:"max-w-4xl mx-auto py-8 px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(L,{to:`/studio/${d}/appointments`,className:"p-2 hover:bg-zinc-100 rounded-full",children:e.jsx(O,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Appointment Services"}),e.jsx("p",{className:"text-zinc-500 text-sm",children:"Configure 1:1 bookable sessions for your studio"})]})]}),!h&&!r&&e.jsxs("button",{onClick:w,className:"inline-flex items-center gap-2 bg-zinc-900 text-white px-4 py-2 rounded-lg hover:bg-zinc-800 transition",children:[e.jsx(y,{size:16}),"Add Service"]})]}),(h||r)&&e.jsxs("div",{className:"bg-white border border-zinc-200 rounded-xl p-6 mb-6 shadow-sm",children:[e.jsx("h3",{className:"font-semibold text-lg mb-4",children:r?"Edit Service":"Create New Service"}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Service Name *"}),e.jsx("input",{type:"text",value:t.title,onChange:s=>a({...t,title:s.target.value}),placeholder:"e.g. Private Yoga Session",className:"w-full px-3 py-2 border border-zinc-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-zinc-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Description"}),e.jsx("textarea",{value:t.description,onChange:s=>a({...t,description:s.target.value}),placeholder:"What students can expect from this session...",rows:3,className:"w-full px-3 py-2 border border-zinc-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-zinc-900 resize-none"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Duration (minutes)"}),e.jsx("input",{type:"number",value:t.durationMinutes,onChange:s=>a({...t,durationMinutes:parseInt(s.target.value)||0}),min:15,step:15,className:"w-full px-3 py-2 border border-zinc-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-zinc-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Price"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"inline-flex items-center px-3 bg-zinc-100 border border-r-0 border-zinc-200 rounded-l-lg text-zinc-500",children:"$"}),e.jsx("input",{type:"number",value:t.price,onChange:s=>a({...t,price:parseInt(s.target.value)||0}),min:0,className:"w-full px-3 py-2 border border-zinc-200 rounded-r-lg focus:outline-none focus:ring-2 focus:ring-zinc-900"})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-zinc-100",children:[e.jsx("button",{onClick:u,className:"px-4 py-2 text-zinc-600 hover:bg-zinc-100 rounded-lg transition",children:"Cancel"}),e.jsx("button",{onClick:r?D:k,disabled:z,className:"inline-flex items-center gap-2 bg-zinc-900 text-white px-4 py-2 rounded-lg hover:bg-zinc-800 transition disabled:opacity-50",children:z?e.jsx("span",{className:"animate-pulse",children:"Saving..."}):e.jsxs(e.Fragment,{children:[e.jsx($,{size:16}),r?"Update Service":"Create Service"]})})]})]})]}),n.length===0&&!h&&e.jsxs("div",{className:"bg-zinc-50 border-2 border-dashed border-zinc-200 rounded-xl p-12 text-center",children:[e.jsx(I,{className:"h-16 w-16 text-zinc-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-zinc-700 mb-2",children:"No services yet"}),e.jsx("p",{className:"text-zinc-500 mb-6",children:"Create your first appointment service to allow students to book 1:1 sessions."}),e.jsxs("button",{onClick:w,className:"inline-flex items-center gap-2 bg-zinc-900 text-white px-5 py-2.5 rounded-lg hover:bg-zinc-800 transition",children:[e.jsx(y,{size:18}),"Create Your First Service"]})]}),n.length>0&&e.jsx("div",{className:"space-y-3",children:n.map(s=>e.jsx("div",{className:"bg-white border border-zinc-200 rounded-xl p-5 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.title}),s.description&&e.jsx("p",{className:"text-zinc-500 text-sm mt-1 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-zinc-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(U,{className:"h-4 w-4"}),s.durationMinutes," min"]}),e.jsxs("div",{className:"flex items-center gap-1 font-medium",children:[e.jsx(_,{className:"h-4 w-4"}),s.price===0?"Free":`${s.price}`]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>E(s),className:"p-2 text-zinc-400 hover:text-zinc-600 hover:bg-zinc-100 rounded-lg transition",title:"Edit",children:e.jsx(R,{size:18})}),e.jsx("button",{onClick:()=>g(s),className:"p-2 text-zinc-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition",title:"Delete",children:e.jsx(q,{size:18})})]})]})},s.id))}),e.jsx(M,{isOpen:!!l,onClose:()=>g(null),onConfirm:T,title:"Delete Service",message:`Are you sure you want to delete "${l?.title}"? This will deactivate the service and it will no longer be bookable.`,confirmText:"Delete",isDestructive:!0})]}):e.jsx("div",{className:"p-8 text-center",children:e.jsx("p",{className:"text-zinc-500",children:"You don't have permission to manage appointment services."})})});export{ae as default};
