import{w as G,f as J,u as M,h as _}from"./chunk-JMJ3UQ3L-Dw7tS_gO.js";import{j as e}from"./vendor-puck-By1A5E5K.js";import{a as o}from"./vendor-sentry-BD1MTpLq.js";import{a as d}from"./api-OnQO3erh.js";import{t as X}from"./index-C_1Jy3MY.js";import{C as K}from"./Dialogs-LpmU1ed2.js";import{I as Q}from"./image-BzEjuuKJ.js";import{U as A}from"./upload-BJQyUS3g.js";import{V as W}from"./video-BR-TS2td.js";import{C as Y}from"./circle-check-big-Cgvy_36a.js";import{T as Z}from"./trash-2-DU-4PZMS.js";import"./Modal-D5keykku.js";import"./createLucideIcon-DgXJrNmH.js";const he=G(function(){const{tenant:n}=J(),{assets:p}=M(),h=_(),[i,b]=o.useState(p),[m,f]=o.useState(null),[v,N]=o.useState(n.branding?.primaryColor||"#4f46e5"),[y,L]=o.useState(n.branding?.logoUrl||""),[O,ee]=o.useState(n.branding?.emailReplyTo||""),[F,te]=o.useState(n.branding?.emailFooterText||""),[w,I]=o.useState(n.branding?.hidePoweredBy||!1),[j,k]=o.useState(!1),[l,x]=o.useState(null),[C,r]=o.useState(null),[S,u]=o.useState(null),R=async t=>{t.preventDefault(),k(!0),r(null),u(null);try{const s=await window.Clerk?.session?.getToken();await d("/tenant/settings",s,{method:"PATCH",headers:{"X-Tenant-Slug":n.slug},body:JSON.stringify({branding:{primaryColor:v,logoUrl:y,emailReplyTo:O,emailFooterText:F,hidePoweredBy:w}})}),u("Branding saved successfully."),h.revalidate()}catch(s){r(s.message||"Failed to save branding.")}finally{k(!1)}},$=async t=>{x("logo"),r(null);try{const s=await window.Clerk?.session?.getToken(),a=new FormData;a.append("file",t),a.append("title",`Logo - ${t.name}`);const c=await d("/uploads/r2-image",s,{method:"POST",body:a});L(c.url),u("Logo uploaded. Don't forget to save settings.")}catch(s){console.error(s),r("Logo upload failed: "+s.message)}finally{x(null)}},T=async(t,s)=>{x(s),r(null);try{const a=await window.Clerk?.session?.getToken(),{uploadUrl:c,uid:z}=await d("/video-management/branding/upload-url",a,{method:"POST",body:JSON.stringify({type:s})}),P=new FormData;if(P.append("file",t),!(await fetch(c,{method:"POST",body:P})).ok)throw new Error("Upload to video server failed");await d("/video-management/branding",a,{method:"POST",body:JSON.stringify({type:s,title:t.name,cloudflareStreamId:z})});const q=await d("/video-management/branding",a);b(q),u(`Uploaded ${s} video successfully.`)}catch(a){console.error(a),r("Upload failed: "+a.message)}finally{x(null)}},U=async t=>{try{const s=await window.Clerk?.session?.getToken();await d(`/video-management/branding/${t}/activate`,s,{method:"PATCH"}),b(i.map(a=>{if(a.id===t)return{...a,active:!0};const c=i.find(z=>z.id===t);return c&&a.type===c.type&&a.id!==t?{...a,active:!1}:a}))}catch{r("Failed to activate asset")}},D=t=>{f(t)},E=async()=>{if(m)try{const t=await window.Clerk?.session?.getToken();await d(`/video-management/branding/${m}`,t,{method:"DELETE"}),b(i.filter(s=>s.id!==m)),f(null),X.success("Asset deleted successfully")}catch{r("Failed to delete asset")}},V=i.filter(t=>t.type==="intro"),H=i.filter(t=>t.type==="outro");return e.jsxs("div",{className:"max-w-4xl pb-10 space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-zinc-900 dark:text-zinc-100 mb-2",children:"Customize Branding"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400",children:"Manage your studio's look, feel, and video assets."})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6 shadow-sm",children:[C&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 p-3 rounded mb-4 text-sm",children:C}),S&&e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 p-3 rounded mb-4 text-sm",children:S}),e.jsx("h2",{className:"text-lg font-semibold text-zinc-900 dark:text-zinc-100 mb-6",children:"General Appearance"}),e.jsxs("form",{onSubmit:R,className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-2",children:"Studio Logo"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"h-24 w-24 bg-zinc-100 dark:bg-zinc-800 rounded-lg border border-zinc-200 dark:border-zinc-700 flex items-center justify-center overflow-hidden relative group",children:[y?e.jsx("img",{src:y,alt:"Studio Logo",className:"object-cover w-full h-full"}):e.jsx(Q,{className:"text-zinc-300",size:32}),e.jsxs("label",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center cursor-pointer transition-opacity text-white text-xs font-medium",children:["Change",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:t=>t.target.files?.[0]&&$(t.target.files[0]),disabled:l==="logo"})]})]}),e.jsxs("div",{className:"flex-1 text-sm text-zinc-500",children:[e.jsx("p",{children:"Upload a square image for best results. Used in emails and header."}),l==="logo"&&e.jsx("p",{className:"text-blue-600 animate-pulse mt-1",children:"Uploading..."})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-2",children:"Primary Brand Color"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"color",value:v,onChange:t=>N(t.target.value),className:"w-10 h-10 p-0 border-none rounded cursor-pointer bg-transparent"}),e.jsx("input",{type:"text",value:v,onChange:t=>N(t.target.value),className:"flex-1 bg-transparent text-zinc-900 dark:text-zinc-100 border border-zinc-200 dark:border-zinc-700 rounded-md px-3 py-2 text-sm font-mono focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"#000000"})]})]})]}),e.jsxs("div",{className:"border-t border-zinc-200 dark:border-zinc-800 pt-6",children:[e.jsx("h2",{className:"text-base font-semibold text-zinc-900 dark:text-zinc-100 mb-4",children:"Platform Branding"}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("input",{id:"hidePoweredBy",type:"checkbox",checked:w,onChange:t=>I(t.target.checked),disabled:n.tier?.toLowerCase()!=="scale",className:"h-4 w-4 mt-0.5 rounded border-zinc-300 text-blue-600 focus:ring-blue-500 disabled:opacity-50"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("label",{htmlFor:"hidePoweredBy",className:`font-medium ${n.tier?.toLowerCase()!=="scale"?"text-zinc-400 dark:text-zinc-500":"text-zinc-900 dark:text-zinc-100"}`,children:'Hide "Powered by StudioPlatform" badge'}),e.jsxs("p",{className:"text-zinc-500 dark:text-zinc-400 text-xs mt-0.5",children:["Remove the branding badge from your site footer.",n.tier?.toLowerCase()!=="scale"&&e.jsx("span",{className:"text-pink-600 dark:text-pink-400 ml-1 font-medium",children:"Requires Scale tier."})]})]})]})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",disabled:j,className:`bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 px-5 py-2.5 rounded-md font-medium text-sm hover:opacity-90 transition-opacity ${j?"opacity-70 cursor-not-allowed":""}`,children:j?"Saving...":"Save General Settings"})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-zinc-900 dark:text-zinc-100",children:"Video Branding"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400",children:"Intros and Outros to automatically stitch to your VOD uploads."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-zinc-900",children:"Intro Videos"}),e.jsxs("label",{className:"cursor-pointer bg-zinc-100 hover:bg-zinc-200 text-zinc-800 px-3 py-1.5 rounded-md text-xs font-medium transition flex items-center gap-2",children:[e.jsx(A,{size:14}),l==="intro"?"Uploading...":"Upload Intro",e.jsx("input",{type:"file",accept:"video/*",className:"hidden",onChange:t=>t.target.files?.[0]&&T(t.target.files[0],"intro"),disabled:!!l})]})]}),e.jsx(B,{assets:V,onActivate:U,onDelete:D,emptyMessage:"No intros uploaded. Upload a short video to play before your classes."})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-zinc-900",children:"Outro Videos"}),e.jsxs("label",{className:"cursor-pointer bg-zinc-100 hover:bg-zinc-200 text-zinc-800 px-3 py-1.5 rounded-md text-xs font-medium transition flex items-center gap-2",children:[e.jsx(A,{size:14}),l==="outro"?"Uploading...":"Upload Outro",e.jsx("input",{type:"file",accept:"video/*",className:"hidden",onChange:t=>t.target.files?.[0]&&T(t.target.files[0],"outro"),disabled:!!l})]})]}),e.jsx(B,{assets:H,onActivate:U,onDelete:D,emptyMessage:"No outros uploaded. Upload a short video to play after your classes."})]})]})]}),e.jsx(K,{isOpen:!!m,onClose:()=>f(null),onConfirm:E,title:"Delete Branding Asset",message:"Are you sure you want to delete this branding asset? This action cannot be undone.",confirmText:"Delete",isDestructive:!0})]})});function B({assets:g,onActivate:n,onDelete:p,emptyMessage:h}){return g.length===0?e.jsx("div",{className:"text-zinc-400 text-sm py-8 text-center bg-zinc-50 rounded-lg border border-dashed border-zinc-200 px-10",children:h}):e.jsx("div",{className:"space-y-3",children:g.map(i=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${i.active?"border-indigo-200 bg-indigo-50/50":"border-zinc-200 hover:bg-zinc-50"} transition`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-zinc-200 rounded flex items-center justify-center text-zinc-400",children:e.jsx(W,{size:14})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-zinc-900",children:i.title}),i.active&&e.jsxs("div",{className:"text-xs text-indigo-600 font-medium flex items-center gap-1",children:[e.jsx(Y,{size:10})," Active"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!i.active&&e.jsx("button",{onClick:()=>n(i.id),className:"text-xs text-zinc-500 hover:text-indigo-600 px-2 py-1 rounded hover:bg-indigo-50 transition",children:"Set Active"}),e.jsx("button",{onClick:()=>p(i.id),className:"p-1.5 text-zinc-400 hover:text-red-600 rounded transition",children:e.jsx(Z,{size:14})})]})]},i.id))})}export{he as default};
