import{w as k,g as z,f as S}from"./chunk-JMJ3UQ3L-DsmOvVYk.js";import{j as e}from"./vendor-puck-Ox9nZAW8.js";import{a as i}from"./vendor-sentry-JepEA2vj.js";import{a as d}from"./api-OnQO3erh.js";import{t as a}from"./index-Cb5OqxoU.js";import{C as u}from"./Dialogs-Atowov_t.js";import{L as v}from"./loader-circle-CRrLibi7.js";import{C}from"./credit-card-DxGxPhTX.js";import{S as T}from"./shield-xoR-gJzw.js";import{M as P}from"./mail-BspoxSMS.js";import{S as D}from"./send-ClowdSfz.js";import{M as f}from"./message-square-w1u1RI-5.js";import"./Modal-C2ODX5rl.js";import"./createLucideIcon-CZ3UnH4h.js";const J=k(function(){const{slug:r}=z(),{tenant:s}=S()||{},[x,h]=i.useState(null),[F,y]=i.useState({accountSid:"",authToken:"",fromNumber:""}),[E,w]=i.useState({apiKey:""}),[j,g]=i.useState(!1),[o,m]=i.useState(null),[l,p]=i.useState(null),c=async t=>{try{const n=await window.Clerk?.session?.getToken();await d(`/studios/${s.id}/integrations`,n,{method:"PUT",headers:{"X-Tenant-Slug":r||""},body:JSON.stringify(t)}),a.success("Settings saved successfully."),window.location.reload()}catch(n){a.error(n.message||"Failed to save")}};i.useEffect(()=>{b()},[r]);const b=async()=>{try{const t=window.Clerk?.session?.getToken?await window.Clerk.session.getToken():localStorage.getItem("token"),n=await d("/integrations/credentials",t,{headers:{"X-Tenant-Slug":r||""}});h(n),y({accountSid:n.twilio?.accountSid||"",authToken:"",fromNumber:n.twilio?.fromNumber||""}),w({apiKey:n.resend?.apiKey||""})}catch(t){console.error("Failed to load data",t)}};return s?e.jsxs("div",{className:"max-w-5xl pb-10",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-zinc-900 dark:text-zinc-100",children:"Integrations"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400",children:"Manage connections, payment providers, and developer tools."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"col-span-1 lg:col-span-2 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-zinc-900 dark:text-zinc-100 flex items-center gap-2",children:[e.jsx(C,{className:"h-5 w-5"})," Payment Processing"]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${s.paymentProvider==="connect"&&s.stripeAccountId?"bg-green-100 text-green-700":"bg-zinc-100 text-zinc-500"}`,children:s.paymentProvider==="connect"&&s.stripeAccountId?"Connected":s.paymentProvider==="custom"?"Custom Keys":"Not Configured"})]}),e.jsxs("div",{className:"mt-4 bg-blue-50 dark:bg-blue-900/10 border border-blue-100 dark:border-blue-800 rounded p-4",children:[e.jsxs("h4",{className:"flex items-center gap-2 text-sm font-semibold text-blue-900 dark:text-blue-100 mb-2",children:[e.jsx(T,{className:"h-4 w-4"})," Financial Privacy & Security"]}),e.jsxs("div",{className:"text-xs text-blue-800 dark:text-blue-200 space-y-2",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Your Money, Your Account:"})," You retain full legal ownership of your Stripe account and funds. We cannot access your bank account or withdraw funds without your permission."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Limited Visibility:"})," We only track transactions processed through this platform (e.g., class bookings). We do not access unrelated financial data from your Stripe account."]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Bank-Grade Security:"})," Sensitive financial data is stored securely by Stripe. We do not store credit card numbers or bank account details."]})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-zinc-900 dark:text-zinc-100 flex items-center gap-2",children:[e.jsx(P,{className:"h-4 w-4"})," Transactional Email (Resend)"]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${s.resendCredentials?.apiKey?"bg-green-100 text-green-700":"bg-zinc-100 text-zinc-500"}`,children:s.resendCredentials?.apiKey?"Configured":"Using Platform Default"})]}),e.jsx("p",{className:"text-xs text-zinc-500 mb-3",children:"Provide your own Resend API Key to send transactional emails from your domain."}),e.jsxs("form",{onSubmit:t=>{t.preventDefault(),c({resendApiKey:new FormData(t.currentTarget).get("resendApiKey")})},className:"flex gap-2",children:[e.jsx("input",{name:"resendApiKey",type:"password",placeholder:"re_123...",className:"flex-1 text-sm border-zinc-300 rounded px-3 py-2"}),e.jsx("button",{type:"submit",className:"text-xs bg-white border border-zinc-300 hover:bg-zinc-50 px-3 py-2 rounded font-medium",children:"Save Key"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-zinc-900 dark:text-zinc-100 flex items-center gap-2",children:[e.jsx(D,{className:"h-4 w-4"})," Marketing Automation (Flodesk)"]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${x?.flodesk?.configured?"bg-green-100 text-green-700":"bg-zinc-100 text-zinc-500"}`,children:x?.flodesk?.configured?"Configured":"Not Configured"})]}),e.jsx("p",{className:"text-xs text-zinc-500 mb-3",children:"Sync members and activity to Flodesk for email marketing."}),e.jsxs("form",{onSubmit:async t=>{t.preventDefault();try{const n=new FormData(t.currentTarget).get("flodeskApiKey"),N=await window.Clerk?.session?.getToken();await d("/integrations/credentials",N,{method:"PATCH",headers:{"X-Tenant-Slug":r||""},body:JSON.stringify({flodesk:{apiKey:n}})}),a.success("Flodesk settings saved."),b()}catch(n){console.error(n),a.error("Failed to save Flodesk settings: "+n.message)}},className:"flex gap-2",children:[e.jsx("input",{name:"flodeskApiKey",type:"password",placeholder:"Flodesk API Key",className:"flex-1 text-sm border-zinc-300 rounded px-3 py-2"}),e.jsx("button",{type:"submit",className:"text-xs bg-white border border-zinc-300 hover:bg-zinc-50 px-3 py-2 rounded font-medium",children:"Save Key"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-zinc-900 dark:text-zinc-100 flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4"})," SMS Service (Twilio)"]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${s.twilioCredentials?.accountSid?"bg-green-100 text-green-700":"bg-zinc-100 text-zinc-500"}`,children:s.twilioCredentials?.accountSid?"Configured":"Using Platform Default"})]}),e.jsx("p",{className:"text-xs text-zinc-500 mb-3",children:"Connect your Twilio account for custom SMS notifications."}),e.jsxs("form",{onSubmit:t=>{t.preventDefault();const n=new FormData(t.currentTarget);c({twilioAccountSid:n.get("twilioAccountSid"),twilioAuthToken:n.get("twilioAuthToken"),twilioFromNumber:n.get("twilioFromNumber")})},className:"space-y-3",children:[e.jsx("input",{name:"twilioAccountSid",placeholder:"Account SID",className:"w-full text-sm border-zinc-300 rounded px-3 py-2"}),e.jsx("input",{name:"twilioFromNumber",placeholder:"From Number (+1...)",className:"w-full text-sm border-zinc-300 rounded px-3 py-2"}),e.jsx("input",{name:"twilioAuthToken",type:"password",placeholder:"Auth Token",className:"w-full text-sm border-zinc-300 rounded px-3 py-2"}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",className:"text-xs bg-white border border-zinc-300 hover:bg-zinc-50 px-3 py-2 rounded font-medium",children:"Save Twilio"})})]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-5 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-sm font-semibold text-zinc-900 dark:text-zinc-100 flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4"})," Customer Support Chat"]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full font-medium ${s.settings?.chatEnabled!==!1?"bg-green-100 text-green-700":"bg-zinc-100 text-zinc-500"}`,children:s.settings?.chatEnabled!==!1?"Enabled":"Disabled"})]}),e.jsx("p",{className:"text-xs text-zinc-500 mb-3",children:"Allow students to chat with you directly from your website and portal."}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsx("button",{onClick:()=>{const t=s.settings?.chatEnabled!==!1;m(!t)},className:`px-3 py-2 text-xs font-medium rounded border ${s.settings?.chatEnabled!==!1?"bg-zinc-50 border-zinc-300 text-zinc-700":"bg-blue-600 border-blue-600 text-white hover:bg-blue-700"}`,children:s.settings?.chatEnabled!==!1?"Disable Chat":"Enable Chat"})})]})]}),e.jsx(u,{isOpen:j,onClose:()=>g(!1),onConfirm:async()=>{try{const t=window.Clerk?.session?.getToken?await window.Clerk.session.getToken():localStorage.getItem("token");await d(`/studios/${s.id}/integrations/google`,t,{method:"DELETE"}),a.success("Disconnected"),window.location.reload()}catch(t){console.error(t),a.error("Failed to disconnect")}finally{g(!1)}},title:"Disconnect Google Calendar",message:"Are you sure you want to disconnect Google Calendar? Classes will no longer sync.",isDestructive:!0,confirmText:"Disconnect"}),e.jsx(u,{isOpen:o!==null,onClose:()=>m(null),onConfirm:()=>{o!==null&&(c({chatEnabled:o}),m(null))},title:o?"Enable Chat Widget":"Disable Chat Widget",message:o?"Enable chat widget for your studio? This will verify connectivity to your configured support channels.":"Disable chat widget for your studio?",confirmText:o?"Enable":"Disable"}),e.jsx(u,{isOpen:!!l,onClose:()=>p(null),onConfirm:()=>{l&&(c({paymentProvider:l}),p(null))},title:"Switch Payment Provider",message:`Switch to ${l==="connect"?"Platform Managed":"Self Managed"} payments?`,confirmText:"Switch"})]}):e.jsx("div",{className:"p-8",children:e.jsx(v,{className:"animate-spin"})})});export{J as default};
