const f="http://localhost:8787",l="https://studio-platform-api.slichti.workers.dev",u=(()=>{const n="https://studio-platform-api.slichti.workers.dev";if(n.length>0)return n;if(typeof window<"u"){const o=window.location.hostname;if(!o.includes("localhost")&&!o.includes("127.0.0.1"))return l}return f})();async function w(n,o,r={},c){const d=c||u,i={};r.headers&&(r.headers instanceof Headers||Array.isArray(r.headers)?r.headers.forEach((t,e)=>i[e]=t):Object.entries(r.headers).forEach(([t,e])=>{e!=null&&(i[t]=String(e))}));const a=new Headers(i);if(o&&a.set("Authorization",`Bearer ${o}`),typeof window<"u"){const t=localStorage.getItem("impersonation_token");t&&a.set("Authorization",`Bearer ${t}`)}!a.has("Content-Type")&&!(r.body instanceof FormData)&&a.set("Content-Type","application/json"),a.has("x-request-id")||a.set("x-request-id",crypto.randomUUID());const s=await fetch(`${d}${n}`,{...r,headers:a});if(!s.ok){let t;try{t=await s.clone().json();const e=new Error(t.error||s.statusText);throw e.data=t,e.status=s.status,e}catch(e){if(e.data)throw e;const h=await s.text();throw new Error(h||s.statusText)}}return s.json()}export{u as A,w as a};
