import{p as f,q as b,V as v,A as j,W as N,a as n,j as e,J as m,Y as w,Z as z}from"./vendor-react-D59Q0YKK.js";import{a as S}from"./api-D1U4i9fn.js";import{t as k}from"./vendor-puck-RN2Ey-av.js";import{p as y}from"./puck-config-Cc0HIl1y.js";import"./vendor-charts-Dp-zC2wb.js";const D=f(function(){const{page:s,error:i}=b(),{getToken:p}=v(),r=j(),g=N(),[c,l]=n.useState(!1),[o,u]=n.useState(null),[d,h]=n.useState(s?.content||{root:{props:{}},content:[]}),x=async t=>{l(!0);try{const a=await p();await S(`/platform-pages/pages/${g.pageId}`,a,{method:"PUT",body:JSON.stringify({content:t})}),u(new Date)}catch(a){alert("Failed to save: "+a.message)}finally{l(!1)}};return i?e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg",children:["Error: ",i]}),e.jsxs("button",{onClick:()=>r("/admin/website"),className:"mt-4 text-blue-600 hover:underline flex items-center gap-2",children:[e.jsx(m,{size:16})," Back to Pages"]})]}):e.jsxs("div",{className:"h-screen flex flex-col",children:[e.jsxs("div",{className:"bg-white border-b border-zinc-200 px-4 py-3 flex items-center justify-between z-50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>r("/admin/website"),className:"flex items-center gap-2 text-zinc-600 hover:text-zinc-900",children:[e.jsx(m,{size:18}),e.jsx("span",{className:"text-sm",children:"Back"})]}),e.jsx("div",{className:"h-6 w-px bg-zinc-200"}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-medium text-zinc-900",children:s?.title}),e.jsxs("p",{className:"text-xs text-zinc-500",children:["/",s?.slug," â€¢ Platform Page"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[o&&e.jsxs("span",{className:"text-xs text-zinc-400",children:["Saved ",o.toLocaleTimeString()]}),e.jsxs("button",{onClick:()=>{const t=s?.slug==="home"?"/":`/${s?.slug}`;window.open(t,"_blank")},className:"flex items-center gap-2 px-3 py-1.5 text-sm text-zinc-600 hover:bg-zinc-100 rounded-lg",children:[e.jsx(w,{size:16}),"Preview"]}),e.jsxs("button",{onClick:()=>x(d),disabled:c,className:"flex items-center gap-2 px-4 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(z,{size:16}),c?"Saving...":"Save"]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(k,{config:y,data:d,onPublish:x,onChange:h})})]})});export{D as default};
