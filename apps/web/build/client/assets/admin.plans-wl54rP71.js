import{w as M}from"./chunk-JZWAC4HX-Cg_gv2PJ.js";import{j as e}from"./vendor-puck-D_CB0wXL.js";import{a as f}from"./api-ChCisjdG.js";import{a as o}from"./vendor-sentry-DugYw-Ne.js";import{t as u}from"./index-CNiSO0Vl.js";import{R as I}from"./refresh-cw-DnP96nUp.js";import{C as b}from"./check-BLCE7Q_n.js";import{X as v}from"./x-Bbpoc0N5.js";import{c as T}from"./createLucideIcon-BOpDDQ2B.js";import{P as $}from"./plus-7j3qtkRM.js";import{u as R}from"./chunk-OT5FTIRN-BVuv9f9K.js";import"./index-BNXeXtNe.js";import"./vendor-charts-BaZHU4KA.js";const U=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],B=T("pen-line",U),te=M(function(){const{getToken:p}=R(),[N,g]=o.useState([]),[w,z]=o.useState(!0);o.useEffect(()=>{async function t(){try{const s=await p(),r=await f("/admin/plans",s);Array.isArray(r)&&g(r)}catch(s){console.error(s),u.error("Failed to load plans")}finally{z(!1)}}t()},[p]);const S=async()=>{const t=await p();u.promise(f("/admin/plans/sync",t,{method:"POST"}),{loading:"Syncing with Stripe...",success:s=>(f("/admin/plans",t).then(r=>g(r)),`Synced ${s.synced||0} prices`),error:"Sync failed"})},k=async(t,s)=>{const r=await p();try{await f(`/admin/plans/${t}`,r,{method:"PUT",body:JSON.stringify(s)}),u.success("Plan updated"),g(m=>m.map(c=>c.id===t?{...c,...s}:c))}catch{u.error("Update failed")}},C={"Core Features":["Unlimited Students","Basic Financials & Reporting","Waiver Management","Visual Website Builder","Retail Point of Sale (POS)","Transactional Email Notifications","Class Packs & Drop-ins"],"Growth & Marketing":["Zoom Integration (Auto-Meeting)","Video on Demand (VOD)","Marketing Automations (Win-back, Welcome)","Inventory Tracking & Low Stock Alerts","SMS Notifications & Marketing","Recurring Memberships"],"Scale & Enterprise":["White Label Branding Options","API Access","Priority Support","Dedicated Account Manager","0% Platform Fees"],"Common Limits":["5 Instructors","15 Instructors","Unlimited Instructors","1 Location","3 Locations","Unlimited Locations","5GB Storage","50GB Storage","1TB Video Storage"]},P=({features:t,onChange:s})=>{const[r,m]=o.useState(""),[c,D]=o.useState(!1),j=i=>{const n=i.trim();n&&!t.includes(n)&&(s([...t,n]),m(""))},E=i=>{s(t.filter((n,d)=>d!==i))};return e.jsxs("div",{className:"space-y-3 min-w-[400px]",children:[e.jsxs("div",{className:"space-y-2",children:[t.map((i,n)=>e.jsx("div",{className:"flex gap-2 group",children:e.jsxs("div",{className:"flex-1 px-3 py-2 bg-white border border-zinc-200 rounded text-sm flex items-center justify-between shadow-sm",children:[e.jsx("span",{children:i}),e.jsx("button",{onClick:()=>E(n),className:"text-zinc-400 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(v,{size:14})})]})},n)),t.length===0&&e.jsx("div",{className:"text-zinc-400 text-sm italic py-2",children:"No features added yet."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:r,onChange:i=>m(i.target.value),onKeyDown:i=>i.key==="Enter"&&(i.preventDefault(),j(r)),className:"flex-1 border border-zinc-300 rounded px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none",placeholder:"Type functionality or limit..."}),e.jsx("button",{onClick:()=>j(r),className:"bg-zinc-900 hover:bg-zinc-800 text-white px-3 py-2 rounded transition-colors",children:e.jsx($,{size:16})})]}),e.jsxs("div",{className:"pt-2 border-t border-zinc-100",children:[e.jsx("button",{onClick:()=>D(!c),className:"text-xs font-medium text-blue-600 hover:text-blue-800 flex items-center gap-1",children:c?"Hide Feature Library":"+ Add from Feature Library"}),c&&e.jsx("div",{className:"mt-3 grid grid-cols-1 gap-4 p-4 bg-zinc-50 border border-zinc-200 rounded-lg shadow-inner max-h-[300px] overflow-y-auto",children:Object.entries(C).map(([i,n])=>e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold text-[10px] uppercase tracking-wider text-zinc-500 mb-2",children:i}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(d=>{const h=t.includes(d);return e.jsxs("button",{onClick:()=>!h&&j(d),disabled:h,className:`text-xs px-2 py-1.5 rounded border transition-all text-left
                                                        ${h?"bg-blue-50 border-blue-200 text-blue-700 cursor-default opactiy-70":"bg-white border-zinc-200 hover:border-blue-300 hover:shadow-sm text-zinc-700 hover:translate-y-[-1px]"}`,children:[h&&e.jsx(b,{size:10,className:"inline mr-1"}),d]},d)})})]},i))})]})]})},[l,y]=o.useState(null),[a,x]=o.useState({}),A=t=>{y(t.id);const s=Array.isArray(t.features)?t.features:[];x({name:t.name,trialDays:t.trialDays,features:s,active:t.active})},F=async()=>{try{await k(l,{name:a.name,trialDays:parseInt(a.trialDays),features:a.features,active:a.active}),y(null)}catch{u.error("Update failed")}},L=({active:t})=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t?"Active":"Inactive"});return w?e.jsx("div",{className:"p-10",children:"Loading plans..."}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-zinc-900",children:"Platform Plans"}),e.jsx("p",{className:"text-zinc-500",children:"Manage SaaS tiers, pricing, and features."})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:S,className:"flex items-center gap-2 px-4 py-2 bg-white border border-zinc-200 rounded-lg hover:bg-zinc-50 text-zinc-700 font-medium transition-colors",children:[e.jsx(I,{size:16})," Sync Stripe"]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-zinc-200 overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-zinc-200",children:[e.jsx("thead",{className:"bg-zinc-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Plan"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Pricing (Stripe)"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Trial"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider w-1/3",children:"Features"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-zinc-200",children:N.map(t=>e.jsxs("tr",{className:"hover:bg-zinc-50 transition-colors align-top",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l===t.id?e.jsx("input",{value:a.name,onChange:s=>x({...a,name:s.target.value}),className:"border rounded px-2 py-1 w-full font-medium"}):e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-zinc-900",children:t.name}),e.jsx("div",{className:"text-xs text-zinc-500 font-mono",children:t.slug})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-zinc-900",children:["Monthly: ",t.monthlyPriceCents?`$${t.monthlyPriceCents/100}/mo`:"Free"]}),e.jsxs("div",{className:"text-xs text-zinc-500",children:["Annual: ",t.annualPriceCents?`$${t.annualPriceCents/100}/yr`:"Free"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-zinc-500",children:l===t.id?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("input",{type:"number",value:a.trialDays,onChange:s=>x({...a,trialDays:s.target.value}),className:"border rounded px-2 py-1 w-16"})," days"]}):`${t.trialDays} Days`}),e.jsx("td",{className:"px-6 py-4 text-sm text-zinc-500",children:l===t.id?e.jsx(P,{features:a.features,onChange:s=>x({...a,features:s})}):e.jsxs("div",{className:"max-h-40 overflow-y-auto space-y-1",children:[(t.features||[]).map((s,r)=>e.jsxs("div",{className:"flex items-start gap-2 text-xs",children:[e.jsx(b,{size:12,className:"mt-0.5 text-green-500 flex-shrink-0"}),e.jsx("span",{children:s})]},r)),(t.features||[]).length===0&&e.jsx("span",{className:"text-zinc-400 italic",children:"No features configured"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:l===t.id?e.jsxs("select",{value:a.active?"true":"false",onChange:s=>x({...a,active:s.target.value==="true"}),className:"border rounded px-2 py-1 text-sm",children:[e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]}):e.jsx(L,{active:t.active})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:l===t.id?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:F,className:"text-green-600 hover:text-green-900 bg-green-50 p-1 rounded",children:e.jsx(b,{size:18})}),e.jsx("button",{onClick:()=>y(null),className:"text-zinc-400 hover:text-zinc-600 bg-zinc-50 p-1 rounded",children:e.jsx(v,{size:18})})]}):e.jsx("button",{onClick:()=>A(t),className:"text-blue-600 hover:text-blue-900",children:e.jsx(B,{size:18})})})]},t.id))})]})})]})});export{te as default};
