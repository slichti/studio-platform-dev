import{w as v,v as y,r as n}from"./chunk-JMJ3UQ3L-DmAaMJDT.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{a as p}from"./api-piI5qlNr.js";import{M as z}from"./mail-Cx4vZ2DG.js";import{c as M}from"./createLucideIcon-DBCK0g1u.js";const w=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],b=M("send",w),L=v(function(){const{campaigns:h,token:i,slug:r}=y(),[c,f]=n.useState(h),[o,d]=n.useState(""),[m,x]=n.useState(""),[u,g]=n.useState(!1),[a,l]=n.useState({ageMin:0,ageMax:100,preset:"all"});async function j(s){s.preventDefault(),g(!0);try{const t=await p("/marketing",i,{method:"POST",headers:{"X-Tenant-Slug":r},body:JSON.stringify({subject:o,content:m,filters:a.preset==="all"?{}:{ageMin:a.ageMin,ageMax:a.ageMax}})});if(t.error)alert(t.error);else{alert(`Campaign Sent to ${t.count} recipients!`),d(""),x("");const N=await p("/marketing",i,{headers:{"X-Tenant-Slug":r}});f(N.campaigns||[])}}catch(t){alert("Failed to send: "+t.message)}finally{g(!1)}}return e.jsxs("div",{className:"max-w-5xl mx-auto py-8 px-4 grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-zinc-900",children:"Marketing"}),e.jsx("p",{className:"text-zinc-500",children:"Broadcast updates to your community."})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-6 shadow-sm",children:[e.jsxs("h2",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[e.jsx(z,{className:"h-5 w-5 text-blue-600"}),"New Broadcast"]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Subject Line"}),e.jsx("input",{type:"text",value:o,onChange:s=>d(s.target.value),className:"w-full border border-zinc-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"e.g. November Newsletter",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Message Content"}),e.jsx("textarea",{value:m,onChange:s=>x(s.target.value),className:"w-full border border-zinc-300 rounded-lg px-3 py-2 h-48 focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"Write your message...",required:!0}),e.jsx("p",{className:"text-xs text-zinc-400 mt-1",children:"Plain text only for MVP."})]}),e.jsxs("div",{className:"bg-zinc-50 border border-zinc-200 p-4 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-semibold text-zinc-800 mb-3",children:"Target Audience"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:[{label:"All Students",value:"all",min:0,max:100},{label:"Youth (<18)",value:"youth",min:0,max:17},{label:"Adults (18-64)",value:"adults",min:18,max:64},{label:"Seniors (65+)",value:"seniors",min:65,max:100},{label:"Custom",value:"custom",min:a.ageMin,max:a.ageMax}].map(s=>e.jsx("button",{type:"button",onClick:()=>l({...a,preset:s.value,ageMin:s.min,ageMax:s.max}),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-colors ${a.preset===s.value?"bg-blue-600 text-white":"bg-white border border-zinc-300 text-zinc-600 hover:bg-zinc-50"}`,children:s.label},s.value))}),a.preset==="custom"&&e.jsxs("div",{className:"flex items-center gap-4 animate-in fade-in slide-in-from-top-1",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-[10px] uppercase font-bold text-zinc-500 mb-1",children:"Min Age"}),e.jsx("input",{type:"number",value:a.ageMin,onChange:s=>l({...a,ageMin:Number(s.target.value)}),className:"w-full border border-zinc-300 rounded px-2 py-1 text-sm outline-none"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-[10px] uppercase font-bold text-zinc-500 mb-1",children:"Max Age"}),e.jsx("input",{type:"number",value:a.ageMax,onChange:s=>l({...a,ageMax:Number(s.target.value)}),className:"w-full border border-zinc-300 rounded px-2 py-1 text-sm outline-none"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:u,className:"bg-blue-600 text-white px-6 py-2 rounded-lg font-medium hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2",children:u?"Sending...":e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-4 w-4"}),"Send Broadcast"]})})})]})]})]}),e.jsxs("div",{className:"bg-zinc-50 rounded-lg border border-zinc-200 p-6 h-fit",children:[e.jsx("h3",{className:"font-semibold text-zinc-700 mb-4",children:"Recent Campaigns"}),e.jsxs("div",{className:"space-y-4",children:[c.length===0&&e.jsx("p",{className:"text-sm text-zinc-500 italic",children:"No campaigns yet."}),c.map(s=>e.jsxs("div",{className:"bg-white border border-zinc-200 rounded p-3 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:"font-medium text-sm text-zinc-900 line-clamp-1",children:s.subject}),e.jsx("span",{className:`text-[10px] uppercase font-bold px-1.5 py-0.5 rounded ${s.status==="sent"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-600"}`,children:s.status})]}),e.jsx("p",{className:"text-xs text-zinc-500 mb-2",children:new Date(s.sentAt).toLocaleDateString()}),e.jsxs("div",{className:"flex gap-3 text-xs text-zinc-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(b,{className:"h-3 w-3"}),s.stats?.sent||0," Sent"]}),s.filters&&e.jsxs("span",{className:"flex items-center gap-1 bg-zinc-100 px-1.5 rounded",children:[s.filters.ageMin,"-",s.filters.ageMax," yrs"]})]})]},s.id))]})]})]})});export{L as default};
