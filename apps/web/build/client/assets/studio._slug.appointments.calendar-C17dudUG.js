import{w as k,d as I,u as A,e as T,r as a}from"./chunk-JMJ3UQ3L-CD8Ifjmd.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{C as P}from"./calendar-BfXsLpf7.js";import{P as $}from"./plus-DJqcHEwy.js";import{C as O}from"./chevron-left-lSkgbz84.js";import{C as M}from"./chevron-right-CiNyuouW.js";import{X as D}from"./x-Dafybrll.js";import{C as L}from"./clock-BUrLlwIc.js";import{U as _}from"./user-Bv9KGq-F.js";import"./createLucideIcon-B1hucShu.js";const Q=k(function(){const{appointments:p,services:c,instructors:d,weekStart:m}=I(),[j,v]=A(),b=T(),[f,h]=a.useState(null),[N,x]=a.useState(null),[z,u]=a.useState(!1),o=a.useMemo(()=>{const t=new Date(m),n=t.getDay(),i=new Date(t);return i.setDate(t.getDate()-(n===0?6:n-1)),Array.from({length:7},(l,y)=>{const C=new Date(i);return C.setDate(i.getDate()+y),C.toISOString().split("T")[0]})},[m]),g=t=>{const n=new Date(o[0]);n.setDate(n.getDate()+t*7),v({week:n.toISOString().split("T")[0]})},w=Array.from({length:12},(t,n)=>n+7),S=(t,n)=>p.filter(i=>{const l=new Date(i.startTime);return l.toISOString().split("T")[0]===t&&l.getHours()===n}),s={pending:"bg-yellow-100 border-yellow-300 text-yellow-800",confirmed:"bg-blue-100 border-blue-300 text-blue-800",completed:"bg-green-100 border-green-300 text-green-800",cancelled:"bg-zinc-100 border-zinc-300 text-zinc-500"};return e.jsxs("div",{className:"flex flex-col h-full bg-zinc-50",children:[e.jsxs("header",{className:"bg-white border-b border-zinc-200 px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-zinc-900 rounded-lg text-white",children:e.jsx(P,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-zinc-900",children:"Appointments"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Private sessions calendar"})]})]}),e.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-zinc-900 text-white rounded-lg text-sm font-medium hover:bg-zinc-800 flex items-center gap-2",children:[e.jsx($,{size:16})," New Appointment"]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx("button",{onClick:()=>g(-1),className:"p-2 hover:bg-zinc-100 rounded-lg",children:e.jsx(O,{size:20})}),e.jsxs("span",{className:"font-medium text-zinc-900",children:[new Date(o[0]).toLocaleDateString(void 0,{month:"short",day:"numeric"})," - ",new Date(o[6]).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})]}),e.jsx("button",{onClick:()=>g(1),className:"p-2 hover:bg-zinc-100 rounded-lg",children:e.jsx(M,{size:20})})]})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"min-w-[800px]",children:[e.jsxs("div",{className:"grid grid-cols-8 border-b border-zinc-200 bg-white sticky top-0 z-10",children:[e.jsx("div",{className:"p-3 text-xs font-medium text-zinc-500",children:"Time"}),o.map(t=>{const n=new Date(t),i=t===new Date().toISOString().split("T")[0];return e.jsxs("div",{className:`p-3 text-center border-l border-zinc-200 ${i?"bg-zinc-900 text-white":""}`,children:[e.jsx("div",{className:"text-xs font-medium",children:n.toLocaleDateString(void 0,{weekday:"short"})}),e.jsx("div",{className:`text-lg font-bold ${i?"":"text-zinc-900"}`,children:n.getDate()})]},t)})]}),w.map(t=>e.jsxs("div",{className:"grid grid-cols-8 border-b border-zinc-100",children:[e.jsxs("div",{className:"p-2 text-xs text-zinc-500 text-right pr-4",children:[t%12||12,":00 ",t<12?"AM":"PM"]}),o.map(n=>{const i=S(n,t);return e.jsx("div",{className:"border-l border-zinc-100 min-h-[60px] p-1 hover:bg-zinc-50 cursor-pointer transition",onClick:()=>h({date:n,hour:t}),children:i.map(l=>e.jsxs("div",{onClick:y=>{y.stopPropagation(),x(l)},className:`p-1.5 rounded text-xs mb-1 border cursor-pointer ${s[l.status]||s.pending}`,children:[e.jsx("div",{className:"font-medium truncate",children:l.service?.title||"Session"}),e.jsx("div",{className:"truncate opacity-75",children:l.member?.user?.profile?.firstName||"Client"})]},l.id))},`${n}-${t}`)})]},t))]})}),(z||f)&&e.jsx(E,{services:c,instructors:d,defaultSlot:f,onClose:()=>{u(!1),h(null)},onSave:t=>{const n=new FormData;n.append("intent","create"),Object.entries(t).forEach(([i,l])=>n.append(i,String(l))),b(n,{method:"post"}),u(!1),h(null)}}),N&&e.jsx(q,{appointment:N,onClose:()=>x(null),onUpdateStatus:(t,n)=>{b({intent:"update-status",id:t,status:n},{method:"post"}),x(null)}})]})});function E({services:r,instructors:p,defaultSlot:c,onClose:d,onSave:m}){const[j,v]=a.useState(""),[b,f]=a.useState(""),[h,N]=a.useState(""),[x,z]=a.useState(c?.date||new Date().toISOString().split("T")[0]),[u,o]=a.useState(c?`${String(c.hour).padStart(2,"0")}:00`:"09:00"),[g,w]=a.useState(""),S=s=>{s.preventDefault();const t=new Date(`${x}T${u}`).toISOString();m({serviceId:j,instructorId:b,memberId:h,startTime:t,notes:g})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"New Appointment"}),e.jsx("button",{onClick:d,children:e.jsx(D,{size:20,className:"text-zinc-400 hover:text-zinc-600"})})]}),e.jsxs("form",{onSubmit:S,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Service *"}),e.jsxs("select",{required:!0,value:j,onChange:s=>v(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg",children:[e.jsx("option",{value:"",children:"Select service..."}),r.map(s=>e.jsxs("option",{value:s.id,children:[s.title," (",s.durationMinutes," min)"]},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Instructor *"}),e.jsxs("select",{required:!0,value:b,onChange:s=>f(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg",children:[e.jsx("option",{value:"",children:"Select instructor..."}),p.map(s=>e.jsxs("option",{value:s.id,children:[s.user?.profile?.firstName," ",s.user?.profile?.lastName]},s.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Date"}),e.jsx("input",{type:"date",value:x,onChange:s=>z(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Time"}),e.jsx("input",{type:"time",value:u,onChange:s=>o(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:g,onChange:s=>w(s.target.value),rows:2,className:"w-full px-3 py-2 border border-zinc-200 rounded-lg resize-none"})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:d,className:"px-4 py-2 text-sm font-medium text-zinc-500",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium bg-zinc-900 text-white rounded-lg hover:bg-zinc-800",children:"Create"})]})]})]})})}function q({appointment:r,onClose:p,onUpdateStatus:c}){const d=m=>new Date(m).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"});return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:r.service?.title||"Appointment"}),e.jsx("button",{onClick:p,children:e.jsx(D,{size:20,className:"text-zinc-400 hover:text-zinc-600"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx(L,{size:16,className:"text-zinc-400"}),d(r.startTime)]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx(_,{size:16,className:"text-zinc-400"}),r.member?.user?.profile?.firstName," ",r.member?.user?.profile?.lastName]}),r.notes&&e.jsx("p",{className:"text-sm text-zinc-600 bg-zinc-50 p-3 rounded-lg",children:r.notes}),e.jsxs("div",{className:"pt-4 border-t space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-zinc-500 uppercase",children:"Update Status"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>c(r.id,"confirmed"),className:"flex-1 py-2 text-xs font-medium bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200",children:"Confirm"}),e.jsx("button",{onClick:()=>c(r.id,"completed"),className:"flex-1 py-2 text-xs font-medium bg-green-100 text-green-700 rounded-lg hover:bg-green-200",children:"Complete"}),e.jsx("button",{onClick:()=>c(r.id,"cancelled"),className:"flex-1 py-2 text-xs font-medium bg-red-100 text-red-700 rounded-lg hover:bg-red-200",children:"Cancel"})]})]})]})]})})}export{Q as default};
