import{w as U,d as _,b as F,r as n,F as d}from"./chunk-JMJ3UQ3L-Dzyq37y6.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{U as T}from"./user-vYjUSa57.js";import{M as y}from"./mail-Ci_j9QIs.js";import{E as $}from"./ellipsis-BdMDr6ds.js";import{P as z}from"./plus-ZxFZXXXb.js";import{F as q}from"./file-text-ZURmrqfr.js";import{C as V}from"./check-BicwsbQf.js";import{P as L}from"./pencil-BBZH-oKk.js";import{T as O}from"./trash-2-Dsh4Q_ZX.js";import{f as a}from"./format-gSCb7gQz.js";import"./createLucideIcon-CNXPjsb6.js";const te=U(function(){const{member:t,notes:p,availablePacks:w}=_(),j=F(),i=t.user.profile||{},[l,k]=n.useState("overview"),[S,c]=n.useState(null),[f,N]=n.useState(!1),[C,m]=n.useState(!1),[g,o]=n.useState(!1),[M,x]=n.useState(!1),[P,h]=n.useState(!1),u=[i.firstName,i.lastName].filter(Boolean).join(" ")||t.user.email,A=t.roles.map(s=>s.role).join(", ")||"Student",D=(t.purchasedPacks||[]).reduce((s,r)=>s+r.remainingCredits,0),E=t.bookings.filter(s=>{if(s.status!=="confirmed")return!1;const r=new Date(s.class?.startTime||s.createdAt)<new Date,I=!s.checkedInAt;return r&&I}).length,b=t.memberships.some(s=>s.status==="active"),v=b?"Active":"Inactive";return e.jsxs("div",{className:"max-w-5xl mx-auto pb-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"h-20 w-20 bg-zinc-100 rounded-full flex items-center justify-center border border-zinc-200 overflow-hidden relative",children:i.portraitUrl?e.jsx("img",{src:i.portraitUrl,alt:u,className:"h-full w-full object-cover"}):e.jsx(T,{className:"h-8 w-8 text-zinc-400"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h1",{className:"text-3xl font-bold text-zinc-900",children:u}),e.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium border ${b?"bg-green-100 text-green-800 border-green-200":"bg-zinc-100 text-zinc-600 border-zinc-200"}`,children:v})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-1 text-zinc-500 text-sm",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx("span",{children:t.user.email}),e.jsx("span",{className:"mx-1",children:"•"}),e.jsx("span",{className:"capitalize px-2 py-0.5 bg-zinc-100 rounded-full text-xs font-medium border border-zinc-200",children:A})]}),e.jsxs("div",{className:"text-xs text-zinc-400 mt-1",children:["Joined ",a(new Date(t.joinedAt),"MMM d, yyyy")]})]})]}),e.jsxs("div",{className:"flex gap-2 relative",children:[e.jsx("button",{onClick:()=>m(!0),className:"px-3 py-2 border border-zinc-300 rounded-md text-sm font-medium hover:bg-zinc-50",children:"Edit Profile"}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>o(!g),className:"px-3 py-2 bg-zinc-900 text-white rounded-md text-sm font-medium hover:bg-zinc-800 flex items-center gap-2",children:["Actions",e.jsx($,{className:"h-4 w-4"})]}),g&&e.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-white border border-zinc-200 rounded-md shadow-lg z-10 py-1",children:[e.jsx("button",{onClick:()=>{o(!1),x(!0)},className:"block w-full text-left px-4 py-2 text-sm text-zinc-700 hover:bg-zinc-50",children:"Send Email"}),e.jsx("div",{className:"border-t border-zinc-100 my-1"}),e.jsx("button",{onClick:()=>{o(!1),h(!0)},className:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:"Deactivate Member"})]})]})]})]}),M&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-lg shadow-xl",children:[e.jsxs("h2",{className:"text-lg font-bold mb-4",children:["Send Email to ",u]}),e.jsxs(d,{method:"post",onSubmit:()=>x(!1),children:[e.jsx("input",{type:"hidden",name:"intent",value:"send_email"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Subject"}),e.jsx("input",{type:"text",name:"subject",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md text-sm",placeholder:"e.g. Important Update regarding your membership"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Message"}),e.jsx("textarea",{name:"body",rows:6,required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md text-sm",placeholder:"Write your message here..."})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 text-sm border border-zinc-300 rounded-md hover:bg-zinc-50",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4"}),"Send"]})]})]})]})}),P&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md shadow-xl",children:[e.jsx("h2",{className:"text-lg font-bold text-red-600 mb-2",children:"Deactivate Member?"}),e.jsx("p",{className:"text-sm text-zinc-600 mb-6",children:"This will prevent the member from booking classes or accessing studio content. Their history will be preserved. You can reactivate them later."}),e.jsxs(d,{method:"post",onSubmit:()=>h(!1),children:[e.jsx("input",{type:"hidden",name:"intent",value:"update_status"}),e.jsx("input",{type:"hidden",name:"status",value:"inactive"}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 text-sm border border-zinc-300 rounded-md hover:bg-zinc-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm bg-red-600 text-white rounded-md hover:bg-red-700",children:"Deactivate"})]})]})]})}),C&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md shadow-xl",children:[e.jsx("h2",{className:"text-lg font-bold mb-4",children:"Edit Profile"}),e.jsxs(d,{method:"post",onSubmit:()=>m(!1),children:[e.jsx("input",{type:"hidden",name:"intent",value:"update_profile"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"First Name"}),e.jsx("input",{type:"text",name:"firstName",defaultValue:i.firstName,className:"w-full px-3 py-2 border border-zinc-300 rounded-md text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Last Name"}),e.jsx("input",{type:"text",name:"lastName",defaultValue:i.lastName,className:"w-full px-3 py-2 border border-zinc-300 rounded-md text-sm"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",name:"phone",defaultValue:i.phone,className:"w-full px-3 py-2 border border-zinc-300 rounded-md text-sm"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>m(!1),className:"px-4 py-2 text-sm border border-zinc-300 rounded-md hover:bg-zinc-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm bg-zinc-900 text-white rounded-md hover:bg-zinc-800",children:"Save Changes"})]})]})]})}),e.jsx("div",{className:"flex border-b border-zinc-200 mb-6",children:[{id:"overview",label:"Overview"},{id:"memberships",label:"Memberships & Credits"},{id:"attendance",label:"Attendance"},{id:"documents",label:"Documents"},{id:"notes",label:"Staff Notes"}].map(s=>e.jsx("button",{onClick:()=>k(s.id),className:`px-4 py-2 text-sm font-medium border-b-2 text-zinc-600 hover:text-zinc-900 ${l===s.id?"border-blue-600 text-blue-600":"border-transparent"}`,children:s.label},s.id))}),e.jsxs("div",{className:"min-h-[400px]",children:[l==="overview"&&e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsx("div",{className:"col-span-2 space-y-6",children:e.jsxs("div",{className:"bg-white border border-zinc-200 rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Quick Stats"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"p-4 bg-zinc-50 rounded border border-zinc-100",children:[e.jsx("div",{className:"text-2xl font-bold text-zinc-900",children:t.bookings.length}),e.jsx("div",{className:"text-xs text-zinc-500 uppercase tracking-wide mt-1",children:"Classes Taken"})]}),e.jsxs("div",{className:"p-4 bg-zinc-50 rounded border border-zinc-100",children:[e.jsx("div",{className:"text-2xl font-bold text-zinc-900",children:D}),e.jsx("div",{className:"text-xs text-zinc-500 uppercase tracking-wide mt-1",children:"Available Credits"})]}),e.jsxs("div",{className:"p-4 bg-zinc-50 rounded border border-zinc-100",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:E}),e.jsx("div",{className:"text-xs text-zinc-500 uppercase tracking-wide mt-1",children:"No Shows"})]}),e.jsxs("div",{className:"p-4 bg-zinc-50 rounded border border-zinc-100",children:[e.jsx("div",{className:`text-2xl font-bold ${b?"text-green-600":"text-zinc-400"}`,children:v}),e.jsx("div",{className:"text-xs text-zinc-500 uppercase tracking-wide mt-1",children:"Membership Status"})]})]})]})}),e.jsx("div",{children:e.jsxs("div",{className:"bg-white border border-zinc-200 rounded-lg p-6 shadow-sm",children:[e.jsx("h3",{className:"font-semibold text-sm mb-4 uppercase text-zinc-500 tracking-wider",children:"Contact Info"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-zinc-400",children:"Email"}),e.jsx("div",{className:"text-zinc-800",children:t.user.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-zinc-400",children:"Phone"}),e.jsx("div",{className:"text-zinc-800",children:i.phone||"Not provided"})]})]})]})})]}),l==="memberships"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs("button",{onClick:()=>N(!f),className:"flex items-center gap-2 px-3 py-2 bg-white border border-zinc-300 rounded-md text-sm font-medium hover:bg-zinc-50",children:[e.jsx(z,{className:"h-4 w-4"}),"Assign Pack"]}),e.jsxs("button",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-zinc-300 rounded-md text-sm font-medium hover:bg-zinc-50",children:[e.jsx(z,{className:"h-4 w-4"}),"Add Plan"]})]}),f&&e.jsxs("div",{className:"bg-zinc-50 border border-zinc-200 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"font-semibold text-sm mb-3",children:"Assign Class Pack (Internal / POS)"}),e.jsxs(d,{method:"post",onSubmit:()=>N(!1),className:"flex gap-4 items-end",children:[e.jsx("input",{type:"hidden",name:"intent",value:"assign_pack"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-500 mb-1",children:"Select Pack"}),e.jsx("select",{name:"packId",className:"w-full text-sm border-zinc-300 rounded-md",children:(w||[]).map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.credits," credits) - $",(s.price/100).toFixed(2)]},s.id))})]}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md text-sm hover:bg-blue-700",children:"Assign & Charge"})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-zinc-900 mb-3",children:"Active Memberships"}),t.memberships&&t.memberships.length>0?e.jsx("div",{className:"space-y-3",children:t.memberships.map(s=>e.jsxs("div",{className:"bg-white border border-zinc-200 rounded-lg p-4 shadow-sm flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-zinc-900",children:s.plan?.name||"Unknown Plan"}),e.jsxs("div",{className:"text-sm text-zinc-500 mt-1",children:["Status: ",e.jsx("span",{className:"capitalize font-medium text-zinc-700",children:s.status}),e.jsx("span",{className:"mx-2",children:"•"}),"Started ",a(new Date(s.startDate),"MMM d, yyyy")]})]}),e.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium border ${s.status==="active"?"bg-green-50 text-green-700 border-green-200":"bg-zinc-100 text-zinc-600 border-zinc-200"}`,children:s.status.toUpperCase()})]},s.id))}):e.jsx("div",{className:"text-sm text-zinc-500 italic",children:"No active memberships."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-zinc-900 mb-3",children:"Class Packs & Credits"}),t.purchasedPacks&&t.purchasedPacks.length>0?e.jsx("div",{className:"space-y-3",children:t.purchasedPacks.map(s=>e.jsxs("div",{className:"bg-white border border-zinc-200 rounded-lg p-4 shadow-sm flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-zinc-900",children:s.definition?.name||"Unknown Pack"}),e.jsxs("div",{className:"text-sm text-zinc-500 mt-1 flex items-center gap-3",children:[e.jsxs("span",{children:["Purchased ",a(new Date,"MMM d, yyyy")]})," ",s.expiresAt&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{className:new Date(s.expiresAt)<new Date?"text-red-600":"",children:["Expires ",a(new Date(s.expiresAt),"MMM d, yyyy")]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-zinc-900",children:[s.remainingCredits," / ",s.initialCredits]}),e.jsx("div",{className:"text-xs text-zinc-500 uppercase",children:"Credits Left"})]})]},s.id))}):e.jsx("div",{className:"text-sm text-zinc-500 italic",children:"No packs purchased."})]})]}),l==="attendance"&&e.jsx("div",{className:"bg-white border border-zinc-200 rounded-lg overflow-hidden shadow-sm",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-zinc-50 border-b border-zinc-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-medium text-zinc-500",children:"Date"}),e.jsx("th",{className:"px-4 py-3 font-medium text-zinc-500",children:"Class"}),e.jsx("th",{className:"px-4 py-3 font-medium text-zinc-500",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-100",children:t.bookings.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-4 py-8 text-center text-zinc-400",children:"No attendance history"})}):t.bookings.map(s=>e.jsxs("tr",{className:"hover:bg-zinc-50",children:[e.jsx("td",{className:"px-4 py-3 text-zinc-600",children:a(new Date(s.createdAt),"MMM d, yyyy h:mm a")}),e.jsx("td",{className:"px-4 py-3 text-zinc-900 font-medium",children:s.class?.title||"Unknown Class"}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium capitalize
                                                    ${s.status==="confirmed"?"bg-green-100 text-green-800":s.status==="cancelled"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})})]},s.id))})]})}),l==="documents"&&e.jsx("div",{className:"bg-white border border-zinc-200 rounded-lg overflow-hidden shadow-sm",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-zinc-50 border-b border-zinc-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-medium text-zinc-500",children:"Document"}),e.jsx("th",{className:"px-4 py-3 font-medium text-zinc-500",children:"Signed Date"}),e.jsx("th",{className:"px-4 py-3 font-medium text-zinc-500",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-100",children:t.waiverSignatures?.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:3,className:"px-4 py-8 text-center text-zinc-400",children:"No signed documents"})}):t.waiverSignatures?.map(s=>e.jsxs("tr",{className:"hover:bg-zinc-50",children:[e.jsxs("td",{className:"px-4 py-3 text-zinc-900 font-medium flex items-center gap-2",children:[e.jsx(q,{size:16,className:"text-zinc-400"}),s.template?.title||"Waiver"]}),e.jsx("td",{className:"px-4 py-3 text-zinc-600",children:a(new Date(s.signedAt),"MMM d, yyyy h:mm a")}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(V,{size:12}),"Signed"]})})]},s.id))})]})}),l==="notes"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsx("div",{children:e.jsxs("div",{className:"bg-zinc-50 border border-zinc-200 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-sm mb-3",children:"Add Note"}),e.jsxs(d,{method:"post",children:[e.jsx("input",{type:"hidden",name:"intent",value:"add_note"}),e.jsx("textarea",{name:"note",rows:4,className:"w-full border border-zinc-300 rounded p-3 text-sm focus:ring-2 focus:ring-blue-500 outline-none mb-3 bg-white",placeholder:"Enter confidential notes about this student...",required:!0}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:j.state==="submitting",className:"px-4 py-2 bg-blue-600 text-white rounded text-sm font-medium hover:bg-blue-700 disabled:opacity-50",children:j.state==="submitting"?"Saving...":"Save Note"})})]})]})}),e.jsx("div",{className:"space-y-4",children:p.length===0?e.jsx("div",{className:"text-center text-zinc-400 py-10 italic",children:"No notes added yet."}):p.map(s=>e.jsx("div",{className:"bg-white border border-zinc-200 rounded-lg p-4 shadow-sm relative group",children:S===s.id?e.jsxs(d,{method:"post",onSubmit:()=>c(null),children:[e.jsx("input",{type:"hidden",name:"intent",value:"edit_note"}),e.jsx("input",{type:"hidden",name:"noteId",value:s.id}),e.jsx("textarea",{name:"note",defaultValue:s.note,rows:3,className:"w-full border border-zinc-300 rounded p-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none mb-2",required:!0,autoFocus:!0}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{type:"button",onClick:()=>c(null),className:"px-3 py-1 text-xs border border-zinc-300 rounded hover:bg-zinc-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-3 py-1 text-xs bg-blue-600 text-white rounded hover:bg-blue-700",children:"Save"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-zinc-800 whitespace-pre-wrap pr-8",children:s.note}),e.jsxs("div",{className:"absolute top-2 right-2 flex items-center gap-1 opacity-100 sm:opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>c(s.id),className:"p-1.5 text-zinc-400 hover:text-blue-600 hover:bg-zinc-50 rounded",title:"Edit",children:e.jsx(L,{className:"h-3.5 w-3.5"})}),e.jsxs(d,{method:"post",onSubmit:r=>{confirm("Are you sure you want to delete this note?")||r.preventDefault()},children:[e.jsx("input",{type:"hidden",name:"intent",value:"delete_note"}),e.jsx("input",{type:"hidden",name:"noteId",value:s.id}),e.jsx("button",{type:"submit",className:"p-1.5 text-zinc-400 hover:text-red-600 hover:bg-zinc-50 rounded",title:"Delete",children:e.jsx(O,{className:"h-3.5 w-3.5"})})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs text-zinc-400 border-t border-zinc-50 pt-2",children:[e.jsxs("span",{children:["Add by ",s.author?.user?.profile?.firstName||s.author?.user?.email||"Unknown Staff"]}),e.jsx("span",{children:a(new Date(s.createdAt),"MMM d, yyyy")})]})]})},s.id))})]})]})]})});export{te as default};
