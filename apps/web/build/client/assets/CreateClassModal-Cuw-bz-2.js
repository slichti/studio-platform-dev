const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BQcEtK79.js","assets/tslib.es6-B_Z_Z_Y2.js"])))=>i.map(i=>d[i]);
import{j as e}from"./jsx-runtime-u17CrQMm.js";import{e as N,r as g}from"./chunk-JMJ3UQ3L-Dzyq37y6.js";import{M as E}from"./Modal-Ccs7c619.js";import{a as z}from"./api-piI5qlNr.js";import{u as C}from"./chunk-OT5FTIRN-VRdL-y8m.js";const w="modulepreload",k=function(d){return"/"+d},v={},S=function(l,o,f){let u=Promise.resolve();if(o&&o.length>0){let b=function(s){return Promise.all(s.map(a=>Promise.resolve(a).then(t=>({status:"fulfilled",value:t}),t=>({status:"rejected",reason:t}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),i=c?.nonce||c?.getAttribute("nonce");u=b(o.map(s=>{if(s=k(s),s in v)return;v[s]=!0;const a=s.endsWith(".css"),t=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${t}`))return;const n=document.createElement("link");if(n.rel=a?"stylesheet":w,a||(n.as="script"),n.crossOrigin="",n.href=s,i&&n.setAttribute("nonce",i),document.head.appendChild(n),a)return new Promise((p,r)=>{n.addEventListener("load",p),n.addEventListener("error",()=>r(new Error(`Unable to preload CSS for ${s}`)))})}))}function m(c){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=c,window.dispatchEvent(i),!i.defaultPrevented)throw c}return u.then(c=>{for(const i of c||[])i.status==="rejected"&&m(i.reason);return l().catch(m)})};function q({isOpen:d,onClose:l,onSuccess:o,locations:f=[],instructors:u=[]}){const{getToken:m}=C(),{slug:c}=N(),[i,b]=g.useState(!1),[s,a]=g.useState(""),[t,n]=g.useState({name:"",description:"",instructorId:"",locationId:"",startTime:"",durationMinutes:60,capacity:20,price:0,isRecurring:!1,recurrencePattern:"weekly",recurrenceEndDate:"",createZoom:!1,minEnrollment:1,autoCancelThreshold:2,autoCancelEnabled:!1}),p=async r=>{r.preventDefault(),b(!0),a("");try{const h=await m();let j;if(t.isRecurring){const{RRule:R}=await S(async()=>{const{RRule:y}=await import("./index-BQcEtK79.js");return{RRule:y}},__vite__mapDeps([0,1]));j=t.recurrencePattern==="weekly"?"FREQ=WEEKLY":"FREQ=DAILY"}const x=await z("/classes",h,{method:"POST",headers:{"X-Tenant-Slug":c},body:JSON.stringify({title:t.name,description:t.description,instructorId:t.instructorId,locationId:t.locationId||void 0,startTime:new Date(t.startTime).toISOString(),durationMinutes:Number(t.durationMinutes),capacity:Number(t.capacity),price:Number(t.price),createZoomMeeting:t.createZoom,isRecurring:t.isRecurring,recurrenceRule:j,recurrenceEnd:t.recurrenceEndDate?new Date(t.recurrenceEndDate).toISOString():void 0,minStudents:Number(t.minEnrollment),autoCancelThreshold:Number(t.autoCancelThreshold),autoCancelEnabled:t.autoCancelEnabled})});x.error?a(x.error):(o(x.class||x),l(),n({name:"",description:"",instructorId:"",locationId:"",startTime:"",durationMinutes:60,capacity:20,price:0,isRecurring:!1,recurrencePattern:"weekly",recurrenceEndDate:"",createZoom:!1,minEnrollment:1,autoCancelThreshold:2,autoCancelEnabled:!1}))}catch(h){a(h.message||"Failed to create class")}finally{b(!1)}};return e.jsx(E,{isOpen:d,onClose:l,title:"Schedule Class",children:e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[s&&e.jsx("div",{className:"p-3 bg-red-50 text-red-600 rounded text-sm",children:s}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Class Name"}),e.jsx("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:t.name,onChange:r=>n({...t,name:r.target.value}),placeholder:"e.g. Morning Vinyasa"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Instructor"}),e.jsxs("select",{required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none bg-white",value:t.instructorId,onChange:r=>n({...t,instructorId:r.target.value}),children:[e.jsx("option",{value:"",children:"Select Instructor"}),u.map(r=>e.jsxs("option",{value:r.id,children:[r.user?.profile?.firstName," ",r.user?.profile?.lastName]},r.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Location"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none bg-white",value:t.locationId,onChange:r=>n({...t,locationId:r.target.value}),children:[e.jsx("option",{value:"",children:"Select Location (Optional)"}),f.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-zinc-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.createZoom,onChange:r=>n({...t,createZoom:r.target.checked}),className:"rounded border-zinc-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{children:"Enable Zoom (Virtual Access)"})]}),t.createZoom&&e.jsx("p",{className:"text-xs text-zinc-500 ml-6 mt-1",children:"A Zoom meeting will be created automatically."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Start Time"}),e.jsx("input",{type:"datetime-local",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:t.startTime,onChange:r=>n({...t,startTime:r.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Duration (min)"}),e.jsx("input",{type:"number",required:!0,min:"15",className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:t.durationMinutes,onChange:r=>n({...t,durationMinutes:Number(r.target.value)})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Capacity"}),e.jsx("input",{type:"number",required:!0,min:"1",className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:t.capacity,onChange:r=>n({...t,capacity:Number(r.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Price ($)"}),e.jsx("input",{type:"number",required:!0,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:t.price,onChange:r=>n({...t,price:Number(r.target.value)})})]})]}),e.jsxs("div",{className:"bg-zinc-50 border border-zinc-200 p-4 rounded-lg space-y-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-zinc-900 border-b border-zinc-200 pb-2",children:"Enrollment Policies"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-700 mb-1",children:"Min. Enrollment to Run"}),e.jsx("input",{type:"number",min:"1",className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none text-sm",value:t.minEnrollment,onChange:r=>n({...t,minEnrollment:Number(r.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-700 mb-1",children:"Auto-Cancel Cutoff (hrs)"}),e.jsx("input",{type:"number",min:"1",className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none text-sm",value:t.autoCancelThreshold,onChange:r=>n({...t,autoCancelThreshold:Number(r.target.value)}),placeholder:"Hours before start"})]})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-zinc-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.autoCancelEnabled,onChange:r=>n({...t,autoCancelEnabled:r.target.checked}),className:"rounded border-zinc-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{children:"Enable automatic cancellation if minimum is not met"})]})]}),e.jsxs("div",{className:"border-t border-zinc-200 pt-4 mt-2",children:[e.jsxs("label",{className:"flex items-center gap-2 text-sm text-zinc-700 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:t.isRecurring,onChange:r=>n({...t,isRecurring:r.target.checked}),className:"rounded border-zinc-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{children:"Repeat this class"})]}),t.isRecurring&&e.jsx("div",{className:"mt-3 p-3 bg-zinc-50 rounded border border-zinc-200 space-y-3",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600 mb-1",children:"Frequency"}),e.jsxs("select",{className:"w-full px-2 py-1.5 text-sm border border-zinc-300 rounded focus:ring-blue-500 outline-none",value:t.recurrencePattern,onChange:r=>n({...t,recurrencePattern:r.target.value}),children:[e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"daily",children:"Daily"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600 mb-1",children:"End Date"}),e.jsx("input",{type:"date",required:t.isRecurring,className:"w-full px-2 py-1.5 text-sm border border-zinc-300 rounded focus:ring-blue-500 outline-none",value:t.recurrenceEndDate,onChange:r=>n({...t,recurrenceEndDate:r.target.value}),min:t.startTime?new Date(t.startTime).toISOString().split("T")[0]:void 0})]})]})})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[e.jsx("button",{type:"button",onClick:l,className:"px-4 py-2 text-sm font-medium text-zinc-700 bg-white border border-zinc-300 rounded-md hover:bg-zinc-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:i,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50",children:i?"Scheduling...":"Schedule Class"})]})]})})}export{q as C};
