import{w as I,c as A,b as L,L as R}from"./chunk-JZWAC4HX-Cg_gv2PJ.js";import{j as e}from"./vendor-puck-D_CB0wXL.js";import{a as c}from"./vendor-sentry-DugYw-Ne.js";import{a as z}from"./api-ChCisjdG.js";import{t as f}from"./index-CNiSO0Vl.js";import{A as w}from"./arrow-left-1bqtOZ-B.js";import{S as C}from"./sparkles-peh2Myyc.js";import{A as B}from"./arrow-right-NuY2qCvM.js";import{T as P}from"./tag-DcOzSPg8.js";import{L as W}from"./loader-circle-DYdrNEzV.js";import{C as V}from"./check-BLCE7Q_n.js";import"./createLucideIcon-BOpDDQ2B.js";const ee=I(function(){const{tenant:l,token:d}=A(),g=L(),[o,x]=c.useState(!1),[u,j]=c.useState("config"),[m,$]=c.useState(25),[n,y]=c.useState(["pack_10","membership_unlimited"]),[_,M]=c.useState(new Set);c.useEffect(()=>{async function s(){try{const t=await z("/commerce/products",d);t.products&&M(new Set(t.products.map(i=>i.name.toLowerCase())))}catch(t){console.error("Failed to load existing products",t)}}s()},[d]);const[h,k]=c.useState([]),b=[{id:"pack_3",type:"pack",name:"3 Class Pack",quantity:3,discount:0},{id:"pack_5",type:"pack",name:"5 Class Pack",quantity:5,discount:.05},{id:"pack_10",type:"pack",name:"10 Class Pack",quantity:10,discount:.1},{id:"pack_20",type:"pack",name:"20 Class Pack",quantity:20,discount:.15},{id:"membership_2x",type:"membership",name:"2x / Week Membership",interval:"monthly",multiplier:8,discount:.15},{id:"membership_3x",type:"membership",name:"3x / Week Membership",interval:"monthly",multiplier:12,discount:.2},{id:"membership_unlimited",type:"membership",name:"Unlimited Monthly",interval:"monthly",multiplier:15,discount:.3},{id:"membership_unlimited_annual",type:"membership",name:"Unlimited Annual",interval:"annual",multiplier:180,discount:.4}],q=c.useMemo(()=>b.filter(s=>n.includes(s.id)).map(s=>{let t=0;if(s.type==="pack"){const i=m*s.quantity;t=Math.round(i*(1-s.discount))}else{const i=m*s.multiplier;t=Math.round(i*(1-s.discount))}return{...s,id:s.id,calculatedPrice:t}}),[m,n]),v=s=>{n.includes(s)?y(n.filter(t=>t!==s)):y([...n,s])},T=()=>{k(q.map(s=>({...s,finalPrice:s.calculatedPrice,finalName:s.name}))),j("review")},E=async()=>{x(!0);try{const s=h.filter(r=>!_.has(r.finalName.toLowerCase()));if(s.length===0){f.info("All selected items already exist!"),g(`/studio/${l.slug}/commerce/packs`);return}const t=s.map(r=>({type:r.type,name:r.finalName,price:Math.round(Number(r.finalPrice)*100),credits:r.type==="pack"?r.quantity:void 0,interval:r.type==="membership"?r.interval:void 0})),i=await z("/commerce/products/bulk",d,{method:"POST",body:JSON.stringify({items:t})});if(i.error)throw new Error(i.error);const p=h.length-s.length;f.success(`Created ${i.results?.length||0} pricing options! ${p>0?`(${p} skipped)`:""}`),g(`/studio/${l.slug}/commerce/packs`)}catch(s){f.error(s.message||"Failed to create products")}finally{x(!1)}},N=(s,t,i)=>{const p=[...h];p[s]={...p[s],[t]:i},k(p)};return e.jsxs("div",{className:"max-w-4xl mx-auto py-8",children:[e.jsxs("div",{className:"mb-8 flex items-center gap-4",children:[e.jsx(R,{to:`/studio/${l.slug}/commerce/packs`,className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-full transition",children:e.jsx(w,{size:20})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center gap-2",children:[e.jsx(C,{className:"text-indigo-500"})," Pricing Wizard"]}),e.jsx("p",{className:"text-zinc-500",children:"Auto-generate standard pricing options based on your drop-in rate."})]})]}),u==="config"?e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Base Drop-in Price ($)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-500",children:"$"}),e.jsx("input",{type:"number",value:m,onChange:s=>$(Number(s.target.value)),className:"w-full pl-8 pr-4 py-2 rounded-lg border border-zinc-200 dark:border-zinc-800 bg-zinc-50 dark:bg-zinc-950 font-mono text-lg"})]}),e.jsx("p",{className:"text-xs text-zinc-500 mt-2",children:"We use this to calculate bulk discounts automatically."})]}),e.jsxs("div",{className:"bg-indigo-50 dark:bg-indigo-900/20 p-4 rounded-xl border border-indigo-100 dark:border-indigo-800/50",children:[e.jsx("h3",{className:"font-semibold text-indigo-900 dark:text-indigo-200 mb-2 text-sm",children:"Summary"}),e.jsxs("p",{className:"text-sm text-indigo-700 dark:text-indigo-300 mb-4",children:["You selected ",e.jsx("strong",{children:n.length})," items."]}),e.jsxs("button",{onClick:T,disabled:n.length===0,className:"w-full py-3 bg-indigo-600 text-white rounded-lg font-bold hover:bg-indigo-700 transition disabled:opacity-50 flex items-center justify-center gap-2",children:["Review & Edit ",e.jsx(B,{size:16})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-4 text-zinc-900 dark:text-zinc-100 flex items-center gap-2",children:[e.jsx(P,{size:16})," Class Packs"]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:b.filter(s=>s.type==="pack").map(s=>e.jsx(S,{template:s,selected:n.includes(s.id),basePrice:m,onToggle:()=>v(s.id)},s.id))})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-semibold mb-4 text-zinc-900 dark:text-zinc-100 flex items-center gap-2",children:[e.jsx(P,{size:16})," Memberships"]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:b.filter(s=>s.type==="membership").map(s=>e.jsx(S,{template:s,selected:n.includes(s.id),basePrice:m,onToggle:()=>v(s.id)},s.id))})]})]})]}):e.jsxs("div",{className:"max-w-3xl mx-auto",children:[e.jsxs("button",{onClick:()=>j("config"),className:"mb-6 flex items-center text-sm text-zinc-500 hover:text-zinc-900",children:[e.jsx(w,{size:16,className:"mr-1"})," Back to Config"]}),e.jsx("h2",{className:"text-xl font-bold mb-6",children:"Review & Edit Prices"}),e.jsx("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl overflow-hidden mb-8",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-zinc-50 dark:bg-zinc-950 border-b border-zinc-200 dark:border-zinc-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Item Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Details"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Price ($)"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-200 dark:divide-zinc-800",children:h.map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4",children:e.jsx("input",{type:"text",value:s.finalName,onChange:i=>N(t,"finalName",i.target.value),className:"w-full bg-transparent border-b border-transparent focus:border-indigo-500 focus:outline-none px-0 py-1"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-zinc-500",children:s.type==="pack"?`${s.quantity} Credits`:`Billed ${s.interval}`}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-end",children:[e.jsx("span",{className:"text-zinc-400 mr-2",children:"$"}),e.jsx("input",{type:"number",value:s.finalPrice,onChange:i=>N(t,"finalPrice",i.target.value),className:"w-24 text-right bg-zinc-50 dark:bg-zinc-800 border-none rounded px-2 py-1 font-mono focus:ring-1 focus:ring-indigo-500"})]})})]},s.id))})]})}),e.jsx("div",{className:"flex justify-end gap-4",children:e.jsxs("button",{onClick:E,disabled:o,className:"px-6 py-3 bg-indigo-600 text-white rounded-lg font-bold hover:bg-indigo-700 transition disabled:opacity-50 flex items-center justify-center gap-2 shadow-lg hover:shadow-xl translate-y-0 hover:-translate-y-0.5",children:[o?e.jsx(W,{className:"animate-spin"}):e.jsx(C,{size:16}),"Create ",h.length," Products"]})})]})]})});function S({template:a,selected:l,basePrice:d,onToggle:g}){let o;if(a.type==="pack"){const u=d*a.quantity;o=Math.round(u*(1-a.discount))}else{const u=d*(a.multiplier||1);o=Math.round(u*(1-a.discount))}const x=Math.round(a.discount*100);return e.jsxs("div",{onClick:g,className:`cursor-pointer relative p-4 rounded-xl border-2 transition-all ${l?"border-indigo-600 bg-indigo-50 dark:bg-indigo-900/10":"border-zinc-200 dark:border-zinc-800 hover:border-zinc-300 dark:hover:border-zinc-700 bg-white dark:bg-zinc-900"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-semibold text-sm",children:a.name}),l&&e.jsx("div",{className:"bg-indigo-600 text-white rounded-full p-0.5",children:e.jsx(V,{size:12})})]}),e.jsxs("div",{className:"text-2xl font-bold font-mono",children:["$",o]}),x>0&&e.jsxs("div",{className:"text-xs text-emerald-600 dark:text-emerald-400 font-medium mt-1",children:["Save ",x,"% vs Drop-in"]}),e.jsx("div",{className:"text-xs text-zinc-400 mt-2",children:a.type==="pack"?`${a.quantity} credits`:`Billed ${a.interval}`})]})}export{ee as default};
