import{w as k,u as z,c as f,e as N,L as y,F as x}from"./chunk-JZWAC4HX-Cg_gv2PJ.js";import{j as e}from"./vendor-puck-D_CB0wXL.js";import{a as m}from"./vendor-sentry-DugYw-Ne.js";import{S}from"./SignaturePad-TOWN7XHe.js";const F=k(function(){const{data:d,error:l}=z(),{me:b,roles:g}=f(),u=g.includes("owner"),o=N().state==="submitting",[i,h]=m.useState(null);if(l)return e.jsxs("div",{className:"p-8 text-red-600",children:["Error: ",l]});if(u){const t=d?.templates||[];return e.jsxs("div",{className:"max-w-4xl mx-auto py-8 px-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-zinc-900 dark:text-zinc-100",children:"Waivers & Forms"}),e.jsx(y,{to:"new",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm font-medium flex items-center gap-2",children:"+ Create Waiver"})]}),e.jsx("div",{className:"space-y-4",children:t.length===0?e.jsxs("div",{className:"p-12 text-center text-zinc-500 dark:text-zinc-400 bg-zinc-50 dark:bg-zinc-900 rounded-lg border border-dashed border-zinc-300 dark:border-zinc-700",children:[e.jsx("p",{className:"mb-2 font-medium",children:"No waiver templates yet"}),e.jsx("p",{className:"text-sm",children:"Create a liability waiver for your members to sign."})]}):t.map(r=>e.jsxs("div",{className:"p-6 rounded-lg shadow-sm bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h3",{className:"font-bold text-lg text-zinc-900 dark:text-zinc-100",children:r.title}),e.jsxs(x,{method:"post",children:[e.jsx("input",{type:"hidden",name:"intent",value:"toggle_active"}),e.jsx("input",{type:"hidden",name:"templateId",value:r.id}),e.jsx("input",{type:"hidden",name:"active",value:(!r.active).toString()}),e.jsx("button",{type:"submit",className:`text-xs px-2 py-1 rounded border font-medium transition-colors ${r.active?"bg-green-100 text-green-800 border-green-200 hover:bg-green-200 dark:bg-green-900/30 dark:text-green-400 dark:border-green-800":"bg-zinc-100 text-zinc-800 border-zinc-200 hover:bg-zinc-200 dark:bg-zinc-800 dark:text-zinc-400 dark:border-zinc-700"}`,children:r.active?"Active":"Inactive"})]})]}),e.jsx("div",{className:"text-sm line-clamp-3 mb-1 whitespace-pre-wrap text-zinc-600 dark:text-zinc-400 font-mono bg-zinc-50 dark:bg-zinc-950 p-3 rounded border border-zinc-100 dark:border-zinc-800/50",children:r.content})]},r.id))})]})}const{waiver:n,required:p,signed:v,signatureDate:C,family:s,signedMemberIds:c}=d||{},[a,j]=m.useState(null);if(!p||!n)return e.jsxs("div",{className:"max-w-md mx-auto py-12 px-4 text-center",children:[e.jsx("div",{className:"mb-4 inline-flex items-center justify-center w-12 h-12 rounded-full bg-green-100 text-green-600 dark:bg-green-900/30 dark:text-green-400",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),e.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]})}),e.jsx("h2",{className:"text-xl font-bold text-zinc-900 dark:text-zinc-100 mb-2",children:"Good to go!"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400",children:"You have no pending waivers to sign."})]});const w=c?.includes(a||b?.id);return e.jsxs("div",{className:"max-w-2xl mx-auto py-8 px-4",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-zinc-900 dark:text-zinc-100",children:n.title}),e.jsx("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6 shadow-sm mb-6 max-h-[60vh] overflow-y-auto",children:e.jsx("div",{className:"prose dark:prose-invert text-zinc-700 dark:text-zinc-300 whitespace-pre-wrap font-serif text-sm leading-relaxed",children:n.content})}),s&&s.length>0&&e.jsxs("div",{className:"mb-6 bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800/50 rounded-lg p-4",children:[e.jsx("label",{className:"block text-sm font-medium text-blue-800 dark:text-blue-300 mb-2",children:"Who are you signing for?"}),e.jsxs("select",{className:"w-full bg-white dark:bg-zinc-800 border-zinc-200 dark:border-zinc-700 rounded-md text-sm px-3 py-2",value:a||"",onChange:t=>j(t.target.value||null),children:[e.jsxs("option",{value:"",children:["Myself ",v?"✅":""]}),s.map(t=>e.jsxs("option",{value:t.memberId,children:[t.firstName," ",t.lastName," ",c?.includes(t.memberId)?"✅":""]},t.memberId))]})]}),w?e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-900/50 text-green-800 dark:text-green-300 p-6 rounded-lg flex flex-col items-center justify-center gap-2 text-center",children:[e.jsx("div",{className:"text-2xl",children:"✅"}),e.jsx("div",{className:"font-bold",children:"Waiver Signed"}),e.jsx("div",{className:"text-sm opacity-80",children:"This member has successfully signed the waiver."})]}):e.jsxs("div",{className:"bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6",children:[e.jsx("h3",{className:"font-bold mb-4 text-zinc-900 dark:text-white",children:"Sign Waiver"}),e.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400 mb-4",children:"Please draw your signature below to accept this agreement."}),e.jsx("div",{className:"mb-6 bg-white dark:bg-zinc-950 rounded border border-zinc-200 dark:border-zinc-800 overflow-hidden",children:e.jsx(S,{onChange:t=>h(t),width:600,height:200})}),i&&e.jsxs("p",{className:"text-xs text-green-600 dark:text-green-400 mb-4 flex items-center gap-1 font-medium",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"20 6 9 17 4 12"})}),"Signature captured"]}),e.jsxs(x,{method:"post",children:[e.jsx("input",{type:"hidden",name:"intent",value:"sign"}),e.jsx("input",{type:"hidden",name:"templateId",value:n.id}),e.jsx("input",{type:"hidden",name:"signatureData",value:i||""}),e.jsx("input",{type:"hidden",name:"onBehalfOfMemberId",value:a||""}),e.jsxs("div",{className:"flex items-start gap-3 mb-6",children:[e.jsx("input",{type:"checkbox",required:!0,id:"agree",className:"mt-1 w-4 h-4 rounded border-zinc-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:"agree",className:"text-sm text-zinc-700 dark:text-zinc-300 leading-snug",children:"I have read and agree to the terms of this waiver. By drawing my signature above and checking this box, I electronically sign this document."})]}),e.jsx("button",{type:"submit",disabled:!i||o,className:"w-full py-3 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 shadow-sm transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:o?"Signing...":"Sign Waiver"})]})]})]})});export{F as default};
