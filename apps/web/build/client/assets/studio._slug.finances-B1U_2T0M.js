import{w as j,I as g,r as c}from"./chunk-JMJ3UQ3L-DmAaMJDT.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{a as l}from"./api-piI5qlNr.js";import{u as f}from"./chunk-OT5FTIRN-DtMOiK0s.js";import"./index-B-TQESlZ.js";const F=j(function(){const{tenant:n,member:k,roles:h}=g(),a=h.includes("owner");if(!a)return e.jsx("div",{className:"p-8 text-center text-zinc-500 dark:text-zinc-400",children:"You do not have permission to view this page."});const b=()=>{const s="https://studio-platform-api.slichti.workers.dev";window.location.href=`${s}/studios/stripe/connect?tenantId=${n.id}`},{getToken:x}=f(),[i,u]=c.useState(null),[m,p]=c.useState([]),[r,z]=c.useState(null);return c.useEffect(()=>{if(!n.stripeAccountId||!a)return;(async()=>{const d=await x(),o="https://studio-platform-api.slichti.workers.dev";l(`${o}/commerce/stats`,d).then(t=>{t&&u(t)}),l(`${o}/commerce/transactions`,d).then(t=>{t&&t.transactions&&p(t.transactions)}),l(`${o}/commerce/balance`,d).then(t=>{t&&!t.error&&z(t)})})()},[n.id,a,x]),e.jsxs("div",{className:"max-w-4xl text-zinc-900 dark:text-zinc-100",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Finances"}),n.stripeAccountId?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg border border-green-200 dark:border-green-800 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-100 dark:bg-green-800 flex items-center justify-center text-green-600 dark:text-green-300",children:"âœ“"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-green-800 dark:text-green-300",children:"Stripe Connected"}),e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Your account is ready to process payments."})]})]}),e.jsx("div",{className:"text-sm font-mono text-zinc-500 dark:text-zinc-400",children:n.stripeAccountId})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 p-6 rounded-lg shadow-sm",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-zinc-500 dark:text-zinc-400",children:"Total Revenue"}),e.jsxs("div",{className:"text-3xl font-bold",children:["$",i?(i.totalRevenue/100).toFixed(2):"0.00"]}),e.jsx("div",{className:"text-xs mt-2 text-zinc-500 dark:text-zinc-400",children:"Est. All Time"})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 p-6 rounded-lg shadow-sm",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-zinc-500 dark:text-zinc-400",children:"Monthly Recurring"}),e.jsxs("div",{className:"text-3xl font-bold",children:["$",i?(i.mrr/100).toFixed(2):"0.00"]}),e.jsxs("div",{className:"text-xs mt-2 text-zinc-500 dark:text-zinc-400",children:["Active Subs: ",i?.activeSubscriptions||0]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 p-6 rounded-lg shadow-sm",children:[e.jsx("div",{className:"text-sm font-medium mb-1 text-zinc-500 dark:text-zinc-400",children:"Stripe Balance"}),e.jsxs("div",{className:"text-3xl font-bold",children:["$",r?(r.available/100).toFixed(2):"0.00"]}),e.jsxs("div",{className:"text-xs mt-2 text-zinc-500 dark:text-zinc-400",children:["Pending: $",r?(r.pending/100).toFixed(2):"0.00"]})]})]}),e.jsxs("div",{className:"p-4 rounded-lg bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800",children:[e.jsx("h3",{className:"font-semibold mb-4 text-zinc-900 dark:text-zinc-100",children:"Transaction History"}),m.length===0?e.jsx("p",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:"No recent transactions."}):e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-zinc-200 dark:border-zinc-700",children:[e.jsx("th",{className:"text-left py-2 font-medium text-zinc-700 dark:text-zinc-300",children:"Date"}),e.jsx("th",{className:"text-left py-2 font-medium text-zinc-700 dark:text-zinc-300",children:"Description"}),e.jsx("th",{className:"text-left py-2 font-medium text-zinc-700 dark:text-zinc-300",children:"Customer"}),e.jsx("th",{className:"text-right py-2 font-medium text-zinc-700 dark:text-zinc-300",children:"Amount"})]})}),e.jsx("tbody",{children:m.map(s=>e.jsxs("tr",{className:"border-b last:border-0 border-zinc-200 dark:border-zinc-700",children:[e.jsx("td",{className:"py-2 text-zinc-600 dark:text-zinc-400",children:new Date(s.date).toLocaleDateString()}),e.jsx("td",{className:"py-2 text-zinc-600 dark:text-zinc-400",children:s.description}),e.jsx("td",{className:"py-2 text-zinc-600 dark:text-zinc-400",children:s.customer}),e.jsxs("td",{className:"py-2 text-right text-zinc-900 dark:text-zinc-100",children:["$",(s.amount/100).toFixed(2)]})]},s.id))})]})]})]}):e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 p-8 rounded-lg shadow-sm text-center",children:[e.jsx("div",{className:"mb-4 text-4xl",children:"ðŸ’³"}),e.jsx("h2",{className:"text-xl font-bold mb-2",children:"Setup Payouts"}),e.jsx("p",{className:"mb-6 max-w-md mx-auto text-zinc-500 dark:text-zinc-400",children:"Connect with Stripe to start accepting payments for classes and memberships. Funds will be deposited directly to your bank account."}),e.jsxs("button",{onClick:b,className:"bg-[#635BFF] text-white px-6 py-2.5 rounded-md font-medium hover:bg-[#534be0] transition-colors inline-flex items-center gap-2",children:[e.jsx("span",{children:"Connect with Stripe"}),e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M10 6v-2h14v16h-14v-2h-2v4h18v-20h-18v4h2zm-8 4h10v-3l6 5-6 5v-3h-10v-4z"})})]}),e.jsx("p",{className:"mt-4 text-xs text-zinc-400 dark:text-zinc-500",children:"You will be redirected to Stripe to verify your business information."})]})]})});export{F as default};
