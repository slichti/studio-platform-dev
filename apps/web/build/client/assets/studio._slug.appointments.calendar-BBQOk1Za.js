import{p as k,q as I,z as A,G as T,a as l,j as e,a1 as $,K as O,aq as P,ar as M,X as D,ag as L,as as _}from"./vendor-react-D59Q0YKK.js";import"./vendor-puck-RN2Ey-av.js";import"./vendor-charts-Dp-zC2wb.js";const G=k(function(){const{appointments:p,services:c,instructors:d,weekStart:m}=I(),[f,v]=A(),b=T(),[j,h]=l.useState(null),[N,x]=l.useState(null),[z,u]=l.useState(!1),o=l.useMemo(()=>{const t=new Date(m),n=t.getDay(),r=new Date(t);return r.setDate(t.getDate()-(n===0?6:n-1)),Array.from({length:7},(a,y)=>{const C=new Date(r);return C.setDate(r.getDate()+y),C.toISOString().split("T")[0]})},[m]),g=t=>{const n=new Date(o[0]);n.setDate(n.getDate()+t*7),v({week:n.toISOString().split("T")[0]})},w=Array.from({length:12},(t,n)=>n+7),S=(t,n)=>p.filter(r=>{const a=new Date(r.startTime);return a.toISOString().split("T")[0]===t&&a.getHours()===n}),s={pending:"bg-yellow-100 border-yellow-300 text-yellow-800",confirmed:"bg-blue-100 border-blue-300 text-blue-800",completed:"bg-green-100 border-green-300 text-green-800",cancelled:"bg-zinc-100 border-zinc-300 text-zinc-500"};return e.jsxs("div",{className:"flex flex-col h-full bg-zinc-50",children:[e.jsxs("header",{className:"bg-white border-b border-zinc-200 px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-zinc-900 rounded-lg text-white",children:e.jsx($,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-zinc-900",children:"Appointments"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Private sessions calendar"})]})]}),e.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-zinc-900 text-white rounded-lg text-sm font-medium hover:bg-zinc-800 flex items-center gap-2",children:[e.jsx(O,{size:16})," New Appointment"]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx("button",{onClick:()=>g(-1),className:"p-2 hover:bg-zinc-100 rounded-lg",children:e.jsx(P,{size:20})}),e.jsxs("span",{className:"font-medium text-zinc-900",children:[new Date(o[0]).toLocaleDateString(void 0,{month:"short",day:"numeric"})," - ",new Date(o[6]).toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})]}),e.jsx("button",{onClick:()=>g(1),className:"p-2 hover:bg-zinc-100 rounded-lg",children:e.jsx(M,{size:20})})]})]}),e.jsx("div",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"min-w-[800px]",children:[e.jsxs("div",{className:"grid grid-cols-8 border-b border-zinc-200 bg-white sticky top-0 z-10",children:[e.jsx("div",{className:"p-3 text-xs font-medium text-zinc-500",children:"Time"}),o.map(t=>{const n=new Date(t),r=t===new Date().toISOString().split("T")[0];return e.jsxs("div",{className:`p-3 text-center border-l border-zinc-200 ${r?"bg-zinc-900 text-white":""}`,children:[e.jsx("div",{className:"text-xs font-medium",children:n.toLocaleDateString(void 0,{weekday:"short"})}),e.jsx("div",{className:`text-lg font-bold ${r?"":"text-zinc-900"}`,children:n.getDate()})]},t)})]}),w.map(t=>e.jsxs("div",{className:"grid grid-cols-8 border-b border-zinc-100",children:[e.jsxs("div",{className:"p-2 text-xs text-zinc-500 text-right pr-4",children:[t%12||12,":00 ",t<12?"AM":"PM"]}),o.map(n=>{const r=S(n,t);return e.jsx("div",{className:"border-l border-zinc-100 min-h-[60px] p-1 hover:bg-zinc-50 cursor-pointer transition",onClick:()=>h({date:n,hour:t}),children:r.map(a=>e.jsxs("div",{onClick:y=>{y.stopPropagation(),x(a)},className:`p-1.5 rounded text-xs mb-1 border cursor-pointer ${s[a.status]||s.pending}`,children:[e.jsx("div",{className:"font-medium truncate",children:a.service?.title||"Session"}),e.jsx("div",{className:"truncate opacity-75",children:a.member?.user?.profile?.firstName||"Client"})]},a.id))},`${n}-${t}`)})]},t))]})}),(z||j)&&e.jsx(q,{services:c,instructors:d,defaultSlot:j,onClose:()=>{u(!1),h(null)},onSave:t=>{const n=new FormData;n.append("intent","create"),Object.entries(t).forEach(([r,a])=>n.append(r,String(a))),b(n,{method:"post"}),u(!1),h(null)}}),N&&e.jsx(E,{appointment:N,onClose:()=>x(null),onUpdateStatus:(t,n)=>{b({intent:"update-status",id:t,status:n},{method:"post"}),x(null)}})]})});function q({services:i,instructors:p,defaultSlot:c,onClose:d,onSave:m}){const[f,v]=l.useState(""),[b,j]=l.useState(""),[h,N]=l.useState(""),[x,z]=l.useState(c?.date||new Date().toISOString().split("T")[0]),[u,o]=l.useState(c?`${String(c.hour).padStart(2,"0")}:00`:"09:00"),[g,w]=l.useState(""),S=s=>{s.preventDefault();const t=new Date(`${x}T${u}`).toISOString();m({serviceId:f,instructorId:b,memberId:h,startTime:t,notes:g})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"New Appointment"}),e.jsx("button",{onClick:d,children:e.jsx(D,{size:20,className:"text-zinc-400 hover:text-zinc-600"})})]}),e.jsxs("form",{onSubmit:S,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Service *"}),e.jsxs("select",{required:!0,value:f,onChange:s=>v(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg",children:[e.jsx("option",{value:"",children:"Select service..."}),i.map(s=>e.jsxs("option",{value:s.id,children:[s.title," (",s.durationMinutes," min)"]},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Instructor *"}),e.jsxs("select",{required:!0,value:b,onChange:s=>j(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg",children:[e.jsx("option",{value:"",children:"Select instructor..."}),p.map(s=>e.jsxs("option",{value:s.id,children:[s.user?.profile?.firstName," ",s.user?.profile?.lastName]},s.id))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Date"}),e.jsx("input",{type:"date",value:x,onChange:s=>z(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Time"}),e.jsx("input",{type:"time",value:u,onChange:s=>o(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:g,onChange:s=>w(s.target.value),rows:2,className:"w-full px-3 py-2 border border-zinc-200 rounded-lg resize-none"})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:d,className:"px-4 py-2 text-sm font-medium text-zinc-500",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 text-sm font-medium bg-zinc-900 text-white rounded-lg hover:bg-zinc-800",children:"Create"})]})]})]})})}function E({appointment:i,onClose:p,onUpdateStatus:c}){const d=m=>new Date(m).toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"});return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:i.service?.title||"Appointment"}),e.jsx("button",{onClick:p,children:e.jsx(D,{size:20,className:"text-zinc-400 hover:text-zinc-600"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx(L,{size:16,className:"text-zinc-400"}),d(i.startTime)]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx(_,{size:16,className:"text-zinc-400"}),i.member?.user?.profile?.firstName," ",i.member?.user?.profile?.lastName]}),i.notes&&e.jsx("p",{className:"text-sm text-zinc-600 bg-zinc-50 p-3 rounded-lg",children:i.notes}),e.jsxs("div",{className:"pt-4 border-t space-y-2",children:[e.jsx("p",{className:"text-xs font-medium text-zinc-500 uppercase",children:"Update Status"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>c(i.id,"confirmed"),className:"flex-1 py-2 text-xs font-medium bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200",children:"Confirm"}),e.jsx("button",{onClick:()=>c(i.id,"completed"),className:"flex-1 py-2 text-xs font-medium bg-green-100 text-green-700 rounded-lg hover:bg-green-200",children:"Complete"}),e.jsx("button",{onClick:()=>c(i.id,"cancelled"),className:"flex-1 py-2 text-xs font-medium bg-red-100 text-red-700 rounded-lg hover:bg-red-200",children:"Cancel"})]})]})]})]})})}export{G as default};
