import{w as u,c as h}from"./chunk-JMJ3UQ3L-ksN8Xei4.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{C as o,a as j,b as p,d as x}from"./Card-IOiQbqBT.js";import{B as m}from"./Badge-BS0VuEA_.js";function f({children:t,className:s=""}){return e.jsx("div",{className:`w-full overflow-auto ${s}`,children:e.jsx("table",{className:"w-full text-sm text-left",children:t})})}function N({children:t}){return e.jsx("thead",{className:"text-xs text-zinc-500 uppercase bg-zinc-50/50 border-b border-zinc-200",children:t})}function d({children:t,className:s=""}){return e.jsx("tr",{className:`border-b border-zinc-100 last:border-0 hover:bg-zinc-50/50 transition-colors ${s}`,children:t})}function i({children:t,className:s=""}){return e.jsx("th",{className:`px-6 py-3 font-medium ${s}`,children:t})}function c({children:t,className:s="",...r}){return e.jsx("td",{className:`px-6 py-4 ${s}`,...r,children:t})}function l({title:t,value:s,status:r,trend:a}){const n={success:"text-emerald-600",warning:"text-amber-600",error:"text-red-600",neutral:"text-zinc-900"};return e.jsx(o,{children:e.jsx(x,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-zinc-500",children:t}),e.jsx("h4",{className:`text-2xl font-bold mt-2 ${n[r||"neutral"]}`,children:s})]}),a&&e.jsx("span",{className:"text-xs font-medium px-2 py-1 bg-zinc-100 rounded-full text-zinc-600",children:a})]})})})}function b(t){const s=typeof t.details=="string"?JSON.parse(t.details):t.details||{},r=t.targetId?e.jsxs("span",{className:"font-mono text-xs bg-zinc-100 px-1 rounded",children:[t.targetId.substring(0,8),"..."]}):null;switch(t.action){case"create_user_manual":return e.jsxs("span",{children:["Created user ",e.jsx("span",{className:"font-medium",children:s.email})]});case"delete_user_admin":return e.jsxs("span",{children:["Deleted user account ",r]});case"bulk_delete_users":return e.jsxs("span",{children:["Bulk deleted ",e.jsx("span",{className:"font-medium",children:s.count})," users"]});case"promote_to_admin":return e.jsxs("span",{children:["Promoted ",e.jsx("span",{className:"font-medium",children:s.count})," users to System Admin"]});case"demote_from_admin":return e.jsxs("span",{children:["Revoked System Admin from ",e.jsx("span",{className:"font-medium",children:s.count})," users"]});case"update_tenant_tier":return e.jsxs("span",{children:["Changed tenant tier to ",e.jsx(m,{variant:"outline",className:"text-xs uppercase",children:s.tier})]});case"impersonate_user":return e.jsxs("span",{children:["Impersonated ",e.jsx("span",{className:"font-medium",children:s.targetEmail})]});case"update_zoom_credentials":return e.jsxs("span",{children:["Updated Zoom credentials for tenant ",r]});case"grant_studio_access":return e.jsxs("span",{children:["Granted ",e.jsx("span",{className:"font-medium",children:s.role})," access to studio"]});case"revoke_studio_access":return e.jsx("span",{children:"Revoked access from studio"});case"scan_file":return e.jsxs("span",{children:["Virus scan result: ",e.jsx("span",{className:s.infected?"text-red-600 font-bold":"text-green-600",children:s.infected?"INFECTED":"Clean"})]});case"USER_LOGIN":return e.jsx("span",{children:"User logged in"});default:const a=Object.keys(s).filter(n=>!["userAgent","ip"].includes(n));return a.length>0?e.jsx("span",{className:"text-zinc-500",children:a.map(n=>`${n}: ${s[n]}`).join(", ")}):e.jsx("span",{className:"text-zinc-400 italic",children:"No additional details"})}}const z=u(function(){const{logs:s,health:r}=h();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight text-zinc-900",children:"Dashboard Overview"}),e.jsx("p",{className:"text-zinc-500",children:"System performance and activity monitoring."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(l,{title:"System Status",value:r?.status==="error"?"Error":r?.status==="healthy"?"Operational":"Degraded",status:r?.status==="error"?"error":r?.status==="healthy"?"success":"warning",trend:r?.status==="error"?r?.error||"Unknown Error":`Latency: ${r?.dbLatencyMs||0}ms`}),e.jsx(l,{title:"Active Tenants",value:String(r?.activeTenants||0),status:"neutral"}),e.jsx(l,{title:"Total Users",value:String(r?.totalUsers||0),status:"neutral"}),e.jsx(l,{title:"Recent Errors",value:String(r?.recentErrors||0),status:r?.recentErrors>0?"error":"success",trend:"Last 24h"})]}),e.jsxs(o,{children:[e.jsx(j,{children:e.jsx(p,{children:"Recent Audit Logs"})}),e.jsx(x,{className:"p-0",children:Array.isArray(s)?e.jsxs(f,{children:[e.jsx(N,{children:e.jsxs(d,{children:[e.jsx(i,{className:"w-[180px]",children:"Time"}),e.jsx(i,{className:"w-[150px]",children:"Action"}),e.jsx(i,{children:"Summary"}),e.jsx(i,{children:"Actor"})]})}),e.jsxs("tbody",{children:[s.map(a=>e.jsxs(d,{className:"hover:bg-zinc-50",children:[e.jsx(c,{className:"font-mono text-xs text-zinc-500 whitespace-nowrap",children:new Date(a.createdAt).toLocaleString(void 0,{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})}),e.jsx(c,{children:e.jsx(m,{variant:"outline",className:"font-mono text-[10px] uppercase",children:a.action.replace(/_/g," ")})}),e.jsx(c,{className:"text-sm",children:b(a)}),e.jsx(c,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"text-sm font-medium text-zinc-900",children:[a.actorProfile?.firstName," ",a.actorProfile?.lastName]}),e.jsx("span",{className:"text-xs text-zinc-500",children:a.actorEmail})]})})]},a.id)),s.length===0&&e.jsx(d,{children:e.jsx(c,{className:"text-center text-zinc-500 py-8",colSpan:4,children:"No recent activity found."})})]})]}):e.jsxs("div",{className:"p-6 text-red-600 bg-red-50",children:[e.jsx("p",{className:"font-medium",children:"Error Loading Logs"}),e.jsx("p",{className:"text-sm mt-1",children:s.error})]})})]})]})});export{z as default};
