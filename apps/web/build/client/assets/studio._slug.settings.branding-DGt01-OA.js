import{w as J,e as M,u as _}from"./chunk-JMJ3UQ3L-BFmd18Yu.js";import{j as e}from"./vendor-puck-aUaaDwmz.js";import{a as n}from"./vendor-livekit-D3VpklN2.js";import{a as l}from"./api-D1U4i9fn.js";import{t as X}from"./index-BFgzoDOP.js";import{C as Y}from"./Dialogs-C3BiSLFk.js";import{I as K}from"./image-B4UGPaq8.js";import{U as B}from"./upload-DoKnH7Yo.js";import{V as Q}from"./video-C2qC2935.js";import{C as W}from"./circle-check-big-DvZS8AIf.js";import{T as Z}from"./trash-2-BHPWr9eo.js";import"./Modal-RrMUvIY-.js";import"./createLucideIcon-CcD9UNCP.js";const ge=J(function(){const{tenant:r}=M(),{assets:b}=_(),[d,i]=n.useState(b),[x,h]=n.useState(null),[f,z]=n.useState(r.branding?.primaryColor||"#4f46e5"),[v,O]=n.useState(r.branding?.logoUrl||""),[N,F]=n.useState(r.branding?.emailReplyTo||""),[k,E]=n.useState(r.branding?.emailFooterText||""),[w,I]=n.useState(r.branding?.hidePoweredBy||!1),[y,C]=n.useState(!1),[c,u]=n.useState(null),[S,o]=n.useState(null),[T,g]=n.useState(null),$=async t=>{t.preventDefault(),C(!0),o(null),g(null);try{const s=await window.Clerk?.session?.getToken();await l("/tenant/settings",s,{method:"PATCH",headers:{"X-Tenant-Slug":r.slug},body:JSON.stringify({branding:{primaryColor:f,logoUrl:v,emailReplyTo:N,emailFooterText:k,hidePoweredBy:w}})}),g("Branding saved successfully.")}catch(s){o(s.message||"Failed to save branding.")}finally{C(!1)}},R=async t=>{u("logo"),o(null);try{const s=await window.Clerk?.session?.getToken(),a=new FormData;a.append("file",t),a.append("title",`Logo - ${t.name}`);const m=await l("/uploads/r2-image",s,{method:"POST",body:a});O(m.url),g("Logo uploaded. Don't forget to save settings.")}catch(s){console.error(s),o("Logo upload failed: "+s.message)}finally{u(null)}},U=async(t,s)=>{u(s),o(null);try{const a=await window.Clerk?.session?.getToken(),{uploadUrl:m,uid:j}=await l("/video-management/branding/upload-url",a,{method:"POST",body:JSON.stringify({type:s})}),A=new FormData;if(A.append("file",t),!(await fetch(m,{method:"POST",body:A})).ok)throw new Error("Upload to video server failed");await l("/video-management/branding",a,{method:"POST",body:JSON.stringify({type:s,title:t.name,cloudflareStreamId:j})});const G=await l("/video-management/branding",a);i(G),g(`Uploaded ${s} video successfully.`)}catch(a){console.error(a),o("Upload failed: "+a.message)}finally{u(null)}},D=async t=>{try{const s=await window.Clerk?.session?.getToken();await l(`/video-management/branding/${t}/activate`,s,{method:"PATCH"}),i(d.map(a=>{if(a.id===t)return{...a,active:!0};const m=d.find(j=>j.id===t);return m&&a.type===m.type&&a.id!==t?{...a,active:!1}:a}))}catch{o("Failed to activate asset")}},P=t=>{h(t)},V=async()=>{if(x)try{const t=await window.Clerk?.session?.getToken();await l(`/video-management/branding/${x}`,t,{method:"DELETE"}),i(d.filter(s=>s.id!==x)),h(null),X.success("Asset deleted successfully")}catch{o("Failed to delete asset")}},H=d.filter(t=>t.type==="intro"),q=d.filter(t=>t.type==="outro");return e.jsxs("div",{className:"max-w-4xl pb-10 space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-zinc-900 dark:text-zinc-100 mb-2",children:"Customize Branding"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400",children:"Manage your studio's look, feel, and video assets."})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6 shadow-sm",children:[S&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 p-3 rounded mb-4 text-sm",children:S}),T&&e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 p-3 rounded mb-4 text-sm",children:T}),e.jsx("h2",{className:"text-lg font-semibold text-zinc-900 dark:text-zinc-100 mb-6",children:"General Appearance"}),e.jsxs("form",{onSubmit:$,className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-2",children:"Studio Logo"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"h-24 w-24 bg-zinc-100 dark:bg-zinc-800 rounded-lg border border-zinc-200 dark:border-zinc-700 flex items-center justify-center overflow-hidden relative group",children:[v?e.jsx("img",{src:v,alt:"Studio Logo",className:"object-cover w-full h-full"}):e.jsx(K,{className:"text-zinc-300",size:32}),e.jsxs("label",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center cursor-pointer transition-opacity text-white text-xs font-medium",children:["Change",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:t=>t.target.files?.[0]&&R(t.target.files[0]),disabled:c==="logo"})]})]}),e.jsxs("div",{className:"flex-1 text-sm text-zinc-500",children:[e.jsx("p",{children:"Upload a square image for best results. Used in emails and header."}),c==="logo"&&e.jsx("p",{className:"text-blue-600 animate-pulse mt-1",children:"Uploading..."})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-2",children:"Primary Brand Color"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"color",value:f,onChange:t=>z(t.target.value),className:"w-10 h-10 p-0 border-none rounded cursor-pointer bg-transparent"}),e.jsx("input",{type:"text",value:f,onChange:t=>z(t.target.value),className:"flex-1 bg-transparent text-zinc-900 dark:text-zinc-100 border border-zinc-200 dark:border-zinc-700 rounded-md px-3 py-2 text-sm font-mono focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"#000000"})]})]})]}),e.jsxs("div",{className:"border-t border-zinc-200 dark:border-zinc-800 pt-6",children:[e.jsx("h2",{className:"text-base font-semibold text-zinc-900 dark:text-zinc-100 mb-4",children:"Email Settings"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-2",children:"Reply-To Address"}),e.jsx("input",{type:"email",value:N,onChange:t=>F(t.target.value),className:"w-full bg-transparent text-zinc-900 dark:text-zinc-100 border border-zinc-200 dark:border-zinc-700 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"hello@yourstudio.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-2",children:"Email Footer Text"}),e.jsx("textarea",{value:k,onChange:t=>E(t.target.value),className:"w-full min-h-[80px] bg-transparent text-zinc-900 dark:text-zinc-100 border border-zinc-200 dark:border-zinc-700 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none resize-y",placeholder:"e.g. 123 Yoga St, City, ST"})]})]}),e.jsx("div",{className:"border-t border-zinc-200 dark:border-zinc-800 pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{id:"hidePoweredBy",type:"checkbox",checked:w,onChange:t=>I(t.target.checked),disabled:r.tier?.toLowerCase()!=="scale",className:"h-4 w-4 rounded border-zinc-300 text-blue-600 focus:ring-blue-500 disabled:opacity-50"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("label",{htmlFor:"hidePoweredBy",className:`font-medium ${r.tier?.toLowerCase()!=="scale"?"text-zinc-400":"text-zinc-900"}`,children:'Hide "Powered by StudioPlatform" badge'}),e.jsx("p",{className:"text-zinc-500 text-xs mt-0.5",children:"Scale tier required."})]})]})}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",disabled:y,className:`bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 px-5 py-2.5 rounded-md font-medium text-sm hover:opacity-90 transition-opacity ${y?"opacity-70 cursor-not-allowed":""}`,children:y?"Saving...":"Save General Settings"})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-zinc-900 dark:text-zinc-100",children:"Video Branding"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400",children:"Intros and Outros to automatically stitch to your VOD uploads."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-zinc-900",children:"Intro Videos"}),e.jsxs("label",{className:"cursor-pointer bg-zinc-100 hover:bg-zinc-200 text-zinc-800 px-3 py-1.5 rounded-md text-xs font-medium transition flex items-center gap-2",children:[e.jsx(B,{size:14}),c==="intro"?"Uploading...":"Upload Intro",e.jsx("input",{type:"file",accept:"video/*",className:"hidden",onChange:t=>t.target.files?.[0]&&U(t.target.files[0],"intro"),disabled:!!c})]})]}),e.jsx(L,{assets:H,onActivate:D,onDelete:P,emptyMessage:"No intros uploaded. Upload a short video to play before your classes."})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-zinc-900",children:"Outro Videos"}),e.jsxs("label",{className:"cursor-pointer bg-zinc-100 hover:bg-zinc-200 text-zinc-800 px-3 py-1.5 rounded-md text-xs font-medium transition flex items-center gap-2",children:[e.jsx(B,{size:14}),c==="outro"?"Uploading...":"Upload Outro",e.jsx("input",{type:"file",accept:"video/*",className:"hidden",onChange:t=>t.target.files?.[0]&&U(t.target.files[0],"outro"),disabled:!!c})]})]}),e.jsx(L,{assets:q,onActivate:D,onDelete:P,emptyMessage:"No outros uploaded. Upload a short video to play after your classes."})]})]})]}),e.jsx(Y,{isOpen:!!x,onClose:()=>h(null),onConfirm:V,title:"Delete Branding Asset",message:"Are you sure you want to delete this branding asset? This action cannot be undone.",confirmText:"Delete",isDestructive:!0})]})});function L({assets:p,onActivate:r,onDelete:b,emptyMessage:d}){return p.length===0?e.jsx("div",{className:"text-zinc-400 text-sm py-8 text-center bg-zinc-50 rounded-lg border border-dashed border-zinc-200 px-10",children:d}):e.jsx("div",{className:"space-y-3",children:p.map(i=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${i.active?"border-indigo-200 bg-indigo-50/50":"border-zinc-200 hover:bg-zinc-50"} transition`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-zinc-200 rounded flex items-center justify-center text-zinc-400",children:e.jsx(Q,{size:14})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-zinc-900",children:i.title}),i.active&&e.jsxs("div",{className:"text-xs text-indigo-600 font-medium flex items-center gap-1",children:[e.jsx(W,{size:10})," Active"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!i.active&&e.jsx("button",{onClick:()=>r(i.id),className:"text-xs text-zinc-500 hover:text-indigo-600 px-2 py-1 rounded hover:bg-indigo-50 transition",children:"Set Active"}),e.jsx("button",{onClick:()=>b(i.id),className:"p-1.5 text-zinc-400 hover:text-red-600 rounded transition",children:e.jsx(Z,{size:14})})]})]},i.id))})}export{ge as default};
