import{w as U,c as D,e as E,b as P,F as g,L as q}from"./chunk-JZWAC4HX-Cg_gv2PJ.js";import{j as e}from"./vendor-puck-D_CB0wXL.js";import{a as I}from"./api-ChCisjdG.js";import{a as m}from"./vendor-sentry-DugYw-Ne.js";import{U as L}from"./upload-CNi1Qv8K.js";import{F as A}from"./file-text-BCEKkAZH.js";import{C as B}from"./circle-alert-BKf4ej_b.js";import{C as M}from"./circle-check-big-DXKf0ujb.js";import{L as f}from"./loader-circle-DYdrNEzV.js";import{A as k}from"./arrow-right-NuY2qCvM.js";import{C as R}from"./circle-check-BXm1-ma4.js";import{X as $}from"./x-Bbpoc0N5.js";import{P as O}from"./plus-7j3qtkRM.js";import"./createLucideIcon-BOpDDQ2B.js";function W({tenantSlug:F,onSuccess:j,onSkip:z}){const[x,s]=m.useState(null),[r,u]=m.useState(!1),[l,p]=m.useState(null),[v,n]=m.useState(null),N=o=>{if(o.target.files&&o.target.files[0]){const i=o.target.files[0];s(i),n(null),p(null);const h=new FileReader;h.onload=d=>{const y=d.target?.result;if(!y)return;const w=y.split(/\r\n|\n/);if(w.length>0){const T=w[0].toLowerCase().split(",").map(a=>a.trim()),t=["email","firstname","lastname"].filter(a=>!T.includes(a));t.length>0&&(n(`Missing required headers: ${t.join(", ")}`),s(null))}},h.readAsText(i)}},b=async o=>{if(o.preventDefault(),!x){n("Please select a file.");return}u(!0),n(null),p(null);try{const i=await window.Clerk?.session?.getToken(),h=new FormData;h.append("file",x);const d=await I("/import/csv",i,{method:"POST",headers:{"X-Tenant-Slug":F},body:h});d.error?(n(d.error),d.details&&console.error(d.details)):p(d)}catch(i){n(i.message||"Upload failed.")}finally{u(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 text-blue-800 dark:text-blue-200 rounded text-sm",children:[e.jsx("p",{className:"font-semibold mb-1",children:"CSV Format Requirements:"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[e.jsxs("li",{children:["Headers: ",e.jsx("code",{children:"email"}),", ",e.jsx("code",{children:"firstname"}),", ",e.jsx("code",{children:"lastname"})]}),e.jsxs("li",{children:["Membership: ",e.jsx("code",{children:"membership"})," (Plan Name)"]})]})]}),e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{className:"border-2 border-dashed border-zinc-300 dark:border-zinc-700 rounded-lg p-8 flex flex-col items-center justify-center text-center hover:bg-zinc-50 dark:hover:bg-zinc-800/50 transition-colors",children:[e.jsx(L,{className:"h-10 w-10 text-zinc-400 mb-3"}),x?e.jsxs("div",{className:"flex items-center gap-2 text-zinc-900 dark:text-zinc-100 font-medium",children:[e.jsx(A,{className:"h-5 w-5 text-blue-500"}),x.name]}):e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[e.jsx("span",{className:"text-blue-600 dark:text-blue-400 font-medium hover:text-blue-500",children:"Upload CSV"}),e.jsx("span",{className:"text-zinc-500",children:" or drag/drop"}),e.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",accept:".csv",onChange:N})]}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Max 10MB"})]})]}),v&&e.jsxs("div",{className:"flex items-start gap-2 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 p-3 rounded",children:[e.jsx(B,{className:"h-5 w-5 shrink-0"}),e.jsx("span",{className:"text-sm",children:v})]}),l&&e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 text-green-800 dark:text-green-300 p-4 rounded border border-green-200 dark:border-green-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 font-semibold",children:[e.jsx(M,{className:"h-5 w-5"}),"Import Complete"]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:["Created: ",l.created,", Skipped: ",l.skipped]}),l.errors&&l.errors.length>0&&e.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 mt-1",children:[l.errors.length," row errors (see logs)"]})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4",children:[z&&e.jsx("button",{type:"button",onClick:z,className:"text-zinc-500 hover:text-zinc-700 dark:text-zinc-400 dark:hover:text-zinc-200 text-sm font-medium",children:"Skip Import"}),l?e.jsx("button",{type:"button",onClick:j,className:"bg-green-600 text-white px-6 py-2 rounded-xl font-bold hover:bg-green-700 transition flex items-center gap-2",children:"Continue"}):e.jsx("button",{type:"submit",disabled:!x||r,className:"bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 px-6 py-2 rounded-xl font-bold hover:opacity-90 disabled:opacity-50 flex items-center gap-2 ml-auto",children:r?"Importing...":"Start Import"})]})]})]})}const ae=U(function(){const{tenant:j}=D(),z=E();P();const x=j.settings?.onboardingStep||1,[s,r]=m.useState(x),[u,l]=m.useState("yoga"),[p,v]=m.useState(""),[n,N]=m.useState(!1),[b,o]=m.useState([""]),i=z.state==="submitting",h=async t=>{N(!0);try{const a=await window.Clerk?.session?.getToken(),c=new FormData;c.append("file",t),c.append("title",`Logo - ${t.name}`);const C=await I("/uploads/r2-image",a,{method:"POST",body:c});v(C.url)}catch(a){console.error("Logo upload failed",a),alert("Failed to upload logo. Please try again.")}finally{N(!1)}},d=()=>o([...b,""]),y=(t,a)=>{const c=[...b];c[t]=a,o(c)},w=t=>{const a=b.filter((c,C)=>C!==t);o(a)},S=(()=>{switch(u){case"gym":return{title:"HIIT Session",price:2500};case"crossfit":return{title:"WOD",price:3e3};case"art":return{title:"Painting Workshop",price:4500};case"martial-arts":return{title:"Kickboxing Fundamentals",price:2500};case"dance":return{title:"Salsa Beginner",price:2e3};case"pilates":return{title:"Reformer Flow",price:3500};case"pt":return{title:"1:1 Assessment",price:8e3};case"yoga":default:return{title:"Vinyasa Flow",price:2e3}}})();return e.jsx("div",{className:"min-h-screen bg-zinc-50 dark:bg-zinc-950 flex flex-col items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-xl w-full bg-white dark:bg-zinc-900 rounded-2xl shadow-xl border border-zinc-200 dark:border-zinc-800 overflow-hidden",children:[e.jsx("div",{className:"h-2 bg-zinc-100 dark:bg-zinc-800 w-full relative",children:e.jsx("div",{className:"absolute left-0 top-0 h-full bg-indigo-600 transition-all duration-500",style:{width:`${s/7*100}%`}})}),e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 rounded-full flex items-center justify-center mx-auto mb-4 text-xl font-bold",children:s}),e.jsxs("h1",{className:"text-2xl font-bold text-zinc-900 dark:text-zinc-100",children:[s===1&&"Choose your Business Type",s===2&&"Set your Brand",s===3&&"Create a Location",s===4&&"Schedule First Class",s===5&&"Migrate Data",s===6&&"You're all set!"]}),e.jsxs("p",{className:"text-zinc-500 dark:text-zinc-400 mt-2",children:[s===1&&"We'll customize your setup based on your needs.",s===2&&"Choose a color that represents your studio.",s===3&&"Where will your classes take place?",s===4&&"Get your calendar started with one event.",s===5&&"Invite your instructors and staff.",s===6&&"Import users and classes from your previous system.",s===7&&"Your studio is ready to accept bookings."]})]}),s===1&&e.jsxs(g,{method:"post",onSubmit:()=>setTimeout(()=>r(2),500),children:[e.jsx("input",{type:"hidden",name:"step",value:"template"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:[{id:"yoga",label:"Yoga / Pilates",icon:"ðŸ§˜"},{id:"gym",label:"Gym / Fitness",icon:"ðŸ’ª"},{id:"crossfit",label:"Crossfit",icon:"ðŸ‹ï¸"},{id:"art",label:"Art / Workshop",icon:"ðŸŽ¨"},{id:"martial-arts",label:"Martial Arts",icon:"ðŸ¥‹"},{id:"dance",label:"Dance",icon:"ðŸ’ƒ"},{id:"pilates",label:"Pilates",icon:"ðŸ¤¸"},{id:"pt",label:"Personal Training",icon:"â±ï¸"}].map(t=>e.jsxs("label",{className:`cursor-pointer border-2 rounded-xl p-4 flex flex-col items-center gap-2 transition-all ${u===t.id?"border-indigo-600 bg-indigo-50 dark:bg-indigo-900/20":"border-zinc-200 dark:border-zinc-800 hover:border-zinc-300"}`,children:[e.jsx("input",{type:"radio",name:"template",value:t.id,checked:u===t.id,onChange:()=>l(t.id),className:"sr-only"}),e.jsx("span",{className:"text-3xl",children:t.icon}),e.jsx("span",{className:"font-semibold text-sm",children:t.label})]},t.id))}),e.jsx("button",{disabled:i,className:"w-full mt-8 bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 py-3 rounded-xl font-bold flex items-center justify-center gap-2 hover:opacity-90 transition",children:i?e.jsx(f,{className:"animate-spin"}):e.jsxs(e.Fragment,{children:["Next Step ",e.jsx(k,{size:16})]})})]}),s===2&&e.jsxs(g,{method:"post",onSubmit:()=>setTimeout(()=>r(3),500),children:[e.jsx("input",{type:"hidden",name:"step",value:"branding"}),e.jsx("input",{type:"hidden",name:"logoUrl",value:p}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2",children:"Studio Logo"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"cursor-pointer group relative h-24 w-24 rounded-xl bg-zinc-100 dark:bg-zinc-800 border-2 border-dashed border-zinc-300 dark:border-zinc-700 flex flex-col items-center justify-center hover:border-indigo-500 transition overflow-hidden",children:[p?e.jsx("img",{src:p,alt:"Logo",className:"w-full h-full object-cover"}):e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"text-zinc-400 mb-1 group-hover:text-indigo-500",size:24}),e.jsx("span",{className:"text-[10px] text-zinc-500 uppercase font-bold group-hover:text-indigo-500",children:"Upload"})]}),n&&e.jsx("div",{className:"absolute inset-0 bg-white/80 dark:bg-black/80 flex items-center justify-center",children:e.jsx(f,{className:"animate-spin text-indigo-600"})}),e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:t=>t.target.files?.[0]&&h(t.target.files[0]),disabled:n})]}),e.jsxs("div",{className:"flex-1 text-sm text-zinc-500",children:[e.jsx("p",{children:"Upload a square logo for best results."}),e.jsx("p",{className:"mt-1",children:"It will appear in your emails and client portal."})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2",children:"Brand Color"}),e.jsx("div",{className:"grid grid-cols-5 gap-2",children:["#4f46e5","#ec4899","#10b981","#f59e0b","#dc2626"].map(t=>e.jsxs("label",{className:"relative cursor-pointer group",children:[e.jsx("input",{type:"radio",name:"primaryColor",value:t,className:"peer sr-only",defaultChecked:t==="#4f46e5"}),e.jsx("div",{className:"w-full aspect-square rounded-full border-2 border-transparent peer-checked:border-zinc-900 dark:peer-checked:border-white transition-all shadow-sm",style:{backgroundColor:t}}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 peer-checked:opacity-100 text-white",children:e.jsx(R,{size:16})})]},t))})]})]}),e.jsx("button",{disabled:i||n,className:"w-full mt-8 bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 py-3 rounded-xl font-bold flex items-center justify-center gap-2 hover:opacity-90 transition",children:i?e.jsx(f,{className:"animate-spin"}):e.jsxs(e.Fragment,{children:["Next Step ",e.jsx(k,{size:16})]})})]}),s===3&&e.jsxs(g,{method:"post",onSubmit:()=>setTimeout(()=>r(4),500),children:[e.jsx("input",{type:"hidden",name:"step",value:"location"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Location Name"}),e.jsx("input",{required:!0,name:"name",placeholder:"e.g. Main Studio",className:"w-full p-2.5 rounded-lg border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Address"}),e.jsx("input",{required:!0,name:"address",placeholder:"123 Yoga Lane",className:"w-full p-2.5 rounded-lg border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900"})]})]}),e.jsx("button",{disabled:i,className:"w-full mt-8 bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 py-3 rounded-xl font-bold flex items-center justify-center gap-2 hover:opacity-90 transition",children:i?e.jsx(f,{className:"animate-spin"}):e.jsxs(e.Fragment,{children:["Next Step ",e.jsx(k,{size:16})]})})]}),s===4&&e.jsxs(g,{method:"post",onSubmit:()=>setTimeout(()=>r(5),500),children:[e.jsx("input",{type:"hidden",name:"step",value:"schedule"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Class Title"}),e.jsx("input",{required:!0,name:"title",defaultValue:S.title,className:"w-full p-2.5 rounded-lg border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Start Time"}),e.jsx("input",{required:!0,type:"datetime-local",name:"startTime",className:"w-full p-2.5 rounded-lg border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900"})]}),e.jsx("input",{type:"hidden",name:"price",value:S.price})]}),e.jsx("button",{disabled:i,className:"w-full mt-8 bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 py-3 rounded-xl font-bold flex items-center justify-center gap-2 hover:opacity-90 transition",children:i?e.jsx(f,{className:"animate-spin"}):e.jsxs(e.Fragment,{children:["Next Step ",e.jsx(k,{size:16})]})})]}),s===5&&e.jsxs(g,{method:"post",onSubmit:()=>setTimeout(()=>r(6),500),children:[e.jsx("input",{type:"hidden",name:"step",value:"team"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-2",children:"Invite Instructors"}),e.jsx("div",{className:"space-y-2",children:b.map((t,a)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"email",name:"emails[]",value:t,onChange:c=>y(a,c.target.value),placeholder:"instructor@example.com",className:"flex-1 p-2.5 rounded-lg border border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-900"}),b.length>1&&e.jsx("button",{type:"button",onClick:()=>w(a),className:"p-2.5 text-zinc-400 hover:text-red-500 transition",children:e.jsx($,{size:20})})]},a))}),e.jsxs("button",{type:"button",onClick:d,className:"mt-2 text-sm text-indigo-600 font-medium flex items-center gap-1 hover:text-indigo-700",children:[e.jsx(O,{size:16})," Add another"]})]})}),e.jsxs("div",{className:"mt-8 flex gap-3",children:[e.jsx("button",{type:"submit",name:"intent",value:"skip",onClick:()=>setTimeout(()=>r(6),500),className:"px-6 py-3 border border-zinc-200 dark:border-zinc-800 text-zinc-600 dark:text-zinc-400 font-bold rounded-xl hover:bg-zinc-50 dark:hover:bg-zinc-800 transition",children:"Skip"}),e.jsx("button",{type:"submit",name:"intent",value:"invite",disabled:i,className:"flex-1 bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 py-3 rounded-xl font-bold flex items-center justify-center gap-2 hover:opacity-90 transition",children:i?e.jsx(f,{className:"animate-spin"}):e.jsxs(e.Fragment,{children:["Send Invites ",e.jsx(k,{size:16})]})})]})]}),s===6&&e.jsxs("div",{children:[e.jsx(W,{tenantSlug:j.slug,onSuccess:()=>{const t=document.getElementById("advance-step-form");t&&t.submit(),r(7)},onSkip:()=>{const t=document.getElementById("advance-step-form");t&&t.submit(),r(7)}}),e.jsx(g,{method:"post",id:"advance-step-form",className:"hidden",children:e.jsx("input",{type:"hidden",name:"step",value:"import_complete"})})]}),s===7&&e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4 animate-bounce",children:"ðŸŽ‰"}),e.jsxs("p",{className:"text-zinc-600 dark:text-zinc-400 mb-8",children:["Great job! Your `",u,"` studio is now configured."]}),e.jsx(q,{to:`/studio/${j.slug}`,className:"w-full bg-indigo-600 text-white py-3 rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-indigo-700 transition shadow-lg shadow-indigo-200 dark:shadow-none",children:"Go to Dashboard"})]})]})]})})});export{ae as default};
