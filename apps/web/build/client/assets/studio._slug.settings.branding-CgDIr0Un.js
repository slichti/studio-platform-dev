import{w as H,e as q,c as G,r}from"./chunk-JMJ3UQ3L-CxfiyNnI.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{a as l}from"./api-D1U4i9fn.js";import{I as J}from"./image-BHjLfDb9.js";import{U as D}from"./upload-CJTAEkss.js";import{V as M}from"./video-BNsgPGFP.js";import{C as _}from"./circle-check-big-S8b0Vkjx.js";import{T as X}from"./trash-2-BtJ_Sc8n.js";import"./createLucideIcon-CglF3LvP.js";const ne=H(function(){const{tenant:n}=q(),{assets:p}=G(),[d,i]=r.useState(p),[b,j]=r.useState(n.branding?.primaryColor||"#4f46e5"),[h,O]=r.useState(n.branding?.logoUrl||""),[z,B]=r.useState(n.branding?.emailReplyTo||""),[y,L]=r.useState(n.branding?.emailFooterText||""),[N,F]=r.useState(n.branding?.hidePoweredBy||!1),[f,k]=r.useState(!1),[c,x]=r.useState(null),[w,o]=r.useState(null),[S,g]=r.useState(null),E=async t=>{t.preventDefault(),k(!0),o(null),g(null);try{const s=await window.Clerk?.session?.getToken();await l("/tenant/settings",s,{method:"PATCH",headers:{"X-Tenant-Slug":n.slug},body:JSON.stringify({branding:{primaryColor:b,logoUrl:h,emailReplyTo:z,emailFooterText:y,hidePoweredBy:N}})}),g("Branding saved successfully.")}catch(s){o(s.message||"Failed to save branding.")}finally{k(!1)}},$=async t=>{x("logo"),o(null);try{const s=await window.Clerk?.session?.getToken(),a=new FormData;a.append("file",t),a.append("title",`Logo - ${t.name}`);const m=await l("/uploads/r2-image",s,{method:"POST",body:a});O(m.url),g("Logo uploaded. Don't forget to save settings.")}catch(s){console.error(s),o("Logo upload failed: "+s.message)}finally{x(null)}},C=async(t,s)=>{x(s),o(null);try{const a=await window.Clerk?.session?.getToken(),{uploadUrl:m,uid:v}=await l("/video-management/branding/upload-url",a,{method:"POST",body:JSON.stringify({type:s})}),P=new FormData;if(P.append("file",t),!(await fetch(m,{method:"POST",body:P})).ok)throw new Error("Upload to video server failed");await l("/video-management/branding",a,{method:"POST",body:JSON.stringify({type:s,title:t.name,cloudflareStreamId:v})});const V=await l("/video-management/branding",a);i(V),g(`Uploaded ${s} video successfully.`)}catch(a){console.error(a),o("Upload failed: "+a.message)}finally{x(null)}},T=async t=>{try{const s=await window.Clerk?.session?.getToken();await l(`/video-management/branding/${t}/activate`,s,{method:"PATCH"}),i(d.map(a=>{if(a.id===t)return{...a,active:!0};const m=d.find(v=>v.id===t);return m&&a.type===m.type&&a.id!==t?{...a,active:!1}:a}))}catch{o("Failed to activate asset")}},U=async t=>{if(confirm("Delete this branding asset?"))try{const s=await window.Clerk?.session?.getToken();await l(`/video-management/branding/${t}`,s,{method:"DELETE"}),i(d.filter(a=>a.id!==t))}catch{o("Failed to delete asset")}},I=d.filter(t=>t.type==="intro"),R=d.filter(t=>t.type==="outro");return e.jsxs("div",{className:"max-w-4xl pb-10 space-y-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-zinc-900 dark:text-zinc-100 mb-2",children:"Customize Branding"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400",children:"Manage your studio's look, feel, and video assets."})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6 shadow-sm",children:[w&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 p-3 rounded mb-4 text-sm",children:w}),S&&e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400 p-3 rounded mb-4 text-sm",children:S}),e.jsx("h2",{className:"text-lg font-semibold text-zinc-900 dark:text-zinc-100 mb-6",children:"General Appearance"}),e.jsxs("form",{onSubmit:E,className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-2",children:"Studio Logo"}),e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"h-24 w-24 bg-zinc-100 dark:bg-zinc-800 rounded-lg border border-zinc-200 dark:border-zinc-700 flex items-center justify-center overflow-hidden relative group",children:[h?e.jsx("img",{src:h,alt:"Studio Logo",className:"object-cover w-full h-full"}):e.jsx(J,{className:"text-zinc-300",size:32}),e.jsxs("label",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 flex items-center justify-center cursor-pointer transition-opacity text-white text-xs font-medium",children:["Change",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:t=>t.target.files?.[0]&&$(t.target.files[0]),disabled:c==="logo"})]})]}),e.jsxs("div",{className:"flex-1 text-sm text-zinc-500",children:[e.jsx("p",{children:"Upload a square image for best results. Used in emails and header."}),c==="logo"&&e.jsx("p",{className:"text-blue-600 animate-pulse mt-1",children:"Uploading..."})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-2",children:"Primary Brand Color"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("input",{type:"color",value:b,onChange:t=>j(t.target.value),className:"w-10 h-10 p-0 border-none rounded cursor-pointer bg-transparent"}),e.jsx("input",{type:"text",value:b,onChange:t=>j(t.target.value),className:"flex-1 bg-transparent text-zinc-900 dark:text-zinc-100 border border-zinc-200 dark:border-zinc-700 rounded-md px-3 py-2 text-sm font-mono focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"#000000"})]})]})]}),e.jsxs("div",{className:"border-t border-zinc-200 dark:border-zinc-800 pt-6",children:[e.jsx("h2",{className:"text-base font-semibold text-zinc-900 dark:text-zinc-100 mb-4",children:"Email Settings"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-2",children:"Reply-To Address"}),e.jsx("input",{type:"email",value:z,onChange:t=>B(t.target.value),className:"w-full bg-transparent text-zinc-900 dark:text-zinc-100 border border-zinc-200 dark:border-zinc-700 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"hello@yourstudio.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wide mb-2",children:"Email Footer Text"}),e.jsx("textarea",{value:y,onChange:t=>L(t.target.value),className:"w-full min-h-[80px] bg-transparent text-zinc-900 dark:text-zinc-100 border border-zinc-200 dark:border-zinc-700 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none resize-y",placeholder:"e.g. 123 Yoga St, City, ST"})]})]}),e.jsx("div",{className:"border-t border-zinc-200 dark:border-zinc-800 pt-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{id:"hidePoweredBy",type:"checkbox",checked:N,onChange:t=>F(t.target.checked),disabled:n.tier!=="scale",className:"h-4 w-4 rounded border-zinc-300 text-blue-600 focus:ring-blue-500 disabled:opacity-50"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("label",{htmlFor:"hidePoweredBy",className:`font-medium ${n.tier!=="scale"?"text-zinc-400":"text-zinc-900"}`,children:'Hide "Powered by StudioPlatform" badge'}),e.jsx("p",{className:"text-zinc-500 text-xs mt-0.5",children:"Scale tier required."})]})]})}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{type:"submit",disabled:f,className:`bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 px-5 py-2.5 rounded-md font-medium text-sm hover:opacity-90 transition-opacity ${f?"opacity-70 cursor-not-allowed":""}`,children:f?"Saving...":"Save General Settings"})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-zinc-900 dark:text-zinc-100",children:"Video Branding"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400",children:"Intros and Outros to automatically stitch to your VOD uploads."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-zinc-900",children:"Intro Videos"}),e.jsxs("label",{className:"cursor-pointer bg-zinc-100 hover:bg-zinc-200 text-zinc-800 px-3 py-1.5 rounded-md text-xs font-medium transition flex items-center gap-2",children:[e.jsx(D,{size:14}),c==="intro"?"Uploading...":"Upload Intro",e.jsx("input",{type:"file",accept:"video/*",className:"hidden",onChange:t=>t.target.files?.[0]&&C(t.target.files[0],"intro"),disabled:!!c})]})]}),e.jsx(A,{assets:I,onActivate:T,onDelete:U,emptyMessage:"No intros uploaded. Upload a short video to play before your classes."})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold text-zinc-900",children:"Outro Videos"}),e.jsxs("label",{className:"cursor-pointer bg-zinc-100 hover:bg-zinc-200 text-zinc-800 px-3 py-1.5 rounded-md text-xs font-medium transition flex items-center gap-2",children:[e.jsx(D,{size:14}),c==="outro"?"Uploading...":"Upload Outro",e.jsx("input",{type:"file",accept:"video/*",className:"hidden",onChange:t=>t.target.files?.[0]&&C(t.target.files[0],"outro"),disabled:!!c})]})]}),e.jsx(A,{assets:R,onActivate:T,onDelete:U,emptyMessage:"No outros uploaded. Upload a short video to play after your classes."})]})]})]})]})});function A({assets:u,onActivate:n,onDelete:p,emptyMessage:d}){return u.length===0?e.jsx("div",{className:"text-zinc-400 text-sm py-8 text-center bg-zinc-50 rounded-lg border border-dashed border-zinc-200 px-10",children:d}):e.jsx("div",{className:"space-y-3",children:u.map(i=>e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${i.active?"border-indigo-200 bg-indigo-50/50":"border-zinc-200 hover:bg-zinc-50"} transition`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-8 w-8 bg-zinc-200 rounded flex items-center justify-center text-zinc-400",children:e.jsx(M,{size:14})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-zinc-900",children:i.title}),i.active&&e.jsxs("div",{className:"text-xs text-indigo-600 font-medium flex items-center gap-1",children:[e.jsx(_,{size:10})," Active"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!i.active&&e.jsx("button",{onClick:()=>n(i.id),className:"text-xs text-zinc-500 hover:text-indigo-600 px-2 py-1 rounded hover:bg-indigo-50 transition",children:"Set Active"}),e.jsx("button",{onClick:()=>p(i.id),className:"p-1.5 text-zinc-400 hover:text-red-600 rounded transition",children:e.jsx(X,{size:14})})]})]},i.id))})}export{ne as default};
