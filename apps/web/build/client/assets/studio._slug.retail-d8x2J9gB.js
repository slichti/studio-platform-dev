import{w as F,u as T,f as U,g as Q,i as E}from"./chunk-JMJ3UQ3L-DR3wp0kw.js";import{j as e}from"./vendor-puck-By1A5E5K.js";import{a as n}from"./vendor-sentry-BD1MTpLq.js";import{t as L}from"./index-C_1Jy3MY.js";import{C as O}from"./Dialogs-LpmU1ed2.js";import{P}from"./package-koM-mwzd.js";import{U as I}from"./upload-BJQyUS3g.js";import{P as $}from"./plus-BBRn-p3b.js";import{S as R}from"./search-S3VI0n0n.js";import{S as q}from"./square-pen-DpcRMrVj.js";import{T as M}from"./trash-2-DU-4PZMS.js";import{B as _}from"./box-B7ngXQvL.js";import{X as D}from"./x-6mvJS0UK.js";import{S as B}from"./save-f-wzAblY.js";import"./Modal-D5keykku.js";import"./createLucideIcon-DgXJrNmH.js";const oe=F(function(){const{products:r}=T(),l=U();Q();const[c,p]=n.useState(""),[d,w]=n.useState(""),[o,h]=n.useState(null),[j,m]=n.useState(!1),[v,x]=n.useState(!1),[u,f]=n.useState(null),N=[...new Set(r.map(t=>t.category).filter(Boolean))],z=r.filter(t=>!(c&&!t.name.toLowerCase().includes(c.toLowerCase())||d&&t.category!==d)),g=t=>{f(t)},y=()=>{u&&(l({intent:"delete",id:u},{method:"post"}),f(null),L.success("Product deleted"))},k=t=>`$${(t/100).toFixed(2)}`;return e.jsxs("div",{className:"flex flex-col h-full bg-zinc-50",children:[e.jsxs("header",{className:"bg-white border-b border-zinc-200 px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-zinc-900 rounded-lg text-white",children:e.jsx(P,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-zinc-900",children:"Retail"}),e.jsxs("p",{className:"text-sm text-zinc-500",children:[r.length," products"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>x(!0),className:"px-3 py-2 border border-zinc-200 rounded-lg text-sm font-medium hover:bg-zinc-50 flex items-center gap-2",children:[e.jsx(I,{size:16})," Import"]}),e.jsxs("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-zinc-900 text-white rounded-lg text-sm font-medium hover:bg-zinc-800 flex items-center gap-2",children:[e.jsx($,{size:16})," Add Product"]})]})]}),e.jsxs("div",{className:"flex gap-4 mt-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(R,{className:"absolute left-3 top-2.5 h-4 w-4 text-zinc-400"}),e.jsx("input",{type:"text",placeholder:"Search products...",className:"w-full pl-9 pr-4 py-2 border border-zinc-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-black/5",value:c,onChange:t=>p(t.target.value)})]}),e.jsxs("select",{value:d,onChange:t=>w(t.target.value),className:"px-4 py-2 border border-zinc-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-black/5",children:[e.jsx("option",{value:"",children:"All Categories"}),N.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:z.length===0?e.jsxs("div",{className:"text-center py-20 text-zinc-500",children:[e.jsx(P,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No products found"}),e.jsxs("div",{className:"flex gap-2 justify-center mt-4",children:[e.jsx("button",{onClick:()=>m(!0),className:"text-sm text-zinc-900 underline",children:"Add manually"}),e.jsx("span",{className:"text-zinc-300",children:"|"}),e.jsx("button",{onClick:()=>x(!0),className:"text-sm text-zinc-900 underline",children:"Import JSON"})]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:z.map(t=>e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 overflow-hidden group hover:border-zinc-300 transition",children:[e.jsxs("div",{className:"aspect-square bg-zinc-100 relative",children:[t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(P,{size:48,className:"text-zinc-300"})}),!t.isActive&&e.jsx("div",{className:"absolute top-2 left-2 px-2 py-1 bg-red-100 text-red-600 text-xs font-medium rounded",children:"Inactive"}),e.jsxs("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition flex gap-1",children:[e.jsx("button",{onClick:()=>h(t),className:"p-1.5 bg-white rounded shadow hover:bg-zinc-50",children:e.jsx(q,{size:14})}),e.jsx("button",{onClick:()=>g(t.id),className:"p-1.5 bg-white rounded shadow hover:bg-red-50 text-red-500",children:e.jsx(M,{size:14})})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-zinc-900",children:t.name}),e.jsx("p",{className:"text-sm text-zinc-500",children:t.category||"Uncategorized"})]}),e.jsx("span",{className:"text-lg font-bold text-zinc-900",children:k(t.price)})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs text-zinc-500",children:[e.jsxs("span",{className:`flex items-center gap-1 ${t.stockQuantity<=(t.lowStockThreshold||5)?"text-amber-600 font-medium":""}`,children:[e.jsx(_,{size:12})," ",t.stockQuantity," in stock",t.stockQuantity<=(t.lowStockThreshold||5)&&e.jsx("span",{className:"text-[10px] bg-amber-100 px-1 rounded border border-amber-200",children:"LOW"})]}),t.sku&&e.jsx("span",{className:"font-mono",children:t.sku})]})]})]},t.id))})}),(o||j)&&e.jsx(J,{product:o,onClose:()=>{h(null),m(!1)},onSave:t=>{const i=new FormData;i.append("intent",o?"update":"create"),o&&i.append("id",o.id),Object.entries(t).forEach(([b,S])=>{i.append(b,String(S))}),l(i,{method:"post"}),h(null),m(!1)}}),v&&e.jsx(W,{onClose:()=>x(!1),onImport:t=>{const i=new FormData;i.append("intent","import_products"),i.append("products",t),l(i,{method:"post"}),x(!1)}}),e.jsx(O,{isOpen:!!u,onClose:()=>f(null),onConfirm:y,title:"Delete Product",message:"Are you sure you want to delete this product? This action cannot be undone.",confirmText:"Delete Product",isDestructive:!0})]})});function J({product:a,onClose:r,onSave:l}){const[c,p]=n.useState(a?.name||""),[d,w]=n.useState(a?.description||""),[o,h]=n.useState(a?.category||""),[j,m]=n.useState(a?.sku||""),[v,x]=n.useState(a?.price?(a.price/100).toFixed(2):""),[u,f]=n.useState(a?.stockQuantity?.toString()||"0"),[N,z]=n.useState(a?.lowStockThreshold?.toString()||"5"),[g,y]=n.useState(a?.imageUrl||""),[k,t]=n.useState(a?.isActive!==!1),i=E(),b=i.state!=="idle";n.useEffect(()=>{i.data&&i.data.url&&i.data.url!==g&&y(i.data.url)},[i.data]);const S=s=>{if(s.target.files&&s.target.files[0]){const C=new FormData;C.append("intent","upload_image"),C.append("file",s.target.files[0]),i.submit(C,{method:"post",encType:"multipart/form-data"})}},A=s=>{s.preventDefault(),l({name:c,description:d,category:o,sku:j,price:Math.round(parseFloat(v||"0")*100),stockQuantity:parseInt(u||"0"),lowStockThreshold:parseInt(N||"5"),imageUrl:g,isActive:k})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:a?"Edit Product":"New Product"}),e.jsx("button",{onClick:r,children:e.jsx(D,{size:20,className:"text-zinc-400 hover:text-zinc-600"})})]}),e.jsxs("form",{onSubmit:A,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Name *"}),e.jsx("input",{type:"text",required:!0,value:c,onChange:s=>p(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg outline-none focus:ring-2 focus:ring-black/5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Price ($)"}),e.jsx("input",{type:"number",step:"0.01",value:v,onChange:s=>x(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg outline-none focus:ring-2 focus:ring-black/5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Stock"}),e.jsx("input",{type:"number",value:u,onChange:s=>f(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg outline-none focus:ring-2 focus:ring-black/5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Low Warning At"}),e.jsx("input",{type:"number",value:N,onChange:s=>z(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg outline-none focus:ring-2 focus:ring-black/5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Category"}),e.jsx("input",{type:"text",value:o,onChange:s=>h(s.target.value),placeholder:"e.g. Apparel",className:"w-full px-3 py-2 border border-zinc-200 rounded-lg outline-none focus:ring-2 focus:ring-black/5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"SKU"}),e.jsx("input",{type:"text",value:j,onChange:s=>m(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg outline-none focus:ring-2 focus:ring-black/5 font-mono"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Description"}),e.jsx("textarea",{value:d,onChange:s=>w(s.target.value),rows:3,className:"w-full px-3 py-2 border border-zinc-200 rounded-lg outline-none focus:ring-2 focus:ring-black/5 resize-none"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Image"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:g,onChange:s=>y(s.target.value),placeholder:"https://...",className:"flex-1 px-3 py-2 border border-zinc-200 rounded-lg outline-none focus:ring-2 focus:ring-black/5"}),e.jsxs("label",{className:`px-3 py-2 border border-zinc-200 rounded-lg bg-zinc-50 hover:bg-zinc-100 cursor-pointer flex items-center gap-2 ${b?"opacity-50 pointer-events-none":""}`,children:[e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:S,disabled:b}),e.jsx(I,{size:16,className:"text-zinc-500"}),e.jsx("span",{className:"text-sm font-medium text-zinc-600",children:b?"...":"Upload"})]})]})]}),e.jsxs("div",{className:"col-span-2 flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:k,onChange:s=>t(s.target.checked),className:"w-4 h-4"}),e.jsx("label",{htmlFor:"isActive",className:"text-sm text-zinc-700",children:"Active (visible to customers)"})]})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-3 border-t border-zinc-100",children:[e.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium text-zinc-500 hover:text-zinc-700",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium bg-zinc-900 text-white rounded-lg hover:bg-zinc-800 flex items-center gap-2",children:[e.jsx(B,{size:16})," ",a?"Save Changes":"Create Product"]})]})]})]})})}function W({onClose:a,onImport:r}){const[l,c]=n.useState("");return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Import Products"}),e.jsx("button",{onClick:a,children:e.jsx(D,{size:20,className:"text-zinc-400 hover:text-zinc-600"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-2",children:"Paste JSON Array"}),e.jsx("textarea",{value:l,onChange:p=>c(p.target.value),className:"w-full h-64 p-3 border border-zinc-200 rounded-lg font-mono text-xs",placeholder:'[{"name": "Product 1", "price": 1000}, ...]'}),e.jsx("p",{className:"text-xs text-zinc-500 mt-2",children:"Required: name, price (cents). Optional: description, sku, category."})]}),e.jsxs("div",{className:"p-4 border-t border-zinc-200 flex justify-end gap-2",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm text-zinc-500",children:"Cancel"}),e.jsx("button",{onClick:()=>r(l),disabled:!l,className:"px-4 py-2 bg-zinc-900 text-white rounded-lg text-sm disabled:opacity-50",children:"Import"})]})]})})}export{oe as default};
