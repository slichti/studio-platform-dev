import{w as f,f as b}from"./chunk-JMJ3UQ3L-Dw7tS_gO.js";import{j as e}from"./vendor-puck-By1A5E5K.js";import{a as n}from"./vendor-sentry-BD1MTpLq.js";import{a as g}from"./api-OnQO3erh.js";import{U as N}from"./upload-BJQyUS3g.js";import{F as y}from"./file-text-CIWEYZv3.js";import{C as v}from"./circle-alert-Day-jl1l.js";import{C as w}from"./circle-check-big-Cgvy_36a.js";import"./createLucideIcon-DgXJrNmH.js";const R=f(function(){const{tenant:p}=b(),[r,h]=n.useState(null),[c,o]=n.useState(!1),[s,d]=n.useState(null),[m,l]=n.useState(null),u=t=>{t.target.files&&t.target.files[0]&&(h(t.target.files[0]),l(null),d(null))},j=async t=>{if(t.preventDefault(),!r){l("Please select a file.");return}o(!0),l(null),d(null);try{const i=await window.Clerk?.session?.getToken(),x=new FormData;x.append("file",r);const a=await g("/import/csv",i,{method:"POST",headers:{"X-Tenant-Slug":p.slug},body:x});a.error?(l(a.error),a.details&&console.error(a.details)):d(a)}catch(i){l(i.message||"Upload failed.")}finally{o(!1)}};return e.jsxs("div",{className:"max-w-4xl pb-10",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-zinc-900",children:"Data Import"}),e.jsx("p",{className:"text-zinc-500 mt-2",children:"Migrate your data from another system using CSV files."})]}),e.jsxs("div",{className:"bg-white border border-zinc-200 rounded-lg p-6 shadow-sm mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Import Users & Memberships"}),e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 text-blue-800 rounded text-sm",children:[e.jsx("p",{className:"font-semibold mb-1",children:"CSV Format Requirements:"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[e.jsxs("li",{children:["Headers required: ",e.jsx("code",{children:"email"}),", ",e.jsx("code",{children:"firstname"}),", ",e.jsx("code",{children:"lastname"})]}),e.jsxs("li",{children:["Optional: ",e.jsx("code",{children:"phone"}),", ",e.jsx("code",{children:"address"}),", ",e.jsx("code",{children:"dob"})," (YYYY-MM-DD), ",e.jsx("code",{children:"minor"})," (yes/no)"]}),e.jsxs("li",{children:["Membership: ",e.jsx("code",{children:"membership"})," (Plan Name - must match exactly)"]})]}),e.jsx("p",{className:"font-semibold mt-3 mb-1",children:"OR Import Classes:"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[e.jsxs("li",{children:["Headers required: ",e.jsx("code",{children:"title"}),", ",e.jsx("code",{children:"start_time"})," (ISO 8601), ",e.jsx("code",{children:"duration"})," (minutes), ",e.jsx("code",{children:"instructor_email"})]}),e.jsxs("li",{children:["Optional: ",e.jsx("code",{children:"description"}),", ",e.jsx("code",{children:"capacity"}),", ",e.jsx("code",{children:"price"}),", ",e.jsx("code",{children:"location"})," (Name)"]})]})]}),e.jsxs("form",{onSubmit:j,className:"space-y-6",children:[e.jsxs("div",{className:"border-2 border-dashed border-zinc-300 rounded-lg p-8 flex flex-col items-center justify-center text-center hover:bg-zinc-50 transition-colors",children:[e.jsx(N,{className:"h-10 w-10 text-zinc-400 mb-3"}),r?e.jsxs("div",{className:"flex items-center gap-2 text-zinc-900 font-medium",children:[e.jsx(y,{className:"h-5 w-5 text-blue-500"}),r.name]}):e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"file-upload",className:"cursor-pointer",children:[e.jsx("span",{className:"text-blue-600 font-medium hover:text-blue-500",children:"Upload a file"}),e.jsx("span",{className:"text-zinc-500",children:" or drag and drop"}),e.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",accept:".csv",onChange:u})]}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"CSV up to 10MB"})]})]}),m&&e.jsxs("div",{className:"flex items-start gap-2 bg-red-50 text-red-600 p-3 rounded",children:[e.jsx(v,{className:"h-5 w-5 shrink-0"}),e.jsx("span",{className:"text-sm",children:m})]}),s&&e.jsxs("div",{className:"bg-green-50 text-green-800 p-4 rounded border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2 font-semibold",children:[e.jsx(w,{className:"h-5 w-5"}),"Import Complete"]}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("p",{children:["Total Rows: ",s.total]}),e.jsxs("p",{children:["Created: ",s.created]}),e.jsxs("p",{children:["Skipped: ",s.skipped]}),s.errors&&s.errors.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"font-medium text-red-600",children:"Errors:"}),e.jsx("ul",{className:"list-disc pl-5 text-red-600 max-h-32 overflow-y-auto",children:s.errors.map((t,i)=>e.jsx("li",{children:t},i))})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:!r||c,className:"bg-zinc-900 text-white px-4 py-2 rounded-md font-medium text-sm hover:bg-zinc-800 disabled:opacity-50 flex items-center gap-2",children:c?"Importing...":"Start Import"})})]})]})]})});export{R as default};
