import{r as p,j as e}from"./jsx-runtime-Cs6DZD4Z.js";import{d as f}from"./index-BE8IIHCl.js";import{u as y,b,c as j,F as w}from"./components-CrqNjzMe.js";import"./browser-C3UHr21k.js";const v="http://localhost:8787";async function S(o,s,a={}){const t=new Headers(a.headers);s&&t.set("Authorization",`Bearer ${s}`),t.has("Content-Type")||t.set("Content-Type","application/json");const r=await fetch(`${v}${o}`,{...a,headers:t});if(!r.ok){const n=await r.text();throw new Error(n||r.statusText)}return r.json()}function T({onUploadComplete:o}){const{getToken:s}=f.useAuth(),[a,t]=p.useState(!1),[r,n]=p.useState(null),i=async u=>{var c;const l=(c=u.target.files)==null?void 0:c[0];if(l){t(!0);try{const d=await s(),{uploadURL:h}=await S("/uploads/image",d,{method:"POST"}),x=new FormData;x.append("file",l);const m=await fetch(h,{method:"POST",body:x});if(!m.ok)throw new Error("Failed to upload image to Cloudflare");const g=(await m.json()).result.id;o(g),n(URL.createObjectURL(l))}catch(d){console.error(d),alert("Upload failed")}finally{t(!1)}}};return e.jsxs("div",{style:{marginTop:"10px"},children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"5px"},children:"Thumbnail"}),e.jsx("input",{type:"file",accept:"image/*",onChange:i,disabled:a,style:{fontSize:"0.875rem"}}),a&&e.jsx("span",{style:{fontSize:"0.875rem",color:"#71717a",marginLeft:"10px"},children:"Uploading..."}),r&&e.jsx("div",{style:{marginTop:"10px"},children:e.jsx("img",{src:r,alt:"Preview",style:{width:"100px",height:"100px",objectFit:"cover",borderRadius:"6px"}})})]})}function U(){const{classes:o}=y(),s=b(),t=j().state==="submitting",[r,n]=p.useState(null);return e.jsxs("div",{children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"30px"},children:e.jsx("h2",{style:{fontSize:"1.875rem",fontWeight:"bold"},children:"Classes"})}),e.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",border:"1px solid #e4e4e7",marginBottom:"40px"},children:[e.jsx("h3",{style:{fontSize:"1.1rem",fontWeight:"semibold",marginBottom:"15px"},children:"Create New Class"}),e.jsxs(w,{method:"post",style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr auto",gap:"20px",alignItems:"end"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"5px"},children:"Title"}),e.jsx("input",{name:"title",required:!0,type:"text",style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d4d4d8"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"5px"},children:"Start Time"}),e.jsx("input",{name:"startTime",required:!0,type:"datetime-local",style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d4d4d8"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:"0.875rem",marginBottom:"5px"},children:"Duration (min)"}),e.jsx("input",{name:"duration",required:!0,type:"number",defaultValue:"60",style:{width:"100%",padding:"8px",borderRadius:"4px",border:"1px solid #d4d4d8"}})]}),e.jsx("input",{type:"hidden",name:"thumbnailId",value:r||""}),e.jsx("div",{style:{marginBottom:"10px"},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",fontSize:"0.875rem"},children:[e.jsx("input",{name:"createZoom",type:"checkbox"}),"Auto-create Zoom?"]})}),e.jsx("button",{disabled:t,type:"submit",style:{padding:"10px 20px",background:"#18181b",color:"white",borderRadius:"6px",border:"none",cursor:"pointer"},children:t?"Creating...":"Create Class"})]}),e.jsx("div",{style:{marginTop:"10px"},children:e.jsx(T,{onUploadComplete:i=>n(i)})}),(s==null?void 0:s.error)&&e.jsx("p",{style:{color:"red",marginTop:"10px"},children:s.error})]}),e.jsxs("div",{style:{display:"grid",gap:"15px"},children:[o.map(i=>e.jsxs("div",{style:{background:"white",padding:"20px",borderRadius:"8px",border:"1px solid #e4e4e7",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h4",{style:{fontWeight:"bold"},children:i.title}),e.jsx("p",{style:{color:"#71717a",fontSize:"0.875rem"},children:new Date(i.startTime).toLocaleString()})]}),e.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[i.zoomMeetingUrl&&e.jsx("a",{href:i.zoomMeetingUrl,target:"_blank",rel:"noreferrer",style:{fontSize:"0.875rem",color:"#2563eb"},children:"Zoom Link"}),e.jsx("a",{href:`/dashboard/classes/${i.id}/roster`,style:{fontSize:"0.875rem",textDecoration:"underline"},children:"View Roster"})]})]},i.id)),o.length===0&&e.jsx("p",{style:{color:"#71717a"},children:"No classes found."})]})]})}export{U as default};
