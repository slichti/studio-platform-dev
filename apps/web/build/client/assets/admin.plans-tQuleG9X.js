import{w as b}from"./chunk-JZWAC4HX-Cg_gv2PJ.js";import{j as e}from"./vendor-puck-D_CB0wXL.js";import{a as o}from"./api-ChCisjdG.js";import{a as c}from"./vendor-sentry-DugYw-Ne.js";import{t as d}from"./index-CNiSO0Vl.js";import{R as z}from"./refresh-cw-DnP96nUp.js";import{P as S}from"./plus-7j3qtkRM.js";import{C as P}from"./check-BLCE7Q_n.js";import{X as k}from"./x-Bbpoc0N5.js";import{c as C}from"./createLucideIcon-BOpDDQ2B.js";import{u as A}from"./chunk-OT5FTIRN-BVuv9f9K.js";import"./index-BNXeXtNe.js";import"./vendor-charts-BaZHU4KA.js";const D=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],$=C("pen-line",D),X=b(function(){const{getToken:l}=A(),[h,x]=c.useState([]),[f,y]=c.useState(!0);c.useEffect(()=>{async function t(){try{const s=await l(),n=await o("/admin/plans",s);Array.isArray(n)&&x(n)}catch(s){console.error(s),d.error("Failed to load plans")}finally{y(!1)}}t()},[l]);const j=async()=>{const t=await l();d.promise(o("/admin/plans/sync",t,{method:"POST"}),{loading:"Syncing with Stripe...",success:s=>(o("/admin/plans",t).then(n=>x(n)),`Synced ${s.synced||0} prices`),error:"Sync failed"})},g=async(t,s)=>{const n=await l();try{await o(`/admin/plans/${t}`,n,{method:"PUT",body:JSON.stringify(s)}),d.success("Plan updated"),x(p=>p.map(u=>u.id===t?{...u,...s}:u))}catch{d.error("Update failed")}},[i,m]=c.useState(null),[a,r]=c.useState({}),v=t=>{m(t.id),r({name:t.name,trialDays:t.trialDays,features:JSON.stringify(t.features||[],null,2),active:t.active})},N=async()=>{try{const t=JSON.parse(a.features);await g(i,{name:a.name,trialDays:parseInt(a.trialDays),features:t,active:a.active}),m(null)}catch{d.error("Invalid JSON for features")}},w=({active:t})=>e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${t?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t?"Active":"Inactive"});return f?e.jsx("div",{className:"p-10",children:"Loading plans..."}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-zinc-900",children:"Platform Plans"}),e.jsx("p",{className:"text-zinc-500",children:"Manage SaaS tiers, pricing, and features."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:j,className:"flex items-center gap-2 px-4 py-2 bg-white border border-zinc-200 rounded-lg hover:bg-zinc-50 text-zinc-700 font-medium transition-colors",children:[e.jsx(z,{size:16})," Sync Stripe"]}),e.jsxs("button",{className:"flex items-center gap-2 px-4 py-2 bg-zinc-900 text-white rounded-lg hover:bg-zinc-800 font-medium transition-colors",children:[e.jsx(S,{size:16})," New Plan"]})]})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-zinc-200 overflow-hidden",children:e.jsxs("table",{className:"min-w-full divide-y divide-zinc-200",children:[e.jsx("thead",{className:"bg-zinc-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Plan"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Pricing (Stripe)"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Trial"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Features"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-zinc-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-zinc-200",children:h.map(t=>e.jsxs("tr",{className:"hover:bg-zinc-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i===t.id?e.jsx("input",{value:a.name,onChange:s=>r({...a,name:s.target.value}),className:"border rounded px-2 py-1 w-full"}):e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-zinc-900",children:t.name}),e.jsx("div",{className:"text-xs text-zinc-500 font-mono",children:t.slug})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm text-zinc-900",children:["Wait: ",t.monthlyPriceCents?`$${t.monthlyPriceCents/100}/mo`:"Free"]}),e.jsxs("div",{className:"text-xs text-zinc-500",children:["Annual: ",t.annualPriceCents?`$${t.annualPriceCents/100}/yr`:"Free"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-zinc-500",children:i===t.id?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("input",{type:"number",value:a.trialDays,onChange:s=>r({...a,trialDays:s.target.value}),className:"border rounded px-2 py-1 w-16"})," days"]}):`${t.trialDays} Days`}),e.jsx("td",{className:"px-6 py-4 text-sm text-zinc-500 max-w-xs truncate",children:i===t.id?e.jsx("textarea",{value:a.features,onChange:s=>r({...a,features:s.target.value}),className:"border rounded px-2 py-1 w-full h-20 text-xs font-mono"}):e.jsxs("span",{children:[(t.features||[]).length," features configured"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:i===t.id?e.jsxs("select",{value:a.active?"true":"false",onChange:s=>r({...a,active:s.target.value==="true"}),className:"border rounded px-2 py-1",children:[e.jsx("option",{value:"true",children:"Active"}),e.jsx("option",{value:"false",children:"Inactive"})]}):e.jsx(w,{active:t.active})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:i===t.id?e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:N,className:"text-green-600 hover:text-green-900",children:e.jsx(P,{size:18})}),e.jsx("button",{onClick:()=>m(null),className:"text-zinc-400 hover:text-zinc-600",children:e.jsx(k,{size:18})})]}):e.jsx("button",{onClick:()=>v(t),className:"text-blue-600 hover:text-blue-900",children:e.jsx($,{size:18})})})]},t.id))})]})})]})});export{X as default};
