import{w as C,u as M}from"./chunk-JMJ3UQ3L-D5-P_Fux.js";import{j as e}from"./vendor-puck-Ox9nZAW8.js";import{a as s}from"./vendor-sentry-JepEA2vj.js";import{b as j,a as E,i as b,f as r}from"./vendor-date-fns-0CaSm0ev.js";function D({tenantSlug:m,apiUrl:u}){const[c,w]=s.useState([]),[N,f]=s.useState(!0),[n,v]=s.useState(new Date),[a,x]=s.useState(null),[l,p]=s.useState({name:"",email:""}),[h,i]=s.useState("idle"),[y,k]=s.useState(!1),g=u||(typeof window<"u"?window.ENV?.API_URL:"")||"https://studio-platform-api.slichti.workers.dev";if(s.useEffect(()=>{k(!0),z()},[m,n]),!y)return e.jsx("div",{className:"p-8 text-center text-zinc-400",children:"Loading..."});const z=async()=>{f(!0);try{const t=j(n).toISOString(),d=await(await fetch(`${g}/guest/schedule/${m}?start=${t}`)).json();w(d.classes||[])}catch(t){console.error("Failed to load schedule",t)}finally{f(!1)}},S=async()=>{i("submitting");try{(await fetch(`${g}/guest/booking`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({classId:a.id,tenantId:a.tenantId,guestDetails:l})})).ok?i("success"):i("error")}catch{i("error")}};return h==="success"?e.jsxs("div",{className:"p-8 text-center bg-green-50 rounded-xl",children:[e.jsx("h3",{className:"text-2xl font-bold text-green-800",children:"Booking Confirmed!"}),e.jsx("p",{className:"mt-2 text-green-700",children:"Check your email for details."}),e.jsx("button",{onClick:()=>{i("idle"),x(null)},className:"mt-6 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Book Another Class"})]}):e.jsxs("div",{className:"w-full max-w-4xl mx-auto bg-white rounded-xl shadow-sm border border-zinc-200 overflow-hidden flex flex-col md:flex-row h-[600px]",children:[e.jsxs("div",{className:"w-full md:w-1/3 bg-zinc-50 border-r border-zinc-200 p-6 flex flex-col",children:[e.jsx("h2",{className:"text-xl font-bold text-zinc-900 mb-6",children:"Select a Date"}),e.jsx("div",{className:"space-y-2",children:[0,1,2,3,4,5,6].map(t=>{const o=E(j(n),t),d=b(o,n);return e.jsxs("button",{onClick:()=>v(o),className:`w-full text-left px-4 py-3 rounded-lg transition-colors flex justify-between items-center ${d?"bg-blue-600 text-white shadow-md":"hover:bg-zinc-200 text-zinc-700"}`,children:[e.jsx("span",{className:"font-medium",children:r(o,"EEEE")}),e.jsx("span",{className:d?"text-blue-200":"text-zinc-500",children:r(o,"MMM d")})]},t)})})]}),e.jsxs("div",{className:"flex-1 p-6 overflow-y-auto bg-white",children:[e.jsxs("h2",{className:"text-xl font-bold text-zinc-900 mb-6 sticky top-0 bg-white py-2 z-10",children:["Classes for ",r(n,"MMMM do")]}),N?e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(t=>e.jsx("div",{className:"h-24 bg-zinc-100 rounded-lg"},t))}):c.filter(t=>b(new Date(t.startTime),n)).length===0?e.jsx("div",{className:"text-center py-12 text-zinc-500",children:"No classes scheduled for this day."}):e.jsx("div",{className:"space-y-4",children:c.filter(t=>b(new Date(t.startTime),n)).map(t=>e.jsx("div",{className:"group border border-zinc-200 rounded-xl p-4 hover:border-blue-300 hover:shadow-md transition-all",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-zinc-900 text-lg",children:r(new Date(t.startTime),"h:mm a")}),e.jsx("h3",{className:"text-zinc-800 font-semibold mt-1",children:t.title}),e.jsx("p",{className:"text-sm text-zinc-500 mt-1",children:t.instructor?.user?.name||t.instructor?.user?.email||"Instructor"})]}),e.jsx("button",{onClick:()=>x(t),className:"px-4 py-2 bg-white border border-zinc-300 text-zinc-700 font-medium rounded-lg hover:bg-zinc-50 group-hover:border-blue-500 group-hover:text-blue-600 transition-colors",children:"Book"})]})},t.id))})]}),a&&e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-md w-full p-6 animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-zinc-900",children:"Complete Booking"}),e.jsxs("button",{onClick:()=>x(null),className:"text-zinc-400 hover:text-zinc-600",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),e.jsxs("div",{className:"bg-zinc-50 p-4 rounded-xl mb-6",children:[e.jsx("p",{className:"font-bold text-zinc-900",children:a.title}),e.jsx("p",{className:"text-sm text-zinc-600 mt-1",children:r(new Date(a.startTime),"EEEE, MMMM do @ h:mm a")})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",value:l.name,onChange:t=>p({...l,name:t.target.value}),className:"w-full px-3 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",placeholder:"Jane Doe"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:l.email,onChange:t=>p({...l,email:t.target.value}),className:"w-full px-3 py-2 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",placeholder:"jane@example.com"})]})]}),e.jsx("div",{className:"mt-8",children:e.jsx("button",{onClick:S,disabled:!l.name||!l.email||h==="submitting",className:"w-full py-3 bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold rounded-xl shadow-sm transition-all transform active:scale-[0.98]",children:h==="submitting"?"Booking...":"Confirm Booking"})})]})})]})}const $=C(function(){const{slug:u,apiUrl:c}=M();return e.jsx("div",{className:"min-h-screen bg-transparent flex items-center justify-center p-4 font-sans",children:e.jsx(D,{tenantSlug:u,apiUrl:c})})});export{$ as default};
