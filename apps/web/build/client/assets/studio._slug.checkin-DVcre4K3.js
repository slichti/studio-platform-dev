import{w,x as y,D as C,J as S,r as i,p as e}from"./chunk-JMJ3UQ3L-Bmktta78.js";import{a as b}from"./api-piI5qlNr.js";import{A as I}from"./arrow-left-QhtN4mGD.js";import{S as L}from"./search-Bgo_ZFIj.js";import{L as A}from"./loader-circle-CKyw1K-i.js";import{C as f}from"./circle-check-D1LFFhSa.js";import{c as T}from"./createLucideIcon-dvXbGdUJ.js";import{U as j}from"./users-CQmsaxr7.js";import{U as D}from"./user-plus-Dc1J0SW5.js";import{C as R}from"./calendar-eqNgznSN.js";import{C as P}from"./circle-alert-CMcx3dHM.js";const E=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],U=T("circle",E),G=w(function(){const{classes:d,token:o}=y(),{slug:x}=C(),{roles:m}=S(),[a,u]=i.useState(null),[h,c]=i.useState([]),[z,p]=i.useState(!1),[n,N]=i.useState("");i.useEffect(()=>{a&&k(a.id)},[a]);const k=async t=>{p(!0);try{const s=await b(`/classes/${t}/bookings`,o,{headers:{"X-Tenant-Slug":x}});c(s||[])}catch{alert("Failed to load roster")}finally{p(!1)}},v=async t=>{const s=!t.checkedInAt;c(g=>g.map(r=>r.id===t.id?{...r,checkedInAt:s?new Date:null}:r));try{await b(`/classes/${a.id}/bookings/${t.id}/check-in`,o,{method:"PATCH",headers:{"X-Tenant-Slug":x},body:JSON.stringify({checkedIn:s})})}catch{alert("Check-in failed. Please try again."),c(r=>r.map(l=>l.id===t.id?{...l,checkedInAt:s?null:new Date}:l))}};if(!m.includes("instructor")&&!m.includes("owner"))return e.jsx("div",{className:"p-8 text-center",children:"Access Denied: Instructor portal only."});if(a){const t=h.filter(s=>s.user.email.toLowerCase().includes(n.toLowerCase())||JSON.stringify(s.user.profile).toLowerCase().includes(n.toLowerCase()));return e.jsxs("div",{className:"flex flex-col h-screen bg-white dark:bg-zinc-950",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 flex items-center gap-4 bg-zinc-50 dark:bg-zinc-900/50 sticky top-0 z-10",children:[e.jsx("button",{onClick:()=>u(null),className:"p-2 hover:bg-zinc-200 dark:hover:bg-zinc-800 rounded-full transition-colors",children:e.jsx(I,{size:20})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"font-bold truncate text-zinc-900 dark:text-zinc-100",children:a.title}),e.jsxs("p",{className:"text-xs text-zinc-500",children:[new Date(a.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," • ",a.location?.name||"Studio Main"]})]})]}),e.jsx("div",{className:"p-4 bg-white dark:bg-zinc-950 sticky top-[73px] z-10 border-b border-zinc-100 dark:border-zinc-800",children:e.jsxs("div",{className:"relative",children:[e.jsx(L,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-zinc-400"}),e.jsx("input",{type:"text",placeholder:"Find student...",value:n,onChange:s=>N(s.target.value),className:"w-full pl-10 pr-4 py-3 bg-zinc-100 dark:bg-zinc-900 border-none rounded-2xl text-sm focus:ring-2 focus:ring-blue-500 outline-none"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto pb-24",children:z&&h.length===0?e.jsxs("div",{className:"p-12 text-center text-zinc-400",children:[e.jsx(A,{className:"animate-spin mx-auto h-8 w-8 mb-2"}),e.jsx("p",{className:"text-sm",children:"Loading Roster..."})]}):e.jsxs("div",{className:"divide-y divide-zinc-50 dark:divide-zinc-900",children:[t.map(s=>e.jsxs("button",{onClick:()=>v(s),className:"w-full flex items-center gap-4 p-4 active:bg-zinc-50 dark:active:bg-zinc-900 transition-colors text-left group",children:[e.jsx("div",{className:"flex-shrink-0",children:s.checkedInAt?e.jsx("div",{className:"p-2 bg-emerald-100 dark:bg-emerald-900/40 text-emerald-600 rounded-full",children:e.jsx(f,{size:24})}):e.jsx("div",{className:"p-2 bg-zinc-100 dark:bg-zinc-800 text-zinc-400 rounded-full group-hover:bg-blue-50 group-hover:text-blue-500 transition-colors",children:e.jsx(U,{size:24})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"font-bold text-zinc-900 dark:text-zinc-100 truncate",children:[s.user.profile?.firstName||"Student"," ",s.user.profile?.lastName||""]}),e.jsxs("div",{className:"text-xs text-zinc-500 flex items-center gap-2 mt-0.5",children:[s.status==="confirmed"?e.jsx("span",{className:"text-emerald-500 font-bold uppercase tracking-tighter text-[9px]",children:"Reserved"}):e.jsx("span",{className:"text-amber-500 font-bold uppercase tracking-tighter text-[9px]",children:s.status}),e.jsx("span",{children:"•"}),e.jsx("span",{children:s.user.email})]})]}),e.jsx("div",{className:"flex-shrink-0",children:s.checkedInAt?e.jsxs("span",{className:"text-[10px] text-zinc-400 font-medium",children:["Checked in ",new Date(s.checkedInAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}):e.jsx("span",{className:"text-[10px] text-blue-600 font-bold bg-blue-50 dark:bg-blue-900/20 px-2 py-1 rounded",children:"CHECK IN"})})]},s.id)),t.length===0&&e.jsxs("div",{className:"p-12 text-center text-zinc-400",children:[e.jsx(j,{className:"mx-auto h-12 w-12 mb-4 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No students booked yet."}),e.jsx("p",{className:"text-xs mt-1",children:"Bookings for this class will appear here."})]})]})}),e.jsx("div",{className:"p-4 border-t border-zinc-100 dark:border-zinc-800 bg-white dark:bg-zinc-950 flex gap-4 sticky bottom-0 shadow-2xl",children:e.jsxs("button",{className:"flex-1 bg-zinc-900 dark:bg-zinc-100 dark:text-zinc-900 text-white py-4 rounded-2xl font-bold flex items-center justify-center gap-2 shadow-lg active:scale-95 transition-transform",children:[e.jsx(D,{size:20}),"Quick Add Student"]})})]})}return e.jsx("div",{className:"min-h-screen bg-zinc-50 dark:bg-zinc-950 pb-12",children:e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h1",{className:"text-3xl font-extrabold text-zinc-900 dark:text-zinc-100 flex items-center gap-2",children:[e.jsx(f,{className:"text-blue-600"})," Instructor Check-in"]}),e.jsx("p",{className:"text-sm text-zinc-500 mt-1",children:"Select today's session to start checking in students."})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.length>0?d.map(t=>e.jsxs("button",{onClick:()=>u(t),className:"bg-white dark:bg-zinc-900 p-6 rounded-2xl border border-zinc-200 dark:border-zinc-800 hover:border-blue-500 dark:hover:border-blue-500 transition-all text-left group shadow-sm flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-2 rounded-lg text-blue-600 group-hover:scale-110 transition-transform",children:e.jsx(R,{size:20})}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-zinc-400 bg-zinc-100 dark:bg-zinc-800 px-2 py-0.5 rounded",children:new Date(t.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-zinc-900 dark:text-zinc-100 group-hover:text-blue-600 transition-colors line-clamp-2 leading-tight mb-1",children:t.title}),e.jsxs("p",{className:"text-xs text-zinc-500 flex items-center gap-1.5 mt-1",children:[e.jsx(j,{size:12}),t.confirmedCount||0," students booked"]})]}),e.jsxs("div",{className:"pt-4 border-t border-zinc-100 dark:border-zinc-800 flex items-center gap-2 text-blue-600 text-xs font-bold uppercase tracking-wider",children:["Start Check-in",e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse"})]})]},t.id)):e.jsxs("div",{className:"col-span-full py-24 text-center bg-white dark:bg-zinc-900 rounded-3xl border border-zinc-200 dark:border-zinc-800 border-dashed",children:[e.jsx(P,{className:"mx-auto h-12 w-12 text-zinc-300 mb-4"}),e.jsx("h3",{className:"text-zinc-500 font-bold mb-1",children:"No Classes Today"}),e.jsx("p",{className:"text-xs text-zinc-400",children:"Enjoy your day off! Classes will appear here automatically."})]})})]})})});export{G as default};
