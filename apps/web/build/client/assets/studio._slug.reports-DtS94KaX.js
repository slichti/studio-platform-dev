import{w as le,d as ce,L as te}from"./chunk-JMJ3UQ3L-D5-P_Fux.js";import{j as e}from"./vendor-puck-Ox9nZAW8.js";import{a as o}from"./vendor-sentry-JepEA2vj.js";import{c as ne}from"./createLucideIcon-CZ3UnH4h.js";import{T as ie}from"./trash-2-BcHoghLw.js";import{S as de}from"./save-DQQgas6i.js";import{U as re}from"./users-EVjyZsvX.js";import{T}from"./trending-up-i3FuM3q7.js";import{D as H}from"./dollar-sign-BfPYFs8u.js";import{C as oe}from"./calendar-vWMk9t_Y.js";import{A as xe}from"./arrow-right-iNMGlV6d.js";import{R as X,m as me,X as B,Y as P,C as _,T as K,L as he,n as V,A as Q,c as F,d as ue}from"./vendor-charts-CBCVHb7z.js";import{a as M}from"./api-OnQO3erh.js";import{P as Y}from"./PrivacyBlur-CnAm2WrD.js";import{t as O}from"./index-Cb5OqxoU.js";import{L as pe}from"./loader-circle-CRrLibi7.js";import{D as be}from"./download-CaJLajpl.js";import{P as ge}from"./plus-CWTELB5_.js";import{M as fe}from"./mail-BspoxSMS.js";import{C as je}from"./circle-check-N5m9neNQ.js";const ve=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],ke=ne("calculator",ve);const ye=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],ze=ne("folder-open",ye);function Ne(){const[x,m]=o.useState("growth"),[i,g]=o.useState([]),[S,C]=o.useState(""),[d,$]=o.useState(!1);o.useEffect(()=>{const s=localStorage.getItem("studio_projection_scenarios");if(s)try{g(JSON.parse(s))}catch(n){console.error("Failed to load scenarios",n)}},[]);const[t,D]=o.useState({studentCount:50,avgMembershipPrice:120,avgDropInPrice:25,membershipSplit:60,classesPerDropIn:4.5,rent:2e3,payrollPerClass:40,classesPerMonth:60,otherExpenses:500,churnRate:5,growthRate:8,seasonalityResult:15,seasonalityEnabled:!1}),f=o.useMemo(()=>{const s=Math.round(t.studentCount*(t.membershipSplit/100)),n=t.studentCount-s,u=s*t.avgMembershipPrice,r=n*t.classesPerDropIn*t.avgDropInPrice,c=u+r,k=t.classesPerMonth*t.payrollPerClass,y=t.rent+k+t.otherExpenses,z=c-y,v=c>0?z/c*100:0;return{totalRevenue:c,totalExpenses:y,profit:z,margin:v,breakdown:{membershipRevenue:u,dropInRevenue:r}}},[t]),Z=o.useMemo(()=>{const s=[],n=Math.max(t.studentCount*3,200),u=Math.ceil(n/20);for(let r=0;r<=n;r+=u){const c=Math.round(r*(t.membershipSplit/100)),k=r-c,y=c*t.avgMembershipPrice+k*t.classesPerDropIn*t.avgDropInPrice,z=t.classesPerMonth*t.payrollPerClass,v=t.rent+z+t.otherExpenses;s.push({students:r,revenue:y,expenses:v,profit:y-v})}return s},[t]),j=o.useMemo(()=>{const s=[];let n=t.studentCount;const u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=new Date().getMonth();for(let c=0;c<24;c++){const k=(r+c)%12,y=u[k];let z=1;t.seasonalityEnabled&&(k===5||k===6||k===7)&&(z=1-t.seasonalityResult/100);const v=n*(t.churnRate/100),E=t.growthRate*z;n=Math.max(0,n-v+E);const I=Math.round(n*(t.membershipSplit/100)),U=n-I,L=I*t.avgMembershipPrice+U*t.classesPerDropIn*t.avgDropInPrice,W=t.classesPerMonth*t.payrollPerClass,a=t.rent+W+t.otherExpenses;s.push({month:c===0?"Now":c<=11?y:`${y} '25`,students:Math.round(n),revenue:L,expenses:a,profit:L-a})}return s},[t]),h=(s,n)=>{if(typeof n=="boolean"){D(r=>({...r,[s]:n}));return}const u=typeof n=="string"?parseFloat(n)||0:n;D(r=>({...r,[s]:u}))},w=()=>{if(!S)return;const s=[...i,{name:S,data:t}];g(s),localStorage.setItem("studio_projection_scenarios",JSON.stringify(s)),C(""),$(!1)},J=s=>{D(i[s].data)},A=s=>{const n=i.filter((u,r)=>r!==s);g(n),localStorage.setItem("studio_projection_scenarios",JSON.stringify(n))};return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 animate-in fade-in slide-in-from-bottom-4",children:[e.jsx("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm h-fit space-y-8",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-zinc-900 dark:text-zinc-100 font-bold text-lg",children:[e.jsx(ke,{className:"text-blue-600"}),e.jsx("h3",{children:"Simulator Inputs"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("button",{className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-lg text-zinc-500",children:e.jsx(ze,{size:18})}),e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-48 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg shadow-xl p-2 hidden group-hover:block z-50",children:[e.jsx("div",{className:"text-xs font-semibold text-zinc-400 px-2 py-1 mb-1",children:"LOAD SCENARIO"}),i.length===0&&e.jsx("div",{className:"px-2 py-1 text-xs text-zinc-500 italic",children:"No saved scenarios"}),i.map((s,n)=>e.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5 hover:bg-zinc-50 dark:hover:bg-zinc-800 rounded cursor-pointer group/item",children:[e.jsx("span",{onClick:()=>J(n),className:"text-sm truncate flex-1",children:s.name}),e.jsx(ie,{size:12,className:"text-red-400 opacity-0 group-hover/item:opacity-100 hover:text-red-600",onClick:u=>{u.stopPropagation(),A(n)}})]},n))]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>$(!d),className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-lg text-blue-600",children:e.jsx(de,{size:18})}),d&&e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg shadow-xl p-3 z-50",children:[e.jsx("div",{className:"text-xs font-semibold text-zinc-400 mb-2",children:"SAVE CURRENT SCENARIO"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"flex-1 min-w-0 bg-zinc-50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded px-2 py-1 text-sm",placeholder:"Scenario Name...",value:S,onChange:s=>C(s.target.value)}),e.jsx("button",{onClick:w,disabled:!S,className:"bg-blue-600 text-white px-3 py-1 rounded text-xs font-bold disabled:opacity-50",children:"Save"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-xs font-bold text-zinc-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(re,{size:14})," Current Status"]}),e.jsx(N,{label:"Total Active Students",value:t.studentCount,onChange:s=>h("studentCount",s)}),e.jsx(N,{label:"Avg. Membership Price ($)",value:t.avgMembershipPrice,onChange:s=>h("avgMembershipPrice",s)}),e.jsx(N,{label:"Avg. Drop-In Price ($)",value:t.avgDropInPrice,onChange:s=>h("avgDropInPrice",s)}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"text-sm font-medium text-zinc-700 dark:text-zinc-300 flex justify-between",children:[e.jsx("span",{children:"Membership Split"}),e.jsxs("span",{className:"text-zinc-500",children:[t.membershipSplit,"% Members"]})]}),e.jsx("input",{type:"range",min:"0",max:"100",value:t.membershipSplit,onChange:s=>h("membershipSplit",s.target.value),className:"w-full accent-blue-600"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-zinc-100 dark:border-zinc-800 space-y-4",children:[e.jsxs("h4",{className:"text-xs font-bold text-purple-500 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(T,{size:14})," Growth & Churn"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(N,{label:"New Students / Mo",value:t.growthRate,onChange:s=>h("growthRate",s)}),e.jsx(N,{label:"Churn Rate (%)",value:t.churnRate,onChange:s=>h("churnRate",s)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-zinc-50 dark:bg-zinc-800 rounded-lg border border-zinc-100 dark:border-zinc-700",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("label",{className:"text-sm font-medium text-zinc-900 dark:text-zinc-100",children:"Seasonality"}),e.jsx("div",{className:"text-xs text-zinc-500",children:"Summer slump simulation"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[t.seasonalityEnabled&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-amber-600 bg-amber-50 px-2 py-0.5 rounded-full border border-amber-100",children:["-",t.seasonalityResult,"%"]}),e.jsx("button",{onClick:()=>h("seasonalityEnabled",!t.seasonalityEnabled),className:`w-10 h-6 rounded-full transition-colors relative ${t.seasonalityEnabled?"bg-blue-600":"bg-zinc-200 dark:bg-zinc-700"}`,children:e.jsx("div",{className:`w-4 h-4 rounded-full bg-white absolute top-1 transition-transform ${t.seasonalityEnabled?"left-5":"left-1"}`})})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-zinc-100 dark:border-zinc-800 space-y-4",children:[e.jsxs("h4",{className:"text-xs font-bold text-red-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(H,{size:14})," Expenses (Monthly)"]}),e.jsx(N,{label:"Rent & Utilities",value:t.rent,onChange:s=>h("rent",s)}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(N,{label:"Pay / Class",value:t.payrollPerClass,onChange:s=>h("payrollPerClass",s)}),e.jsx(N,{label:"Classes / Mo",value:t.classesPerMonth,onChange:s=>h("classesPerMonth",s)})]}),e.jsx(N,{label:"Other Expenses",value:t.otherExpenses,onChange:s=>h("otherExpenses",s)})]})]})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"flex bg-zinc-100 dark:bg-zinc-800 p-1 rounded-lg w-fit",children:[e.jsxs("button",{onClick:()=>m("growth"),className:`px-4 py-1.5 text-sm font-medium rounded-md transition-all flex items-center gap-2 ${x==="growth"?"bg-white dark:bg-zinc-700 shadow text-zinc-900 dark:text-zinc-100":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-700"}`,children:[e.jsx(oe,{size:16}),"24-Month Forecast"]}),e.jsxs("button",{onClick:()=>m("static"),className:`px-4 py-1.5 text-sm font-medium rounded-md transition-all flex items-center gap-2 ${x==="static"?"bg-white dark:bg-zinc-700 shadow text-zinc-900 dark:text-zinc-100":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-700"}`,children:[e.jsx(T,{size:16}),"Profitability Curve"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm",children:[e.jsx("p",{className:"text-sm text-zinc-500 dark:text-zinc-400 font-medium mb-1",children:"Current Revenue"}),e.jsxs("div",{className:"text-3xl font-black text-zinc-900 dark:text-zinc-100",children:["$",f.totalRevenue.toLocaleString(void 0,{maximumFractionDigits:0}),e.jsx("span",{className:"text-sm font-normal text-zinc-400",children:"/mo"})]}),e.jsxs("div",{className:"text-xs text-zinc-500 mt-2 flex gap-2",children:["Margins: ",e.jsxs("span",{className:f.margin>20?"text-green-600":"text-zinc-600",children:[f.margin.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm",children:[e.jsx("p",{className:"text-sm text-zinc-500 dark:text-zinc-400 font-medium mb-1",children:"12-Month Outlook"}),e.jsxs("div",{className:"text-3xl font-black text-blue-600 flex items-center gap-2",children:["$",j[11].revenue.toLocaleString(void 0,{maximumFractionDigits:0}),j[11].revenue>f.totalRevenue?e.jsx(T,{size:20}):e.jsx(xe,{size:20})]}),e.jsxs("p",{className:"text-xs text-zinc-500 mt-2",children:[j[11].students," Active Students (+",j[11].students-t.studentCount,")"]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm",children:[e.jsx("p",{className:"text-sm text-zinc-500 dark:text-zinc-400 font-medium mb-1",children:"Net Income (12mo)"}),e.jsxs("div",{className:`text-3xl font-black ${j[11].profit>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[j[11].profit>=0?"+":"","$",j[11].profit.toLocaleString(void 0,{maximumFractionDigits:0})]}),e.jsxs("p",{className:"text-xs text-zinc-500 mt-2",children:["Projected for ",j[11].month]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm h-[450px]",children:[e.jsx("h3",{className:"text-lg font-bold mb-6 flex items-center gap-2",children:x==="growth"?"24-Month Growth Forecast":"Profitability Analysis"}),e.jsx(X,{width:"100%",height:"100%",minHeight:300,children:x==="growth"?e.jsxs(me,{data:j,margin:{top:10,right:30,left:10,bottom:0},children:[e.jsx(B,{dataKey:"month",tickLine:!1,axisLine:!1,tick:{fontSize:12,fill:"#71717A"}}),e.jsx(P,{yAxisId:"left",tickLine:!1,axisLine:!1,tick:{fontSize:12,fill:"#71717A"},tickFormatter:s=>`$${s/1e3}k`}),e.jsx(P,{yAxisId:"right",orientation:"right",tickLine:!1,axisLine:!1,tick:{fontSize:12,fill:"#71717A"}}),e.jsx(_,{vertical:!1,strokeDasharray:"3 3",stroke:"#E4E4E7"}),e.jsx(K,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},formatter:(s,n)=>[n==="Students"?s:`$${Number(s).toLocaleString()}`,n]}),e.jsx(he,{}),e.jsx(V,{yAxisId:"left",type:"monotone",dataKey:"revenue",name:"Revenue",stroke:"#3B82F6",strokeWidth:3,dot:!1}),e.jsx(V,{yAxisId:"left",type:"monotone",dataKey:"expenses",name:"Expenses",stroke:"#EF4444",strokeWidth:2,strokeDasharray:"5 5",dot:!1}),e.jsx(V,{yAxisId:"right",type:"monotone",dataKey:"students",name:"Students",stroke:"#8B5CF6",strokeWidth:2,dot:!1})]}):e.jsxs(Q,{data:Z,margin:{top:10,right:30,left:10,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorRevenue",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.1}),e.jsx("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorProfit",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10B981",stopOpacity:.1}),e.jsx("stop",{offset:"95%",stopColor:"#10B981",stopOpacity:0})]})]}),e.jsx(B,{dataKey:"students",tickLine:!1,axisLine:!1,tick:{fontSize:12,fill:"#71717A"},label:{value:"Number of Students",position:"insideBottomRight",offset:-10,fontSize:12,fill:"#71717A"}}),e.jsx(P,{tickLine:!1,axisLine:!1,tick:{fontSize:12,fill:"#71717A"},tickFormatter:s=>`$${s/1e3}k`}),e.jsx(_,{vertical:!1,strokeDasharray:"3 3",stroke:"#E4E4E7"}),e.jsx(K,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},formatter:s=>[`$${Number(s).toLocaleString()}`,""]}),e.jsx(F,{type:"monotone",dataKey:"revenue",name:"Revenue",stroke:"#3B82F6",fillOpacity:1,fill:"url(#colorRevenue)",strokeWidth:2}),e.jsx(F,{type:"monotone",dataKey:"expenses",name:"Expenses",stroke:"#EF4444",fill:"none",strokeWidth:2,strokeDasharray:"5 5"}),e.jsx(F,{type:"monotone",dataKey:"profit",name:"Net Profit",stroke:"#10B981",fillOpacity:1,fill:"url(#colorProfit)",strokeWidth:2}),e.jsx(ue,{x:t.studentCount,stroke:"#F59E0B",strokeDasharray:"3 3",label:{position:"top",value:"Current",fill:"#F59E0B",fontSize:12}})]})})]})]})]})}function N({label:x,value:m,onChange:i}){return e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-zinc-700 dark:text-zinc-300",children:x}),e.jsx("input",{type:"number",value:m,onChange:g=>i(g.target.value),className:"w-full px-3 py-2 bg-zinc-50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none transition-all"})]})}function we(x=!1){const[m,i]=o.useState(!1);return o.useEffect(()=>{if(typeof window<"u"){const g=localStorage.getItem("admin_show_financials")==="true";i(!g)}},[]),{isPrivacyMode:m}}const qe=le(function(){const{tenant:m}=ce(),[i,g]=o.useState("financials"),[S,C]=o.useState(!0),[d,$]=o.useState(null),[t,D]=o.useState(null),[f,Z]=o.useState("30d"),[j,h]=o.useState(!1),[w,J]=o.useState(!1),[A,s]=o.useState([]),[n,u]=o.useState(!1),[r,c]=o.useState({reportType:"revenue",frequency:"weekly",recipients:""}),[k,y]=o.useState(!1);o.useEffect(()=>{y(!!localStorage.getItem("impersonation_token"))},[]);const{isPrivacyMode:z}=we(),v=k&&z;o.useEffect(()=>{L(),w&&E()},[i,f,w]);const E=async()=>{const a=await window.Clerk?.session?.getToken();try{const l=await M("/reports/schedules",a);s(l)}catch(l){console.error("Failed to fetch schedules",l)}},I=async a=>{a.preventDefault(),u(!0);const l=await window.Clerk?.session?.getToken();try{const p=r.recipients.split(",").map(b=>b.trim()).filter(b=>!!b);await M("/reports/schedules",l,{method:"POST",body:JSON.stringify({...r,recipients:p})}),O.success("Schedule created"),E(),c({reportType:"revenue",frequency:"weekly",recipients:""})}catch(p){O.error(p.message)}finally{u(!1)}},U=async a=>{const l=await window.Clerk?.session?.getToken();try{await M(`/reports/schedules/${a}`,l,{method:"DELETE"}),O.success("Schedule deleted"),E()}catch(p){O.error(p.message)}},L=async()=>{C(!0);const a=new Date,l=new Date;f==="30d"&&l.setDate(a.getDate()-30),f==="90d"&&l.setDate(a.getDate()-90),f==="1y"&&l.setFullYear(a.getFullYear()-1);const p=await window.Clerk?.session?.getToken();try{if(i==="financials"){const b=await M(`/reports/revenue?startDate=${l.toISOString()}&endDate=${a.toISOString()}`,p);$(b)}else{const b=await M(`/reports/attendance?startDate=${l.toISOString()}&endDate=${a.toISOString()}`,p);D(b)}}catch(b){console.error("Failed to fetch report data",b)}finally{C(!1)}},W=async()=>{h(!0);const a=new Date,l=new Date;f==="30d"&&l.setDate(a.getDate()-30),f==="90d"&&l.setDate(a.getDate()-90),f==="1y"&&l.setFullYear(a.getFullYear()-1);const p=await window.Clerk?.session?.getToken();try{const q=await(await fetch(`https://studio-platform-api.slichti.workers.dev/reports/accounting/journal?format=csv&startDate=${l.toISOString()}&endDate=${a.toISOString()}`,{headers:{Authorization:`Bearer ${p}`,"X-Tenant-Slug":m.slug}})).blob(),ee=window.URL.createObjectURL(q),G=document.createElement("a");G.href=ee,G.download=`journal_${l.toISOString().split("T")[0]}_${a.toISOString().split("T")[0]}.csv`,G.click(),window.URL.revokeObjectURL(ee)}catch(b){console.error("Failed to export journal",b)}finally{h(!1)}};return S&&!d&&!t?e.jsx("div",{className:"p-8 flex justify-center",children:e.jsx(pe,{className:"animate-spin text-zinc-400"})}):e.jsxs("div",{className:"p-8 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-zinc-900 dark:text-zinc-100",children:"Analytics"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400",children:"Performance metrics and insights."})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("button",{onClick:W,disabled:j,className:"px-4 py-2 text-sm font-medium rounded-md bg-emerald-600 text-white shadow hover:bg-emerald-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[e.jsx(be,{size:16}),j?"Exporting...":"Export Journal"]}),e.jsx(te,{to:"custom",className:"px-4 py-2 text-sm font-medium rounded-md bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 shadow hover:opacity-90 transition-opacity",children:"Custom Query"}),e.jsx(te,{to:"advanced",className:"ml-2 px-4 py-2 text-sm font-medium rounded-md bg-indigo-600 text-white shadow hover:bg-indigo-700 transition-colors",children:"Advanced"}),e.jsxs("div",{className:"flex bg-zinc-100 dark:bg-zinc-800 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>g("financials"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${i==="financials"?"bg-white dark:bg-zinc-700 shadow text-zinc-900 dark:text-zinc-100":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-700"}`,children:"Financials"}),e.jsx("button",{onClick:()=>g("attendance"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${i==="attendance"?"bg-white dark:bg-zinc-700 shadow text-zinc-900 dark:text-zinc-100":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-700"}`,children:"Attendance"}),e.jsx("button",{onClick:()=>g("projections"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${i==="projections"?"bg-white dark:bg-zinc-700 shadow text-zinc-900 dark:text-zinc-100":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-700"}`,children:"Projections"})]})]})]}),e.jsxs("div",{className:"mb-8 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/10 dark:to-indigo-900/10 border border-blue-100 dark:border-blue-900/20 p-6 rounded-xl shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white dark:bg-zinc-800 rounded-lg shadow-sm",children:e.jsx(oe,{className:"text-blue-600",size:20})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-zinc-900 dark:text-zinc-100",children:"Scheduled Reports"}),e.jsx("p",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:"Automated summaries delivered to your inbox."})]})]}),e.jsx("button",{onClick:()=>J(!w),className:"text-sm font-medium text-blue-600 dark:text-blue-400 hover:underline",children:w?"Hide Management":"Manage Schedules"})]}),w&&e.jsx("div",{className:"mt-6 space-y-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-5 rounded-lg border border-zinc-200 dark:border-zinc-800 shadow-sm",children:[e.jsxs("h4",{className:"font-semibold mb-4 text-sm flex items-center gap-2",children:[e.jsx(ge,{size:16})," New Schedule"]}),e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-500 mb-1",children:"Report Type"}),e.jsxs("select",{value:r.reportType,onChange:a=>c({...r,reportType:a.target.value}),className:"w-full text-sm border rounded-md p-2 dark:bg-zinc-800",children:[e.jsx("option",{value:"revenue",children:"Revenue"}),e.jsx("option",{value:"attendance",children:"Attendance"}),e.jsx("option",{value:"journal",children:"Journal"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-500 mb-1",children:"Frequency"}),e.jsxs("select",{value:r.frequency,onChange:a=>c({...r,frequency:a.target.value}),className:"w-full text-sm border rounded-md p-2 dark:bg-zinc-800",children:[e.jsx("option",{value:"daily",children:"Daily"}),e.jsx("option",{value:"weekly",children:"Weekly"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-500 mb-1",children:"Recipients (comma separated)"}),e.jsx("input",{placeholder:"owner@example.com, manager@example.com",value:r.recipients,onChange:a=>c({...r,recipients:a.target.value}),className:"w-full text-sm border rounded-md p-2 dark:bg-zinc-800",required:!0})]}),e.jsx("button",{type:"submit",disabled:n,className:"w-full bg-blue-600 text-white rounded-md py-2 text-sm font-bold hover:bg-blue-700 disabled:opacity-50 transition-colors",children:n?"Creating...":"Create Email Schedule"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"Active Schedules"}),A.length===0?e.jsx("div",{className:"text-zinc-400 text-sm italic py-8 text-center border-2 border-dashed rounded-lg",children:"No schedules configured."}):A.map(a=>e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-3 rounded-lg border border-zinc-100 dark:border-zinc-800 flex justify-between items-center shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-zinc-50 dark:bg-zinc-800 rounded-full flex items-center justify-center text-blue-600",children:e.jsx(fe,{size:18})}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-sm font-bold capitalize",children:[a.reportType," ",a.frequency]}),e.jsx("div",{className:"text-xs text-zinc-500 truncate max-w-[200px]",children:a.recipients.join(", ")})]})]}),e.jsx("button",{onClick:()=>U(a.id),className:"p-2 text-zinc-400 hover:text-red-500 transition-colors",children:e.jsx(ie,{size:16})})]},a.id))]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[i==="financials"&&d&&e.jsxs(e.Fragment,{children:[e.jsx(R,{title:"Gross Volume (Period)",value:e.jsx(Y,{revealed:!v,placeholder:"***",children:`$${(d.grossVolume/100).toFixed(2)}`}),icon:e.jsx(H,{size:20,className:"text-green-500"})}),e.jsx(R,{title:"Monthly Recurring Revenue",value:e.jsx(Y,{revealed:!v,placeholder:"***",children:`$${(d.mrr/100).toFixed(2)}`}),subtext:"Active subscriptions snapshot",icon:e.jsx(T,{size:20,className:"text-blue-500"})}),e.jsx(R,{title:"Sales Breakdown",value:e.jsx(Y,{revealed:!v,placeholder:"***",children:`${(d.breakdown.retail/(d.grossVolume||1)*100).toFixed(0)}% Retail`}),subtext:`$${(d.breakdown.packs/100).toFixed(0)} Packs`,icon:e.jsx(H,{size:20,className:"text-purple-500"})})]}),i==="attendance"&&t&&e.jsxs(e.Fragment,{children:[e.jsx(R,{title:"Total Bookings",value:t.totalBookings,icon:e.jsx(re,{size:20,className:"text-blue-500"})}),e.jsx(R,{title:"Check-in Rate",value:`${(t.totalCheckins/(t.totalBookings||1)*100).toFixed(0)}%`,subtext:`${t.totalCheckins} Checked-in`,icon:e.jsx(je,{size:20,className:"text-green-500"})})]})]}),i==="projections"?e.jsx(Ne,{}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm relative",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:i==="financials"?"Revenue Trends":"Attendance Trends"}),v&&i==="financials"&&e.jsx("div",{className:"absolute inset-0 z-10 backdrop-blur-md bg-white/30 dark:bg-black/30 flex items-center justify-center rounded-xl",children:e.jsx("div",{className:"bg-white dark:bg-zinc-800 px-4 py-2 rounded-lg shadow lg text-sm font-medium",children:"Privacy Mode Enabled"})}),e.jsxs("div",{className:"h-80 w-full flex items-center justify-center text-zinc-400 text-sm",children:[i==="financials"&&d?.chartData?se(d.chartData)?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-2",children:"No revenue data for this period"}),e.jsx("div",{className:"text-xs text-zinc-500",children:"Record sales in POS to see trends"})]}):e.jsx(X,{width:"100%",height:"100%",children:e.jsxs(Q,{data:d.chartData,children:[e.jsx(_,{strokeDasharray:"3 3",vertical:!1,stroke:"#E4E4E7"}),e.jsx(B,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#71717A",fontSize:12},dy:10,tickFormatter:a=>ae(a)}),e.jsx(P,{axisLine:!1,tickLine:!1,tick:{fill:"#71717A",fontSize:12}}),e.jsx(K,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"},formatter:a=>[`$${Number(a).toFixed(2)}`,"Revenue"],labelFormatter:a=>new Date(a).toLocaleDateString()}),e.jsx(F,{type:"monotone",dataKey:"value",stroke:"#3B82F6",fill:"#EFF6FF",strokeWidth:2})]})}):null,i==="attendance"&&t?.chartData?se(t.chartData)?e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"mb-2",children:"No attendance data for this period"})}):e.jsx(X,{width:"100%",height:"100%",children:e.jsxs(Q,{data:t.chartData,children:[e.jsx(_,{strokeDasharray:"3 3",vertical:!1,stroke:"#E4E4E7"}),e.jsx(B,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#71717A",fontSize:12},dy:10,tickFormatter:a=>ae(a)}),e.jsx(P,{axisLine:!1,tickLine:!1,tick:{fill:"#71717A",fontSize:12}}),e.jsx(K,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"},formatter:a=>[a,"Attendees"],labelFormatter:a=>new Date(a).toLocaleDateString()}),e.jsx(F,{type:"monotone",dataKey:"value",stroke:"#10B981",fill:"#ECFDF5",strokeWidth:2})]})}):null]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm relative",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:i==="financials"?"Top Selling":"Top Classes"}),v&&i==="financials"&&e.jsx("div",{className:"absolute inset-0 z-10 backdrop-blur-md bg-white/30 dark:bg-black/30 flex items-center justify-center rounded-xl"}),i==="attendance"&&t?.topClasses&&e.jsxs("div",{className:"space-y-4",children:[t.topClasses.map((a,l)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium truncate max-w-[180px]",children:a.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 h-2 bg-zinc-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500",style:{width:`${Math.min(a.attendees/50*100,100)}%`}})}),e.jsx("span",{className:"text-xs text-zinc-500 w-6 text-right",children:a.attendees})]})]},l)),t.topClasses.length===0&&e.jsx("div",{className:"text-center text-sm text-zinc-500 py-8",children:"No data available"})]}),i==="financials"&&d?.breakdown&&e.jsxs("div",{className:"space-y-4",children:[Object.entries(d.breakdown).map(([a,l])=>{const p=Number(l);if(p===0)return null;const b=d.grossVolume||1,q=p/b*100;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium capitalize text-zinc-700 dark:text-zinc-300",children:a}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-24 h-2 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${q}%`}})}),e.jsxs("span",{className:"text-xs font-mono text-zinc-500 w-16 text-right",children:["$",(p/100).toFixed(2)]})]})]},a)}),Object.values(d.breakdown).every(a=>a===0)&&e.jsx("div",{className:"text-center text-sm text-zinc-500 py-8",children:"No specific sales data recorded."})]})]})]})]})});function R({title:x,value:m,subtext:i,icon:g}){return e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm",children:[e.jsx("div",{className:"flex justify-between items-start mb-4",children:e.jsx("div",{className:"p-2 bg-zinc-50 dark:bg-zinc-800 rounded-lg",children:g})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-zinc-500 dark:text-zinc-400 font-medium mb-1",children:x}),e.jsx("div",{className:"text-2xl font-bold text-zinc-900 dark:text-zinc-100",children:m}),i&&e.jsx("p",{className:"text-xs text-zinc-500 mt-2",children:i})]})]})}function se(x){return!x||x.length===0?!0:x.every(m=>m.value===0)}function ae(x){const m=new Date(x);return`${m.getMonth()+1}/${m.getDate()}`}export{qe as default};
