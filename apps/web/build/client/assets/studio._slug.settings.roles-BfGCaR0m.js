import{w as C,f as R}from"./chunk-JMJ3UQ3L-DsmOvVYk.js";import{j as e}from"./vendor-puck-Ox9nZAW8.js";import{a}from"./vendor-sentry-JepEA2vj.js";import{t as n}from"./index-Cb5OqxoU.js";import{a as l}from"./api-OnQO3erh.js";import{P as _}from"./plus-CWTELB5_.js";import{S as P}from"./shield-xoR-gJzw.js";import{P as E}from"./pen-BTVmGwZ4.js";import{T}from"./trash-2-BcHoghLw.js";import"./createLucideIcon-CZ3UnH4h.js";const M=[{name:"Financials",permissions:[{key:"view_financials",label:"View Financials & Reports"},{key:"manage_financials",label:"Manage Payroll & Payouts"}]},{name:"Members",permissions:[{key:"view_members",label:"View Member Profiles"},{key:"manage_members",label:"Edit Member Details & Notes"},{key:"export_data",label:"Export Data (CSV)"}]},{name:"Schedule",permissions:[{key:"view_schedule",label:"View Schedule"},{key:"manage_schedule",label:"Create/Edit Classes"},{key:"manage_bookings",label:"Manage Bookings & Check-ins"}]},{name:"Operations",permissions:[{key:"manage_waivers",label:"Manage Waivers"},{key:"manage_staff",label:"Manage Staff & Availability"},{key:"manage_roles",label:"Manage Roles & Permissions"}]},{name:"Marketing",permissions:[{key:"view_marketing",label:"View Campaigns"},{key:"manage_marketing",label:"Create Campaigns & Automations"}]},{name:"Settings",permissions:[{key:"manage_settings",label:"Manage Studio Settings"}]}],U=C(function(){const{tenant:i}=R(),[p,f]=a.useState([]),[k,j]=a.useState(!0),[v,r]=a.useState(!1),[o,h]=a.useState(null),[c,d]=a.useState(""),[g,m]=a.useState(""),[x,b]=a.useState(new Set),u=async()=>{try{const s=await window.Clerk?.session?.getToken(),t=await l("/tenant/roles",s,{headers:{"X-Tenant-Slug":i.slug}});f(t||[])}catch(s){console.error(s),n.error("Failed to load roles")}finally{j(!1)}};a.useEffect(()=>{u()},[]);const z=()=>{d(""),m(""),b(new Set),h(null),r(!0)},y=s=>{d(s.name),m(s.description||""),b(new Set(s.permissions||[])),h(s),r(!0)},N=async()=>{if(!c)return n.error("Role name is required");try{const s=await window.Clerk?.session?.getToken(),t={name:c,description:g,permissions:Array.from(x)};o?(await l(`/tenant/roles/${o.id}`,s,{method:"PUT",headers:{"X-Tenant-Slug":i.slug},body:JSON.stringify(t)}),n.success("Role updated")):(await l("/tenant/roles",s,{method:"POST",headers:{"X-Tenant-Slug":i.slug},body:JSON.stringify(t)}),n.success("Role created")),r(!1),u()}catch(s){n.error(s.message||"Failed to save role")}},w=async s=>{if(confirm("Are you sure? This will remove this role from all members."))try{const t=await window.Clerk?.session?.getToken();await l(`/tenant/roles/${s}`,t,{method:"DELETE",headers:{"X-Tenant-Slug":i.slug}}),n.success("Role deleted"),u()}catch{n.error("Failed to delete role")}},S=s=>{const t=new Set(x);t.has(s)?t.delete(s):t.add(s),b(t)};return e.jsxs("div",{className:"max-w-5xl mx-auto p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-zinc-900 dark:text-zinc-100",children:"Roles & Permissions"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400 mt-1",children:"Create custom roles to grant specific access to your team."})]}),e.jsxs("button",{onClick:z,className:"flex items-center gap-2 bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 px-4 py-2 rounded-lg font-medium hover:opacity-90 transition",children:[e.jsx(_,{size:18}),"Create Role"]})]}),k?e.jsx("div",{className:"text-center py-20 text-zinc-500",children:"Loading roles..."}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"border border-blue-100 bg-blue-50 dark:bg-blue-900/10 dark:border-blue-800 rounded-xl p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(P,{className:"text-blue-600 dark:text-blue-400 h-6 w-6"}),e.jsx("h3",{className:"text-lg font-semibold text-blue-900 dark:text-blue-100",children:"System Roles"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-blue-800 dark:text-blue-200",children:"Owner"}),e.jsx("div",{className:"text-sm text-blue-600 dark:text-blue-300",children:"Full access to everything. Cannot be restricted."})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-blue-800 dark:text-blue-200",children:"Instructor"}),e.jsx("div",{className:"text-sm text-blue-600 dark:text-blue-300",children:"Can manage their own classes, schedule, and view roster."})]})]})]}),p.map(s=>e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-6 shadow-sm hover:border-zinc-300 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-zinc-900 dark:text-zinc-100",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:s.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>y(s),className:"p-2 text-zinc-400 hover:text-zinc-900 dark:hover:text-zinc-100 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-lg transition",children:e.jsx(E,{size:16})}),e.jsx("button",{onClick:()=>w(s.id),className:"p-2 text-zinc-400 hover:text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition",children:e.jsx(T,{size:16})})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[(s.permissions||[]).slice(0,5).map(t=>e.jsx("span",{className:"px-2 py-1 bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-300 text-xs rounded border border-zinc-200 dark:border-zinc-700",children:t.replace(/_/g," ")},t)),(s.permissions?.length||0)>5&&e.jsxs("span",{className:"px-2 py-1 bg-zinc-50 text-zinc-400 text-xs rounded border border-zinc-100",children:["+",s.permissions.length-5," more"]})]})]},s.id))]}),v&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-900 w-full max-w-2xl rounded-2xl shadow-xl flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-6 border-b border-zinc-100 dark:border-zinc-800 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold",children:o?"Edit Role":"Create Custom Role"}),e.jsxs("button",{onClick:()=>r(!1),className:"p-2 hover:bg-zinc-100 rounded-full",children:[e.jsx("span",{className:"sr-only",children:"Close"}),"âœ•"]})]}),e.jsxs("div",{className:"p-6 overflow-y-auto flex-1",children:[e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Role Name"}),e.jsx("input",{type:"text",value:c,onChange:s=>d(s.target.value),className:"w-full px-3 py-2 rounded-lg border border-zinc-300 dark:border-zinc-700 bg-transparent",placeholder:"e.g. Front Desk"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("input",{type:"text",value:g,onChange:s=>m(s.target.value),className:"w-full px-3 py-2 rounded-lg border border-zinc-300 dark:border-zinc-700 bg-transparent",placeholder:"Optional description"})]})]}),e.jsx("div",{className:"space-y-6",children:M.map(s=>e.jsxs("div",{className:"border-t border-zinc-100 dark:border-zinc-800 pt-4",children:[e.jsx("h3",{className:"font-semibold text-sm text-zinc-500 uppercase tracking-wider mb-3",children:s.name}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:s.permissions.map(t=>e.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg border border-zinc-200 dark:border-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-800/50 cursor-pointer transition-colors",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 rounded border-zinc-300 text-blue-600 focus:ring-blue-500",checked:x.has(t.key),onChange:()=>S(t.key)}),e.jsx("span",{className:"text-sm font-medium",children:t.label})]},t.key))})]},s.name))})]}),e.jsxs("div",{className:"p-6 border-t border-zinc-100 dark:border-zinc-800 flex justify-end gap-3 bg-zinc-50 dark:bg-zinc-900/50 rounded-b-2xl",children:[e.jsx("button",{onClick:()=>r(!1),className:"px-4 py-2 text-sm font-medium hover:bg-zinc-200 dark:hover:bg-zinc-800 rounded-lg transition",children:"Cancel"}),e.jsx("button",{onClick:N,className:"px-6 py-2 bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 text-sm font-bold rounded-lg hover:opacity-90 transition shadow-sm",children:"Save Role"})]})]})})]})});export{U as default};
