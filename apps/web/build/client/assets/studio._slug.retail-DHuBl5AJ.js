import{w as I,u as A,f as F,h as U,i as E}from"./chunk-JMJ3UQ3L-BFmd18Yu.js";import{j as e}from"./vendor-puck-aUaaDwmz.js";import{a as n}from"./vendor-livekit-D3VpklN2.js";import{t as Q}from"./index-BFgzoDOP.js";import{C as O}from"./Dialogs-C3BiSLFk.js";import{P as S}from"./package-SoPrZSFv.js";import{U as P}from"./upload-DoKnH7Yo.js";import{P as R}from"./plus-Cj1r96us.js";import{S as T}from"./search-CmzwqIX4.js";import{S as $}from"./square-pen-BBE3RPrz.js";import{T as q}from"./trash-2-BHPWr9eo.js";import{B as M}from"./box-gWkK2vQI.js";import{X as D}from"./x-Cbj0htte.js";import{S as _}from"./save-BvwiY0_u.js";import"./Modal-RrMUvIY-.js";import"./createLucideIcon-CcD9UNCP.js";const re=I(function(){const{products:c}=A(),l=F();U();const[o,h]=n.useState(""),[m,y]=n.useState(""),[d,f]=n.useState(null),[v,x]=n.useState(!1),[N,u]=n.useState(!1),[p,g]=n.useState(null),b=[...new Set(c.map(t=>t.category).filter(Boolean))],j=c.filter(t=>!(o&&!t.name.toLowerCase().includes(o.toLowerCase())||m&&t.category!==m)),z=t=>{g(t)},k=()=>{p&&(l({intent:"delete",id:p},{method:"post"}),g(null),Q.success("Product deleted"))},r=t=>`$${(t/100).toFixed(2)}`;return e.jsxs("div",{className:"flex flex-col h-full bg-zinc-50",children:[e.jsxs("header",{className:"bg-white border-b border-zinc-200 px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-zinc-900 rounded-lg text-white",children:e.jsx(S,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-zinc-900",children:"Retail"}),e.jsxs("p",{className:"text-sm text-zinc-500",children:[c.length," products"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>u(!0),className:"px-3 py-2 border border-zinc-200 rounded-lg text-sm font-medium hover:bg-zinc-50 flex items-center gap-2",children:[e.jsx(P,{size:16})," Import"]}),e.jsxs("button",{onClick:()=>x(!0),className:"px-4 py-2 bg-zinc-900 text-white rounded-lg text-sm font-medium hover:bg-zinc-800 flex items-center gap-2",children:[e.jsx(R,{size:16})," Add Product"]})]})]}),e.jsxs("div",{className:"flex gap-4 mt-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(T,{className:"absolute left-3 top-2.5 h-4 w-4 text-zinc-400"}),e.jsx("input",{type:"text",placeholder:"Search products...",className:"w-full pl-9 pr-4 py-2 border border-zinc-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-black/5",value:o,onChange:t=>h(t.target.value)})]}),e.jsxs("select",{value:m,onChange:t=>y(t.target.value),className:"px-4 py-2 border border-zinc-200 rounded-lg text-sm outline-none focus:ring-2 focus:ring-black/5",children:[e.jsx("option",{value:"",children:"All Categories"}),b.map(t=>e.jsx("option",{value:t,children:t},t))]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:j.length===0?e.jsxs("div",{className:"text-center py-20 text-zinc-500",children:[e.jsx(S,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No products found"}),e.jsxs("div",{className:"flex gap-2 justify-center mt-4",children:[e.jsx("button",{onClick:()=>x(!0),className:"text-sm text-zinc-900 underline",children:"Add manually"}),e.jsx("span",{className:"text-zinc-300",children:"|"}),e.jsx("button",{onClick:()=>u(!0),className:"text-sm text-zinc-900 underline",children:"Import JSON"})]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:j.map(t=>e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 overflow-hidden group hover:border-zinc-300 transition",children:[e.jsxs("div",{className:"aspect-square bg-zinc-100 relative",children:[t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(S,{size:48,className:"text-zinc-300"})}),!t.isActive&&e.jsx("div",{className:"absolute top-2 left-2 px-2 py-1 bg-red-100 text-red-600 text-xs font-medium rounded",children:"Inactive"}),e.jsxs("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition flex gap-1",children:[e.jsx("button",{onClick:()=>f(t),className:"p-1.5 bg-white rounded shadow hover:bg-zinc-50",children:e.jsx($,{size:14})}),e.jsx("button",{onClick:()=>z(t.id),className:"p-1.5 bg-white rounded shadow hover:bg-red-50 text-red-500",children:e.jsx(q,{size:14})})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-zinc-900",children:t.name}),e.jsx("p",{className:"text-sm text-zinc-500",children:t.category||"Uncategorized"})]}),e.jsx("span",{className:"text-lg font-bold text-zinc-900",children:r(t.price)})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs text-zinc-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(M,{size:12})," ",t.stockQuantity," in stock"]}),t.sku&&e.jsx("span",{className:"font-mono",children:t.sku})]})]})]},t.id))})}),(d||v)&&e.jsx(B,{product:d,onClose:()=>{f(null),x(!1)},onSave:t=>{const i=new FormData;i.append("intent",d?"update":"create"),d&&i.append("id",d.id),Object.entries(t).forEach(([w,s])=>{i.append(w,String(s))}),l(i,{method:"post"}),f(null),x(!1)}}),N&&e.jsx(J,{onClose:()=>u(!1),onImport:t=>{const i=new FormData;i.append("intent","import_products"),i.append("products",t),l(i,{method:"post"}),u(!1)}}),e.jsx(O,{isOpen:!!p,onClose:()=>g(null),onConfirm:k,title:"Delete Product",message:"Are you sure you want to delete this product? This action cannot be undone.",confirmText:"Delete Product",isDestructive:!0})]})});function B({product:a,onClose:c,onSave:l}){const[o,h]=n.useState(a?.name||""),[m,y]=n.useState(a?.description||""),[d,f]=n.useState(a?.category||""),[v,x]=n.useState(a?.sku||""),[N,u]=n.useState(a?.price?(a.price/100).toFixed(2):""),[p,g]=n.useState(a?.stockQuantity?.toString()||"0"),[b,j]=n.useState(a?.imageUrl||""),[z,k]=n.useState(a?.isActive!==!1),r=E(),t=r.state!=="idle";n.useEffect(()=>{r.data&&r.data.url&&r.data.url!==b&&j(r.data.url)},[r.data]);const i=s=>{if(s.target.files&&s.target.files[0]){const C=new FormData;C.append("intent","upload_image"),C.append("file",s.target.files[0]),r.submit(C,{method:"post",encType:"multipart/form-data"})}},w=s=>{s.preventDefault(),l({name:o,description:m,category:d,sku:v,price:Math.round(parseFloat(N||"0")*100),stockQuantity:parseInt(p||"0"),imageUrl:b,isActive:z})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:a?"Edit Product":"New Product"}),e.jsx("button",{onClick:c,children:e.jsx(D,{size:20,className:"text-zinc-400 hover:text-zinc-600"})})]}),e.jsxs("form",{onSubmit:w,className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Name *"}),e.jsx("input",{type:"text",required:!0,value:o,onChange:s=>h(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg outline-none focus:ring-2 focus:ring-black/5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Price ($)"}),e.jsx("input",{type:"number",step:"0.01",value:N,onChange:s=>u(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg outline-none focus:ring-2 focus:ring-black/5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Stock"}),e.jsx("input",{type:"number",value:p,onChange:s=>g(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg outline-none focus:ring-2 focus:ring-black/5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Category"}),e.jsx("input",{type:"text",value:d,onChange:s=>f(s.target.value),placeholder:"e.g. Apparel",className:"w-full px-3 py-2 border border-zinc-200 rounded-lg outline-none focus:ring-2 focus:ring-black/5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"SKU"}),e.jsx("input",{type:"text",value:v,onChange:s=>x(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg outline-none focus:ring-2 focus:ring-black/5 font-mono"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Description"}),e.jsx("textarea",{value:m,onChange:s=>y(s.target.value),rows:3,className:"w-full px-3 py-2 border border-zinc-200 rounded-lg outline-none focus:ring-2 focus:ring-black/5 resize-none"})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Image"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"url",value:b,onChange:s=>j(s.target.value),placeholder:"https://...",className:"flex-1 px-3 py-2 border border-zinc-200 rounded-lg outline-none focus:ring-2 focus:ring-black/5"}),e.jsxs("label",{className:`px-3 py-2 border border-zinc-200 rounded-lg bg-zinc-50 hover:bg-zinc-100 cursor-pointer flex items-center gap-2 ${t?"opacity-50 pointer-events-none":""}`,children:[e.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:i,disabled:t}),e.jsx(P,{size:16,className:"text-zinc-500"}),e.jsx("span",{className:"text-sm font-medium text-zinc-600",children:t?"...":"Upload"})]})]})]}),e.jsxs("div",{className:"col-span-2 flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:"isActive",checked:z,onChange:s=>k(s.target.checked),className:"w-4 h-4"}),e.jsx("label",{htmlFor:"isActive",className:"text-sm text-zinc-700",children:"Active (visible to customers)"})]})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-3 border-t border-zinc-100",children:[e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 text-sm font-medium text-zinc-500 hover:text-zinc-700",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium bg-zinc-900 text-white rounded-lg hover:bg-zinc-800 flex items-center gap-2",children:[e.jsx(_,{size:16})," ",a?"Save Changes":"Create Product"]})]})]})]})})}function J({onClose:a,onImport:c}){const[l,o]=n.useState("");return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Import Products"}),e.jsx("button",{onClick:a,children:e.jsx(D,{size:20,className:"text-zinc-400 hover:text-zinc-600"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-2",children:"Paste JSON Array"}),e.jsx("textarea",{value:l,onChange:h=>o(h.target.value),className:"w-full h-64 p-3 border border-zinc-200 rounded-lg font-mono text-xs",placeholder:'[{"name": "Product 1", "price": 1000}, ...]'}),e.jsx("p",{className:"text-xs text-zinc-500 mt-2",children:"Required: name, price (cents). Optional: description, sku, category."})]}),e.jsxs("div",{className:"p-4 border-t border-zinc-200 flex justify-end gap-2",children:[e.jsx("button",{onClick:a,className:"px-4 py-2 text-sm text-zinc-500",children:"Cancel"}),e.jsx("button",{onClick:()=>c(l),disabled:!l,className:"px-4 py-2 bg-zinc-900 text-white rounded-lg text-sm disabled:opacity-50",children:"Import"})]})]})})}export{re as default};
