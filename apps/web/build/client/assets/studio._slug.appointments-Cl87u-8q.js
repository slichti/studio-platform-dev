import{w as k,u as C,b as T}from"./chunk-JMJ3UQ3L-DfF4BM7g.js";import{j as e}from"./vendor-puck-aUaaDwmz.js";import{a as j}from"./api-D1U4i9fn.js";import{a}from"./vendor-livekit-D3VpklN2.js";import{t as l}from"./index-BFgzoDOP.js";import{A as v}from"./arrow-left-D9bkfm0g.js";import{C as D}from"./clock-BEkBHqHW.js";import{C as B}from"./calendar-Lz5d58bs.js";import"./createLucideIcon-CcD9UNCP.js";const X=k(function(){const{services:d,slug:m,userId:N,token:x}=C(),[r,n]=a.useState("service"),[t,u]=a.useState(null),[i,h]=a.useState(null),[p,S]=a.useState([]),[w,g]=a.useState(!1),[b,y]=a.useState(new Date().toISOString().split("T")[0]);T();async function f(s,c){g(!0);try{const o=await j(`/appointments/availability?serviceId=${s.id}&date=${c}`,x,{headers:{"X-Tenant-Slug":m}});S(o.slots||[])}catch(o){console.error(o)}finally{g(!1)}}async function z(){if(!(!i||!t)){if(!N){l.error("Please login to book");return}try{const s=await j("/appointments/book",x,{method:"POST",headers:{"X-Tenant-Slug":m},body:JSON.stringify({serviceId:t.id,instructorId:i.instructorId,startTime:i.startTime})});s.error?l.error(s.error):(l.success("Booking Confirmed!"),n("service"),u(null),h(null))}catch(s){l.error("Booking failed: "+s.message)}}}return e.jsxs("div",{className:"max-w-3xl mx-auto py-8 px-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[r!=="service"&&e.jsx("button",{onClick:()=>n("service"),className:"p-2 hover:bg-zinc-100 rounded-full",children:e.jsx(v,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-2xl font-bold",children:"Book a Session"})]}),r==="service"&&e.jsxs("div",{className:"grid gap-4",children:[d.length===0&&e.jsx("p",{className:"text-zinc-500",children:"No services available."}),d.map(s=>e.jsx("div",{onClick:()=>{u(s),n("slot"),f(s,b)},className:"bg-white p-6 rounded-lg border border-zinc-200 hover:border-blue-500 cursor-pointer shadow-sm transition-all",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.title}),e.jsx("p",{className:"text-zinc-500 text-sm mt-1",children:s.description}),e.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-zinc-600",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(D,{className:"h-4 w-4"}),s.durationMinutes," min"]}),e.jsxs("div",{className:"flex items-center gap-1 font-medium",children:["$",s.price<1?"Free":s.price]})]})]}),e.jsx("div",{className:"bg-zinc-100 p-2 rounded-full",children:e.jsx(v,{className:"h-5 w-5 rotate-180 text-zinc-400"})})]})},s.id))]}),r==="slot"&&t&&e.jsxs("div",{children:[e.jsxs("div",{className:"bg-zinc-50 p-4 rounded-lg mb-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:t.title}),e.jsxs("p",{className:"text-sm text-zinc-500",children:[t.durationMinutes," mins â€¢ $",t.price]})]}),e.jsx("button",{onClick:()=>n("service"),className:"text-sm text-blue-600 hover:underline",children:"Change"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Date"}),e.jsx("input",{type:"date",value:b,min:new Date().toISOString().split("T")[0],onChange:s=>{y(s.target.value),f(t,s.target.value)},className:"border border-zinc-300 rounded px-3 py-2 w-full md:w-auto"})]}),w?e.jsx("div",{className:"text-center py-8 text-zinc-500",children:"Finding available times..."}):e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-3",children:p.length===0?e.jsx("div",{className:"col-span-full text-center py-8 text-zinc-500 bg-zinc-50 rounded-lg border border-dashed border-zinc-200",children:"No availability on this date."}):p.map((s,c)=>e.jsx("button",{onClick:()=>{h(s),n("confirm")},className:"py-2 px-4 rounded border border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100 font-medium text-sm transition-colors",children:new Date(s.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})},c))})]}),r==="confirm"&&i&&t&&e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold mb-6",children:"Confirm Booking"}),e.jsxs("div",{className:"bg-white border border-zinc-200 rounded-lg p-6 mb-6 shadow-sm",children:[e.jsxs("div",{className:"flex gap-4 mb-4 pb-4 border-b border-zinc-100",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-lg h-fit",children:e.jsx(B,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:t.title}),e.jsxs("p",{className:"text-zinc-500",children:["with ",i.instructorName]})]})]}),e.jsxs("div",{className:"grid gap-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-zinc-500",children:"Date"}),e.jsx("span",{className:"font-medium",children:new Date(i.startTime).toLocaleDateString(void 0,{weekday:"long",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-zinc-500",children:"Time"}),e.jsxs("span",{className:"font-medium",children:[new Date(i.startTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})," - ",new Date(i.endTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-zinc-500",children:"Price"}),e.jsxs("span",{className:"font-medium",children:["$",t.price]})]})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>n("slot"),className:"flex-1 py-3 border border-zinc-300 rounded-lg font-medium hover:bg-zinc-50",children:"Back"}),e.jsx("button",{onClick:z,className:"flex-1 py-3 bg-zinc-900 text-white rounded-lg font-medium hover:bg-zinc-800",children:"Confirm Booking"})]})]})]})});export{X as default};
