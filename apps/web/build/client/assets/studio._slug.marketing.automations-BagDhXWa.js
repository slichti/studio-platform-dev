import{w as I,u as $,f as D}from"./chunk-EPOLDU6W-CxxYD-cd.js";import{j as e}from"./vendor-puck-aUaaDwmz.js";import{a as n}from"./vendor-livekit-D3VpklN2.js";import{Z as b}from"./zap-CjqpxUSp.js";import{P as E}from"./plus-Cj1r96us.js";import{U as z}from"./users-7bN46dVg.js";import{C as B}from"./calendar-Lz5d58bs.js";import{T as F}from"./target-BMUiNu5f.js";import{C as y}from"./clock-BEkBHqHW.js";import{c as C}from"./createLucideIcon-CcD9UNCP.js";import{X as w}from"./x-Cbj0htte.js";import{T as S}from"./trash-2-BHPWr9eo.js";import{P as R}from"./play-BDRwBO1h.js";const U=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],L=C("bell",U);const G=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],O=C("pause",G),k=[{id:"new_member",label:"New Member Signs Up",icon:z},{id:"class_booked",label:"Class Booked",icon:B},{id:"class_missed",label:"Class No-Show",icon:F},{id:"inactive_days",label:"Inactive for X Days",icon:y},{id:"birthday",label:"Member Birthday",icon:L},{id:"membership_expiring",label:"Membership Expiring",icon:y},{id:"product_purchase",label:"Product Purchased",icon:b},{id:"subscription_canceled",label:"Subscription Canceled (Period End)",icon:w},{id:"subscription_terminated",label:"Subscription Terminated",icon:S},{id:"student_updated",label:"Student Profile Updated",icon:z}],le=I(function(){const{automations:m,stats:i}=$(),r=D(),[d,c]=n.useState(!1),o=t=>{r({intent:"toggle",id:t},{method:"post"})},u=t=>{confirm("Delete this automation?")&&r({intent:"delete",id:t},{method:"post"})};return e.jsxs("div",{className:"flex flex-col h-full bg-zinc-50",children:[e.jsx("header",{className:"bg-white border-b border-zinc-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-violet-500 to-purple-600 rounded-lg text-white",children:e.jsx(b,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-zinc-900",children:"Automations"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Set up automated email & SMS campaigns"})]})]}),e.jsxs("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-zinc-900 text-white rounded-lg text-sm font-medium hover:bg-zinc-800 flex items-center gap-2",children:[e.jsx(E,{size:16})," Create Automation"]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[i&&e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-zinc-900",children:i.totalAutomations||0}),e.jsx("div",{className:"text-xs text-zinc-500",children:"Total Automations"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.activeCount||0}),e.jsx("div",{className:"text-xs text-zinc-500",children:"Active"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.emailsSent||0}),e.jsx("div",{className:"text-xs text-zinc-500",children:"Emails Sent (30d)"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:i.smsSent||0}),e.jsx("div",{className:"text-xs text-zinc-500",children:"SMS Sent (30d)"})]})]}),m.length===0?e.jsxs("div",{className:"text-center py-20 bg-white rounded-xl border border-zinc-200",children:[e.jsx(b,{size:48,className:"mx-auto mb-4 text-zinc-300"}),e.jsx("p",{className:"text-zinc-500 mb-4",children:"No automations yet"}),e.jsx("button",{onClick:()=>c(!0),className:"text-sm text-zinc-900 underline",children:"Create your first"})]}):e.jsx("div",{className:"space-y-4",children:m.map(t=>{const a=k.find(h=>h.id===t.trigger),l=a?.icon||b;return e.jsx("div",{className:`bg-white rounded-xl border ${t.isActive?"border-green-200":"border-zinc-200"} p-5`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${t.isActive?"bg-green-100":"bg-zinc-100"}`,children:e.jsx(l,{size:24,className:t.isActive?"text-green-600":"text-zinc-400"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold text-zinc-900",children:t.name}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${t.isActive?"bg-green-100 text-green-700":"bg-zinc-100 text-zinc-500"}`,children:t.isActive?"Active":"Paused"})]}),e.jsxs("p",{className:"text-sm text-zinc-500 mt-1",children:["Trigger: ",a?.label||t.trigger]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-zinc-400",children:[e.jsxs("span",{children:["Actions: ",t.actions?.length||0]}),e.jsxs("span",{children:["Runs: ",t.runCount||0]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>o(t.id),className:`p-2 rounded-lg ${t.isActive?"hover:bg-yellow-50 text-yellow-600":"hover:bg-green-50 text-green-600"}`,title:t.isActive?"Pause":"Activate",children:t.isActive?e.jsx(O,{size:16}):e.jsx(R,{size:16})}),e.jsx("button",{onClick:()=>u(t.id),className:"p-2 hover:bg-red-50 rounded-lg text-red-500",children:e.jsx(S,{size:16})})]})]})},t.id)})})]}),d&&e.jsx(W,{onClose:()=>c(!1),onSave:t=>{const a=new FormData;a.append("intent","create");for(const l of Object.keys(t))typeof t[l]=="object"?a.append(l,JSON.stringify(t[l])):a.append(l,t[l]);r(a,{method:"post"}),c(!1)}})]})});function W({onClose:N,onSave:m}){const[i,r]=n.useState(1),[d,c]=n.useState(""),[o,u]=n.useState("new_student"),[t,a]=n.useState("all"),[l,h]=n.useState(""),[g,A]=n.useState(""),[x,v]=n.useState("simple"),[j,T]=n.useState(""),[f,M]=n.useState(""),[p,_]=n.useState(""),P=()=>{const s={name:d,trigger:o,triggerConfig:{},actions:[],isActive:!0};t==="filter"&&(s.audienceFilter={},l&&(s.audienceFilter.ageMin=parseInt(l)),g&&(s.audienceFilter.ageMax=parseInt(g))),x==="template"?(s.templateId=p,s.subject=j||"Notification",s.content="Template: "+p):(s.subject=j,s.content=f),m(s)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Create Automation"}),e.jsx("button",{onClick:N,children:e.jsx(w,{size:20,className:"text-zinc-400 hover:text-zinc-600"})})]}),e.jsxs("div",{className:"p-6",children:[i===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Automation Name"}),e.jsx("input",{type:"text",value:d,onChange:s=>c(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg",placeholder:"e.g., Welcome Series"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-2",children:"Trigger"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 h-64 overflow-y-auto",children:k.map(s=>e.jsxs("button",{onClick:()=>u(s.id),className:`p-3 rounded-lg border text-left flex items-center gap-2 ${o===s.id?"border-purple-500 bg-purple-50":"border-zinc-200 hover:bg-zinc-50"}`,children:[e.jsx(s.icon,{size:16,className:o===s.id?"text-purple-600":"text-zinc-400"}),e.jsx("span",{className:"text-sm",children:s.label})]},s.id))})]})]}),i===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium text-zinc-900",children:"Audience Targeting"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"aud",checked:t==="all",onChange:()=>a("all")}),e.jsx("span",{children:"All Members"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"aud",checked:t==="filter",onChange:()=>a("filter")}),e.jsx("span",{children:"Filtered"})]})]}),t==="filter"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-zinc-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-500 mb-1",children:"Min Age"}),e.jsx("input",{type:"number",value:l,onChange:s=>h(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg",placeholder:"18"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-500 mb-1",children:"Max Age"}),e.jsx("input",{type:"number",value:g,onChange:s=>A(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg",placeholder:"65"})]})]})]}),i===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium text-zinc-900",children:"Email Content"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Subject Line"}),e.jsx("input",{type:"text",value:j,onChange:s=>T(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg",placeholder:"Welcome!"})]}),e.jsxs("div",{className:"flex gap-4 border-b border-zinc-100 pb-2",children:[e.jsx("button",{onClick:()=>v("simple"),className:`pb-2 text-sm font-medium ${x==="simple"?"text-purple-600 border-b-2 border-purple-600":"text-zinc-500"}`,children:"Simple Text"}),e.jsx("button",{onClick:()=>v("template"),className:`pb-2 text-sm font-medium ${x==="template"?"text-purple-600 border-b-2 border-purple-600":"text-zinc-500"}`,children:"Resend Template"})]}),x==="simple"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Message Body"}),e.jsx("textarea",{value:f,onChange:s=>M(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg h-32",placeholder:"Start typing... Use {{firstName}} for variables."})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Template ID"}),e.jsx("input",{type:"text",value:p,onChange:s=>_(s.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg",placeholder:"re_123456789"}),e.jsxs("p",{className:"text-xs text-zinc-500 mt-1",children:["Variables sent: generic data + ",e.jsx("code",{children:"title"}),", ",e.jsx("code",{children:"address"}),", ",e.jsx("code",{children:"firstName"}),", ",e.jsx("code",{children:"couponCode"}),"."]})]})]})]}),e.jsxs("div",{className:"p-4 border-t border-zinc-200 flex justify-between",children:[i>1&&e.jsx("button",{onClick:()=>r(i-1),className:"px-4 py-2 text-sm text-zinc-500",children:"Back"}),i<3?e.jsx("button",{onClick:()=>r(i+1),disabled:!d&&i===1,className:"ml-auto px-4 py-2 bg-zinc-900 text-white rounded-lg text-sm disabled:opacity-50",children:"Next"}):e.jsx("button",{onClick:P,disabled:x==="simple"?!f:!p,className:"ml-auto px-4 py-2 bg-zinc-900 text-white rounded-lg text-sm disabled:opacity-50",children:"Create Automation"})]})]})})}export{le as default};
