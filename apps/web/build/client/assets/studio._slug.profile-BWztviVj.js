import{j as y,w as N,u as z}from"./chunk-JZWAC4HX-Cg_gv2PJ.js";import{j as e}from"./vendor-puck-D_CB0wXL.js";import{a as b}from"./api-ChCisjdG.js";import{a}from"./vendor-sentry-DugYw-Ne.js";import{c as v}from"./createLucideIcon-BOpDDQ2B.js";import{C as k}from"./circle-alert-BKf4ej_b.js";import{F as w}from"./file-text-BCEKkAZH.js";import{D as S}from"./download-n7hfDIUv.js";import{f as T}from"./vendor-date-fns-0CaSm0ev.js";const M=[["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M19.38 6.813A9 9 0 0 1 20.8 10.2a2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"11xh7x"}],["path",{d:"M9 12h.01",key:"157uk2"}]],F=v("baby",M);function A({token:s}){const n=y(),[r,l]=a.useState([]),[c,o]=a.useState(!1),[m,x]=a.useState(null);a.useEffect(()=>{s&&b("/users/me/family",s).then(t=>{t.family&&l(t.family)}).catch(t=>{console.error("Failed to load family",t),x("Failed to load family members")})},[s]),a.useEffect(()=>{n.data?.success&&n.data?.child&&(l(t=>[...t,n.data.child]),o(!1))},[n.data]);const[i,h]=a.useState(null);a.useEffect(()=>{s&&b("/users/session-info",s).then(h).catch(console.error)},[s]);const u=async t=>{try{const d=await b("/users/me/switch-profile",s,{method:"POST",body:JSON.stringify({targetUserId:t})});d.token?(document.cookie=`__impersonate_token=${d.token}; path=/; SameSite=Lax`,localStorage.setItem("impersonation_token",d.token),window.location.reload()):d.isSelf&&(document.cookie="__impersonate_token=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",localStorage.removeItem("impersonation_token"),window.location.reload())}catch(d){console.error(d),x(d.message||"Failed to switch profile")}};return e.jsxs("div",{className:"bg-white dark:bg-zinc-900 rounded-lg border border-zinc-200 dark:border-zinc-800 p-6 mt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-zinc-900 dark:text-zinc-100",children:"Family Members"}),e.jsx("p",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:"Manage household accounts and dependents."})]}),e.jsxs("div",{className:"flex gap-2",children:[i?.isImpersonating&&i.impersonatorId&&e.jsx("button",{onClick:()=>u(i.impersonatorId),className:"text-sm font-medium text-amber-600 dark:text-amber-400 hover:text-amber-800 dark:hover:text-amber-300 transition-colors bg-amber-50 dark:bg-amber-900/20 px-3 py-1.5 rounded-md border border-amber-200 dark:border-amber-800",children:"Back to Parent"}),e.jsx("button",{onClick:()=>o(!c),className:"text-sm font-medium text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 transition-colors",children:c?"Cancel":"+ Add Child"})]})]}),m&&e.jsx("div",{className:"p-3 mb-4 text-sm text-red-600 bg-red-50 dark:bg-red-900/20 dark:text-red-400 rounded-md border border-red-200 dark:border-red-800",children:m}),c&&e.jsxs(n.Form,{method:"post",className:"mb-6 p-4 bg-zinc-50 dark:bg-zinc-900/50 rounded-md border border-zinc-200 dark:border-zinc-800 animate-in fade-in slide-in-from-top-2",children:[e.jsx("input",{type:"hidden",name:"intent",value:"add_child"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase mb-1",children:"First Name"}),e.jsx("input",{name:"firstName",required:!0,className:"w-full px-3 py-2 bg-white dark:bg-zinc-950 border border-zinc-300 dark:border-zinc-700 rounded-md text-sm text-zinc-900 dark:text-zinc-100 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",placeholder:"e.g. Leo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase mb-1",children:"Last Name"}),e.jsx("input",{name:"lastName",required:!0,className:"w-full px-3 py-2 bg-white dark:bg-zinc-950 border border-zinc-300 dark:border-zinc-700 rounded-md text-sm text-zinc-900 dark:text-zinc-100 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all",placeholder:"e.g. Smith"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase mb-1",children:"Date of Birth"}),e.jsx("input",{name:"dob",type:"date",className:"w-full px-3 py-2 bg-white dark:bg-zinc-950 border border-zinc-300 dark:border-zinc-700 rounded-md text-sm text-zinc-900 dark:text-zinc-100 focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 outline-none transition-all"})]}),e.jsx("div",{className:"flex justify-end pt-2",children:e.jsx("button",{type:"submit",disabled:n.state==="submitting",className:"bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 px-4 py-2 text-sm font-medium rounded-md hover:bg-zinc-800 dark:hover:bg-zinc-200 disabled:opacity-50 transition-colors shadow-sm",children:n.state==="submitting"?"Adding Profile...":"Create Child Profile"})})]}),e.jsxs("div",{className:"space-y-3",children:[r.length===0&&!c&&e.jsxs("div",{className:"text-center py-8 bg-zinc-50 dark:bg-zinc-900/50 rounded-lg border border-dashed border-zinc-200 dark:border-zinc-800",children:[e.jsx(I,{className:"w-8 h-8 text-zinc-300 mx-auto mb-2"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400 text-sm",children:"No family members linked yet."})]}),r.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-zinc-100 dark:border-zinc-800 rounded-lg bg-zinc-50 dark:bg-zinc-900/30 hover:bg-zinc-100 dark:hover:bg-zinc-900/50 transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 flex items-center justify-center font-bold text-sm shadow-sm ring-1 ring-white dark:ring-zinc-800",children:t.firstName[0]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("p",{className:"font-medium text-sm text-zinc-900 dark:text-zinc-100",children:[t.firstName," ",t.lastName]}),t.memberId&&e.jsx("span",{className:"text-[10px] font-medium bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 px-1.5 py-0.5 rounded-full",children:"Member"})]}),e.jsx("div",{className:"flex items-center gap-3 mt-0.5",children:t.dob&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-zinc-500 dark:text-zinc-400",children:[e.jsx(F,{size:12}),e.jsx("span",{children:new Date(t.dob).toLocaleDateString()})]})})]})]}),e.jsx("button",{onClick:()=>u(t.userId),className:"bg-white dark:bg-black border border-zinc-200 dark:border-zinc-700 text-zinc-700 dark:text-zinc-300 px-3 py-1.5 text-xs font-medium rounded-md hover:border-blue-500 hover:text-blue-600 dark:hover:text-blue-400 transition-colors shadow-sm opacity-0 group-hover:opacity-100",children:"Switch Profile"})]},t.userId))]})]})}function I({className:s}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]})}function P({token:s,tenantSlug:n}){const[r,l]=a.useState([]),[c,o]=a.useState(!0),[m,x]=a.useState(!1),i=[{id:1,label:"Monday"},{id:2,label:"Tuesday"},{id:3,label:"Wednesday"},{id:4,label:"Thursday"},{id:5,label:"Friday"},{id:6,label:"Saturday"},{id:0,label:"Sunday"}];a.useEffect(()=>{h()},[]);async function h(){try{const t=await b("/appointments/availability/settings",s,{headers:{"X-Tenant-Slug":n}});t.availabilities&&l(t.availabilities)}catch(t){console.error("Failed to load availability",t)}finally{o(!1)}}async function u(t){t.preventDefault(),x(!0);const d=t.target,f=new FormData(d),p=Number(f.get("dayOfWeek")),g=f.get("startTime"),j=f.get("endTime");try{await b("/appointments/availability",s,{method:"POST",headers:{"X-Tenant-Slug":n},body:JSON.stringify({dayOfWeek:p,startTime:g,endTime:j})}),await h(),d.reset()}catch{alert("Failed to save")}finally{x(!1)}}return c?e.jsx("div",{children:"Loading availability..."}):e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Instructor Availability"}),e.jsx("p",{className:"text-sm text-zinc-500 mb-4",children:"Set your weekly recurring available hours for private sessions."}),e.jsxs("div",{className:"space-y-2 mb-6",children:[r.length===0&&e.jsx("p",{className:"text-sm text-zinc-400 italic",children:"No availability set."}),r.map(t=>e.jsxs("div",{className:"flex items-center justify-between bg-zinc-50 px-3 py-2 rounded text-sm",children:[e.jsx("span",{className:"font-medium text-zinc-700",children:i.find(d=>d.id===t.dayOfWeek)?.label}),e.jsxs("span",{className:"text-zinc-600",children:[t.startTime," - ",t.endTime]})]},t.id))]}),e.jsxs("form",{onSubmit:u,className:"flex gap-3 items-end border-t border-zinc-100 pt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600 mb-1",children:"Day"}),e.jsx("select",{name:"dayOfWeek",className:"text-sm border border-zinc-300 rounded px-2 py-1.5 focus:ring-2 focus:ring-blue-500 outline-none",children:i.map(t=>e.jsx("option",{value:t.id,children:t.label},t.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600 mb-1",children:"Start"}),e.jsx("input",{name:"startTime",type:"time",required:!0,className:"text-sm border border-zinc-300 rounded px-2 py-1.5"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-600 mb-1",children:"End"}),e.jsx("input",{name:"endTime",type:"time",required:!0,className:"text-sm border border-zinc-300 rounded px-2 py-1.5"})]}),e.jsx("button",{type:"submit",disabled:m,className:"bg-zinc-900 text-white px-3 py-1.5 rounded text-sm font-medium hover:bg-zinc-800 disabled:opacity-50",children:m?"Adding...":"Add Slot"})]})]})}function C({token:s,tenantSlug:n}){const[r,l]=a.useState([]),[c,o]=a.useState(!0),[m,x]=a.useState(null);return a.useEffect(()=>{o(!0),b("/commerce/invoices",s,{headers:{"X-Tenant-Slug":n}}).then(i=>{i.invoices?l(i.invoices):l([])}).catch(i=>{console.error("Failed to fetch invoices",i),x("Could not load billing history.")}).finally(()=>o(!1))},[s,n]),c?e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-6 animate-pulse",children:[e.jsx("div",{className:"h-6 w-1/3 bg-zinc-100 rounded mb-4"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 w-full bg-zinc-100 rounded"}),e.jsx("div",{className:"h-4 w-full bg-zinc-100 rounded"})]})]}):m?e.jsxs("div",{className:"bg-white rounded-lg border border-dashed border-zinc-300 p-8 text-center text-zinc-500",children:[e.jsx(k,{className:"w-8 h-8 mx-auto mb-2 text-red-400"}),e.jsx("p",{children:m})]}):r.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-6 text-center text-zinc-500",children:[e.jsx(w,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No invoices found."})]}):e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-zinc-100 bg-zinc-50/50",children:e.jsx("h3",{className:"text-lg font-semibold text-zinc-900",children:"Billing History"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"text-xs text-zinc-500 uppercase bg-zinc-50 border-b border-zinc-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 font-medium",children:"Date"}),e.jsx("th",{className:"px-6 py-3 font-medium",children:"Description"}),e.jsx("th",{className:"px-6 py-3 font-medium",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 font-medium",children:"Status"}),e.jsx("th",{className:"px-6 py-3 font-medium text-right",children:"Invoice"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-100",children:r.map(i=>e.jsxs("tr",{className:"hover:bg-zinc-50/50 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4 text-zinc-600 space-y-0.5",children:[e.jsx("div",{className:"font-medium text-zinc-900",children:T(new Date(i.date),"MMM d, yyyy")}),e.jsx("div",{className:"text-xs text-zinc-400 font-mono",children:i.number})]}),e.jsx("td",{className:"px-6 py-4 text-zinc-600",children:i.description}),e.jsx("td",{className:"px-6 py-4 font-medium text-zinc-900",children:(i.amount/100).toLocaleString("en-US",{style:"currency",currency:i.currency.toUpperCase()})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(D,{status:i.status})}),e.jsx("td",{className:"px-6 py-4 text-right",children:i.pdfUrl?e.jsxs("a",{href:i.pdfUrl,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-1.5 text-xs font-medium text-indigo-600 hover:text-indigo-700 hover:underline",children:[e.jsx(S,{className:"w-3.5 h-3.5"}),"Download"]}):e.jsx("span",{className:"text-zinc-400 text-xs italic",children:"Not available"})})]},i.id))})]})})]})}function D({status:s}){return s==="paid"?e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-50 text-green-700 ring-1 ring-inset ring-green-600/20",children:"Paid"}):s==="open"?e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-50 text-yellow-800 ring-1 ring-inset ring-yellow-600/20",children:"Due"}):s==="void"?e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-zinc-50 text-zinc-600 ring-1 ring-inset ring-zinc-500/10",children:"Void"}):s==="uncollectible"?e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-50 text-red-700 ring-1 ring-inset ring-red-600/10",children:"Failed"}):e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-zinc-100 text-zinc-600",children:s})}function L({token:s,slug:n}){const[r,l]=a.useState(null),[c,o]=a.useState(!1);a.useEffect(()=>{b("/members/me",s,{headers:{"X-Tenant-Slug":n}}).then(i=>{i.member&&l(i.member.settings||{})}).catch(console.error)},[s,n]);async function m(){if(!r)return;o(!0);const h=!(r.notifications||{}).sms;try{const u=await b("/members/me/settings",s,{method:"PATCH",headers:{"X-Tenant-Slug":n},body:JSON.stringify({notifications:{sms:h}})});u.settings&&l(u.settings)}catch{alert("Failed to update settings")}finally{o(!1)}}if(!r)return null;const x=r.notifications?.sms===!0;return e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Notifications"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-zinc-900",children:"SMS Notifications"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Receive class reminders and updates via text."})]}),e.jsx("button",{onClick:m,disabled:c,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${x?"bg-zinc-900":"bg-zinc-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${x?"translate-x-6":"translate-x-1"}`})})]})]})}const $=N(function(){const{user:n,token:r,slug:l}=z();return e.jsxs("div",{className:"max-w-2xl mx-auto py-8 px-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-zinc-900 mb-2",children:"Your Profile"}),e.jsx("p",{className:"text-zinc-500 mb-8",children:"Manage your information and family members."}),e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Personal Info"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-zinc-500 uppercase",children:"First Name"}),e.jsx("p",{className:"text-zinc-900",children:n.profile?.firstName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-zinc-500 uppercase",children:"Last Name"}),e.jsx("p",{className:"text-zinc-900",children:n.profile?.lastName})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-xs font-semibold text-zinc-500 uppercase",children:"Email"}),e.jsx("p",{className:"text-zinc-900",children:n.email})]})]})]}),e.jsx(L,{token:r,slug:l}),e.jsx("div",{className:"mb-6",children:e.jsx(C,{token:r,tenantSlug:l})}),e.jsx(P,{token:r,tenantSlug:l}),e.jsx(A,{token:r})]})});export{$ as default};
