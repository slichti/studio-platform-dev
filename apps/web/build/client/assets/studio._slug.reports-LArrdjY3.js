import{w as Ce,e as Ae,L as Ie}from"./chunk-JMJ3UQ3L-BFmd18Yu.js";import{j as e}from"./vendor-puck-aUaaDwmz.js";import{a as o}from"./vendor-livekit-D3VpklN2.js";import{c as de}from"./createLucideIcon-CcD9UNCP.js";import{T as Ee}from"./trash-2-BHPWr9eo.js";import{S as De}from"./save-BvwiY0_u.js";import{U as xe}from"./users-7bN46dVg.js";import{T as K}from"./trending-up---Y4qxta.js";import{D as Y}from"./dollar-sign-mXsRCEeh.js";import{C as Le}from"./calendar-Lz5d58bs.js";import{A as Re}from"./arrow-right-B0N7YDiS.js";import{q as X,I as me,au as ue,av as pe,aw as Oe,ax as Me,ay as Fe,az as ae,aA as $e,r as he,V as _e,aB as fe,T as Te,aC as Be,aD as Ke,P as ve,_ as We,aE as Ve,aF as Ge,aG as Je,e as Ue,c as Ye,aH as He,Z as qe,Y as Xe,aI as Ze,D as ge,aJ as se,aK as ne,$ as Qe,a0 as et,a2 as M,ac as tt,aL as at,aM as st,ab as nt,R as rt,aN as it,ao as ot,ap as H,ar as V,as as $,aq as G,at as J}from"./CartesianChart-BT5Lt7fl.js";import{S as lt,L as ct}from"./ErrorBarContext-3WiD5c6e.js";import{g as dt,b as xt,D as mt,A as q,a as _,R as ut}from"./AreaChart-BwH-uzUr.js";import{a as re}from"./api-D1U4i9fn.js";import{P as U}from"./PrivacyBlur-DQKCu4pe.js";import{L as pt}from"./loader-circle-BQZLkmRD.js";import{C as ht}from"./circle-check-Biuc9NB0.js";import"./string-0bvjYUJm.js";import"./with-selector-BB0my2KF.js";import"./with-selector-BEill6Gq.js";import"./index-7UaQKl4K.js";import"./band-CquvqAHh.js";import"./init-Dmth1JHB.js";import"./ordinal-DILIJJjt.js";import"./linear-B73P1QuO.js";import"./defaultLocale-C4B-KCzX.js";import"./time-BOCF2igb.js";const ft=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],vt=de("calculator",ft);const gt=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],bt=de("folder-open",gt);var be=(t,a,s,n)=>ue(t,"xAxis",a,n),ye=(t,a,s,n)=>pe(t,"xAxis",a,n),je=(t,a,s,n)=>ue(t,"yAxis",s,n),ke=(t,a,s,n)=>pe(t,"yAxis",s,n),yt=X([me,be,je,ye,ke],(t,a,s,n,c)=>Fe(t,"xAxis")?ae(a,n,!1):ae(s,c,!1)),jt=(t,a,s,n,c)=>c;function kt(t){return t.type==="line"}var zt=X([Me,jt],(t,a)=>t.filter(kt).find(s=>s.id===a)),Nt=X([me,be,je,ye,ke,zt,yt,Oe],(t,a,s,n,c,x,d,m)=>{var{chartData:r,dataStartIndex:h,dataEndIndex:g}=m;if(!(x==null||a==null||s==null||n==null||c==null||n.length===0||c.length===0||d==null||t!=="horizontal"&&t!=="vertical")){var{dataKey:b,data:f}=x,v;if(f!=null&&f.length>0?v=f:v=r?.slice(h,g+1),v!=null)return Vt({layout:t,xAxis:a,yAxis:s,xAxisTicks:n,yAxisTicks:c,dataKey:b,bandSize:d,displayedData:v})}}),wt=["id"],St=["type","layout","connectNulls","needClip","shape"],Pt=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function T(){return T=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var s=arguments[a];for(var n in s)({}).hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},T.apply(null,arguments)}function ie(t,a){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);a&&(n=n.filter(function(c){return Object.getOwnPropertyDescriptor(t,c).enumerable})),s.push.apply(s,n)}return s}function A(t){for(var a=1;a<arguments.length;a++){var s=arguments[a]!=null?arguments[a]:{};a%2?ie(Object(s),!0).forEach(function(n){Ct(t,n,s[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):ie(Object(s)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(s,n))})}return t}function Ct(t,a,s){return(a=At(a))in t?Object.defineProperty(t,a,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[a]=s,t}function At(t){var a=It(t,"string");return typeof a=="symbol"?a:a+""}function It(t,a){if(typeof t!="object"||!t)return t;var s=t[Symbol.toPrimitive];if(s!==void 0){var n=s.call(t,a);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function Z(t,a){if(t==null)return{};var s,n,c=Et(t,a);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(t);for(n=0;n<x.length;n++)s=x[n],a.indexOf(s)===-1&&{}.propertyIsEnumerable.call(t,s)&&(c[s]=t[s])}return c}function Et(t,a){if(t==null)return{};var s={};for(var n in t)if({}.hasOwnProperty.call(t,n)){if(a.indexOf(n)!==-1)continue;s[n]=t[n]}return s}var Dt=t=>{var{dataKey:a,name:s,stroke:n,legendType:c,hide:x}=t;return[{inactive:x,dataKey:a,type:c,color:n,value:ve(s,a),payload:t}]},Lt=o.memo(t=>{var{dataKey:a,data:s,stroke:n,strokeWidth:c,fill:x,name:d,hide:m,unit:r,tooltipType:h,id:g}=t,b={dataDefinedOnItem:s,positions:void 0,settings:{stroke:n,strokeWidth:c,fill:x,dataKey:a,nameKey:void 0,name:ve(d,a),hide:m,type:h,color:n,unit:r,graphicalItemId:g}};return o.createElement(We,{tooltipEntrySettings:b})}),ze=(t,a)=>"".concat(a,"px ").concat(t-a,"px");function Rt(t,a){for(var s=t.length%2!==0?[...t,0]:t,n=[],c=0;c<a;++c)n=[...n,...s];return n}var Ot=(t,a,s)=>{var n=s.reduce((b,f)=>b+f);if(!n)return ze(a,t);for(var c=Math.floor(t/n),x=t%n,d=a-t,m=[],r=0,h=0;r<s.length;h+=s[r],++r)if(h+s[r]>x){m=[...s.slice(0,r),x-h];break}var g=m.length%2===0?[0,d]:[d];return[...Rt(s,c),...m,...g].map(b=>"".concat(b,"px")).join(", ")};function Mt(t){var{clipPathId:a,points:s,props:n}=t,{dot:c,dataKey:x,needClip:d}=n,{id:m}=n,r=Z(n,wt),h=rt(r);return o.createElement(mt,{points:s,dot:c,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:x,baseProps:h,needClip:d,clipPathId:a})}function Ft(t){var{showLabels:a,children:s,points:n}=t,c=o.useMemo(()=>n?.map(x=>{var d,m,r={x:(d=x.x)!==null&&d!==void 0?d:0,y:(m=x.y)!==null&&m!==void 0?m:0,width:0,lowerWidth:0,upperWidth:0,height:0};return A(A({},r),{},{value:x.value,payload:x.payload,viewBox:r,parentViewBox:void 0,fill:void 0})}),[n]);return o.createElement(at,{value:a?c:void 0},s)}function oe(t){var{clipPathId:a,pathRef:s,points:n,strokeDasharray:c,props:x}=t,{type:d,layout:m,connectNulls:r,needClip:h,shape:g}=x,b=Z(x,St),f=A(A({},st(b)),{},{fill:"none",className:"recharts-line-curve",clipPath:h?"url(#clipPath-".concat(a,")"):void 0,points:n,type:d,layout:m,connectNulls:r,strokeDasharray:c??x.strokeDasharray});return o.createElement(o.Fragment,null,n?.length>1&&o.createElement(nt,T({shapeType:"curve",option:g},f,{pathRef:s})),o.createElement(Mt,{points:n,clipPathId:a,props:x}))}function $t(t){try{return t&&t.getTotalLength&&t.getTotalLength()||0}catch{return 0}}function _t(t){var{clipPathId:a,props:s,pathRef:n,previousPointsRef:c,longestAnimatedLengthRef:x}=t,{points:d,strokeDasharray:m,isAnimationActive:r,animationBegin:h,animationDuration:g,animationEasing:b,animateNewValues:f,width:v,height:k,onAnimationEnd:y,onAnimationStart:S}=s,i=c.current,l=Qe(d,"recharts-line-"),u=o.useRef(l),[p,j]=o.useState(!1),N=!p,w=o.useCallback(()=>{typeof y=="function"&&y(),j(!1)},[y]),P=o.useCallback(()=>{typeof S=="function"&&S(),j(!0)},[S]),z=$t(n.current),L=o.useRef(0);u.current!==l&&(L.current=x.current,u.current=l);var R=L.current;return o.createElement(Ft,{points:d,showLabels:N},s.children,o.createElement(et,{animationId:l,begin:h,duration:g,isActive:r,easing:b,onAnimationEnd:w,onAnimationStart:P,key:l},I=>{var B=M(R,z+R,I),O=Math.min(B,z),D;if(r)if(m){var we="".concat(m).split(/[,\s]+/gim).map(C=>parseFloat(C));D=Ot(O,z,we)}else D=ze(z,O);else D=m==null?void 0:String(m);if(I>0&&z>0&&(c.current=d,x.current=Math.max(x.current,O)),i){var Se=i.length/d.length,Q=I===1?d:d.map((C,Pe)=>{var ee=Math.floor(Pe*Se);if(i[ee]){var te=i[ee];return A(A({},C),{},{x:M(te.x,C.x,I),y:M(te.y,C.y,I)})}return f?A(A({},C),{},{x:M(v*2,C.x,I),y:M(k/2,C.y,I)}):A(A({},C),{},{x:C.x,y:C.y})});return c.current=Q,o.createElement(oe,{props:s,points:Q,clipPathId:a,pathRef:n,strokeDasharray:D})}return o.createElement(oe,{props:s,points:d,clipPathId:a,pathRef:n,strokeDasharray:D})}),o.createElement(tt,{label:s.label}))}function Tt(t){var{clipPathId:a,props:s}=t,n=o.useRef(null),c=o.useRef(0),x=o.useRef(null);return o.createElement(_t,{props:s,clipPathId:a,previousPointsRef:n,longestAnimatedLengthRef:c,pathRef:x})}var Bt=(t,a)=>{var s,n;return{x:(s=t.x)!==null&&s!==void 0?s:void 0,y:(n=t.y)!==null&&n!==void 0?n:void 0,value:t.value,errorVal:ge(t.payload,a)}};class Kt extends o.Component{render(){var{hide:a,dot:s,points:n,className:c,xAxisId:x,yAxisId:d,top:m,left:r,width:h,height:g,id:b,needClip:f,zIndex:v}=this.props;if(a)return null;var k=Ye("recharts-line",c),y=b,{r:S,strokeWidth:i}=dt(s),l=He(s),u=S*2+i,p=f?"url(#clipPath-".concat(l?"":"dots-").concat(y,")"):void 0;return o.createElement(qe,{zIndex:v},o.createElement(Xe,{className:k},f&&o.createElement("defs",null,o.createElement(Ze,{clipPathId:y,xAxisId:x,yAxisId:d}),!l&&o.createElement("clipPath",{id:"clipPath-dots-".concat(y)},o.createElement("rect",{x:r-u/2,y:m-u/2,width:h+u,height:g+u}))),o.createElement(lt,{xAxisId:x,yAxisId:d,data:n,dataPointFormatter:Bt,errorBarOffset:0},o.createElement(Tt,{props:this.props,clipPathId:y}))),o.createElement(xt,{activeDot:this.props.activeDot,points:n,mainColor:this.props.stroke,itemDataKey:this.props.dataKey,clipPath:p}))}}var Ne={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:"auto",label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:_e.line,type:"linear"};function Wt(t){var a=he(t,Ne),{activeDot:s,animateNewValues:n,animationBegin:c,animationDuration:x,animationEasing:d,connectNulls:m,dot:r,hide:h,isAnimationActive:g,label:b,legendType:f,xAxisId:v,yAxisId:k,id:y}=a,S=Z(a,Pt),{needClip:i}=Ve(v,k),l=Ge(),u=Je(),p=fe(),j=Ue(L=>Nt(L,v,k,p,y));if(u!=="horizontal"&&u!=="vertical"||j==null||l==null)return null;var{height:N,width:w,x:P,y:z}=l;return o.createElement(Kt,T({},S,{id:y,connectNulls:m,dot:r,activeDot:s,animateNewValues:n,animationBegin:c,animationDuration:x,animationEasing:d,isAnimationActive:g,hide:h,label:b,legendType:f,xAxisId:v,yAxisId:k,points:j,layout:u,height:N,width:w,left:P,top:z,needClip:i}))}function Vt(t){var{layout:a,xAxis:s,yAxis:n,xAxisTicks:c,yAxisTicks:x,dataKey:d,bandSize:m,displayedData:r}=t;return r.map((h,g)=>{var b=ge(h,d);if(a==="horizontal"){var f=se({axis:s,ticks:c,bandSize:m,entry:h,index:g}),v=ne(b)?null:n.scale(b);return{x:f,y:v,value:b,payload:h}}var k=ne(b)?null:s.scale(b),y=se({axis:n,ticks:x,bandSize:m,entry:h,index:g});return k==null||y==null?null:{x:k,y,value:b,payload:h}}).filter(Boolean)}function Gt(t){var a=he(t,Ne),s=fe();return o.createElement(Te,{id:a.id,type:"line"},n=>o.createElement(o.Fragment,null,o.createElement(Be,{legendPayload:Dt(a)}),o.createElement(Lt,{dataKey:a.dataKey,data:a.data,stroke:a.stroke,strokeWidth:a.strokeWidth,fill:a.fill,name:a.name,hide:a.hide,unit:a.unit,tooltipType:a.tooltipType,id:n}),o.createElement(Ke,{type:"line",id:n,data:a.data,xAxisId:a.xAxisId,yAxisId:a.yAxisId,zAxisId:0,dataKey:a.dataKey,hide:a.hide,isPanorama:s}),o.createElement(Wt,T({},a,{id:n}))))}var W=o.memo(Gt,$e);W.displayName="Line";var Jt=["axis"],Ut=o.forwardRef((t,a)=>o.createElement(it,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Jt,tooltipPayloadSearcher:ot,categoricalChartProps:t,ref:a}));function Yt(){const[t,a]=o.useState("growth"),[s,n]=o.useState([]),[c,x]=o.useState(""),[d,m]=o.useState(!1);o.useEffect(()=>{const i=localStorage.getItem("studio_projection_scenarios");if(i)try{n(JSON.parse(i))}catch(l){console.error("Failed to load scenarios",l)}},[]);const[r,h]=o.useState({studentCount:50,avgMembershipPrice:120,avgDropInPrice:25,membershipSplit:60,classesPerDropIn:4.5,rent:2e3,payrollPerClass:40,classesPerMonth:60,otherExpenses:500,churnRate:5,growthRate:8,seasonalityResult:15,seasonalityEnabled:!1}),g=o.useMemo(()=>{const i=Math.round(r.studentCount*(r.membershipSplit/100)),l=r.studentCount-i,u=i*r.avgMembershipPrice,p=l*r.classesPerDropIn*r.avgDropInPrice,j=u+p,N=r.classesPerMonth*r.payrollPerClass,w=r.rent+N+r.otherExpenses,P=j-w,z=j>0?P/j*100:0;return{totalRevenue:j,totalExpenses:w,profit:P,margin:z,breakdown:{membershipRevenue:u,dropInRevenue:p}}},[r]),b=o.useMemo(()=>{const i=[],l=Math.max(r.studentCount*3,200),u=Math.ceil(l/20);for(let p=0;p<=l;p+=u){const j=Math.round(p*(r.membershipSplit/100)),N=p-j,w=j*r.avgMembershipPrice+N*r.classesPerDropIn*r.avgDropInPrice,P=r.classesPerMonth*r.payrollPerClass,z=r.rent+P+r.otherExpenses;i.push({students:p,revenue:w,expenses:z,profit:w-z})}return i},[r]),f=o.useMemo(()=>{const i=[];let l=r.studentCount;const u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],p=new Date().getMonth();for(let j=0;j<24;j++){const N=(p+j)%12,w=u[N];let P=1;r.seasonalityEnabled&&(N===5||N===6||N===7)&&(P=1-r.seasonalityResult/100);const z=l*(r.churnRate/100),L=r.growthRate*P;l=Math.max(0,l-z+L);const R=Math.round(l*(r.membershipSplit/100)),I=l-R,B=R*r.avgMembershipPrice+I*r.classesPerDropIn*r.avgDropInPrice,O=r.classesPerMonth*r.payrollPerClass,D=r.rent+O+r.otherExpenses;i.push({month:j===0?"Now":j<=11?w:`${w} '25`,students:Math.round(l),revenue:B,expenses:D,profit:B-D})}return i},[r]),v=(i,l)=>{if(typeof l=="boolean"){h(p=>({...p,[i]:l}));return}const u=typeof l=="string"?parseFloat(l)||0:l;h(p=>({...p,[i]:u}))},k=()=>{if(!c)return;const i=[...s,{name:c,data:r}];n(i),localStorage.setItem("studio_projection_scenarios",JSON.stringify(i)),x(""),m(!1)},y=i=>{h(s[i].data)},S=i=>{const l=s.filter((u,p)=>p!==i);n(l),localStorage.setItem("studio_projection_scenarios",JSON.stringify(l))};return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 animate-in fade-in slide-in-from-bottom-4",children:[e.jsx("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm h-fit space-y-8",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-zinc-900 dark:text-zinc-100 font-bold text-lg",children:[e.jsx(vt,{className:"text-blue-600"}),e.jsx("h3",{children:"Simulator Inputs"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("button",{className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-lg text-zinc-500",children:e.jsx(bt,{size:18})}),e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-48 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg shadow-xl p-2 hidden group-hover:block z-50",children:[e.jsx("div",{className:"text-xs font-semibold text-zinc-400 px-2 py-1 mb-1",children:"LOAD SCENARIO"}),s.length===0&&e.jsx("div",{className:"px-2 py-1 text-xs text-zinc-500 italic",children:"No saved scenarios"}),s.map((i,l)=>e.jsxs("div",{className:"flex items-center justify-between px-2 py-1.5 hover:bg-zinc-50 dark:hover:bg-zinc-800 rounded cursor-pointer group/item",children:[e.jsx("span",{onClick:()=>y(l),className:"text-sm truncate flex-1",children:i.name}),e.jsx(Ee,{size:12,className:"text-red-400 opacity-0 group-hover/item:opacity-100 hover:text-red-600",onClick:u=>{u.stopPropagation(),S(l)}})]},l))]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>m(!d),className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-800 rounded-lg text-blue-600",children:e.jsx(De,{size:18})}),d&&e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-64 bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-700 rounded-lg shadow-xl p-3 z-50",children:[e.jsx("div",{className:"text-xs font-semibold text-zinc-400 mb-2",children:"SAVE CURRENT SCENARIO"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{className:"flex-1 min-w-0 bg-zinc-50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded px-2 py-1 text-sm",placeholder:"Scenario Name...",value:c,onChange:i=>x(i.target.value)}),e.jsx("button",{onClick:k,disabled:!c,className:"bg-blue-600 text-white px-3 py-1 rounded text-xs font-bold disabled:opacity-50",children:"Save"})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-xs font-bold text-zinc-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(xe,{size:14})," Current Status"]}),e.jsx(E,{label:"Total Active Students",value:r.studentCount,onChange:i=>v("studentCount",i)}),e.jsx(E,{label:"Avg. Membership Price ($)",value:r.avgMembershipPrice,onChange:i=>v("avgMembershipPrice",i)}),e.jsx(E,{label:"Avg. Drop-In Price ($)",value:r.avgDropInPrice,onChange:i=>v("avgDropInPrice",i)}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"text-sm font-medium text-zinc-700 dark:text-zinc-300 flex justify-between",children:[e.jsx("span",{children:"Membership Split"}),e.jsxs("span",{className:"text-zinc-500",children:[r.membershipSplit,"% Members"]})]}),e.jsx("input",{type:"range",min:"0",max:"100",value:r.membershipSplit,onChange:i=>v("membershipSplit",i.target.value),className:"w-full accent-blue-600"})]})]}),e.jsxs("div",{className:"pt-4 border-t border-zinc-100 dark:border-zinc-800 space-y-4",children:[e.jsxs("h4",{className:"text-xs font-bold text-purple-500 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(K,{size:14})," Growth & Churn"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(E,{label:"New Students / Mo",value:r.growthRate,onChange:i=>v("growthRate",i)}),e.jsx(E,{label:"Churn Rate (%)",value:r.churnRate,onChange:i=>v("churnRate",i)})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-zinc-50 dark:bg-zinc-800 rounded-lg border border-zinc-100 dark:border-zinc-700",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx("label",{className:"text-sm font-medium text-zinc-900 dark:text-zinc-100",children:"Seasonality"}),e.jsx("div",{className:"text-xs text-zinc-500",children:"Summer slump simulation"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[r.seasonalityEnabled&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-amber-600 bg-amber-50 px-2 py-0.5 rounded-full border border-amber-100",children:["-",r.seasonalityResult,"%"]}),e.jsx("button",{onClick:()=>v("seasonalityEnabled",!r.seasonalityEnabled),className:`w-10 h-6 rounded-full transition-colors relative ${r.seasonalityEnabled?"bg-blue-600":"bg-zinc-200 dark:bg-zinc-700"}`,children:e.jsx("div",{className:`w-4 h-4 rounded-full bg-white absolute top-1 transition-transform ${r.seasonalityEnabled?"left-5":"left-1"}`})})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-zinc-100 dark:border-zinc-800 space-y-4",children:[e.jsxs("h4",{className:"text-xs font-bold text-red-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx(Y,{size:14})," Expenses (Monthly)"]}),e.jsx(E,{label:"Rent & Utilities",value:r.rent,onChange:i=>v("rent",i)}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(E,{label:"Pay / Class",value:r.payrollPerClass,onChange:i=>v("payrollPerClass",i)}),e.jsx(E,{label:"Classes / Mo",value:r.classesPerMonth,onChange:i=>v("classesPerMonth",i)})]}),e.jsx(E,{label:"Other Expenses",value:r.otherExpenses,onChange:i=>v("otherExpenses",i)})]})]})]})}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"flex bg-zinc-100 dark:bg-zinc-800 p-1 rounded-lg w-fit",children:[e.jsxs("button",{onClick:()=>a("growth"),className:`px-4 py-1.5 text-sm font-medium rounded-md transition-all flex items-center gap-2 ${t==="growth"?"bg-white dark:bg-zinc-700 shadow text-zinc-900 dark:text-zinc-100":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-700"}`,children:[e.jsx(Le,{size:16}),"24-Month Forecast"]}),e.jsxs("button",{onClick:()=>a("static"),className:`px-4 py-1.5 text-sm font-medium rounded-md transition-all flex items-center gap-2 ${t==="static"?"bg-white dark:bg-zinc-700 shadow text-zinc-900 dark:text-zinc-100":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-700"}`,children:[e.jsx(K,{size:16}),"Profitability Curve"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm",children:[e.jsx("p",{className:"text-sm text-zinc-500 dark:text-zinc-400 font-medium mb-1",children:"Current Revenue"}),e.jsxs("div",{className:"text-3xl font-black text-zinc-900 dark:text-zinc-100",children:["$",g.totalRevenue.toLocaleString(void 0,{maximumFractionDigits:0}),e.jsx("span",{className:"text-sm font-normal text-zinc-400",children:"/mo"})]}),e.jsxs("div",{className:"text-xs text-zinc-500 mt-2 flex gap-2",children:["Margins: ",e.jsxs("span",{className:g.margin>20?"text-green-600":"text-zinc-600",children:[g.margin.toFixed(1),"%"]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm",children:[e.jsx("p",{className:"text-sm text-zinc-500 dark:text-zinc-400 font-medium mb-1",children:"12-Month Outlook"}),e.jsxs("div",{className:"text-3xl font-black text-blue-600 flex items-center gap-2",children:["$",f[11].revenue.toLocaleString(void 0,{maximumFractionDigits:0}),f[11].revenue>g.totalRevenue?e.jsx(K,{size:20}):e.jsx(Re,{size:20})]}),e.jsxs("p",{className:"text-xs text-zinc-500 mt-2",children:[f[11].students," Active Students (+",f[11].students-r.studentCount,")"]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm",children:[e.jsx("p",{className:"text-sm text-zinc-500 dark:text-zinc-400 font-medium mb-1",children:"Net Income (12mo)"}),e.jsxs("div",{className:`text-3xl font-black ${f[11].profit>=0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[f[11].profit>=0?"+":"","$",f[11].profit.toLocaleString(void 0,{maximumFractionDigits:0})]}),e.jsxs("p",{className:"text-xs text-zinc-500 mt-2",children:["Projected for ",f[11].month]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm h-[450px]",children:[e.jsx("h3",{className:"text-lg font-bold mb-6 flex items-center gap-2",children:t==="growth"?"24-Month Growth Forecast":"Profitability Analysis"}),e.jsx(H,{width:"100%",height:"100%",minHeight:300,children:t==="growth"?e.jsxs(Ut,{data:f,margin:{top:10,right:30,left:10,bottom:0},children:[e.jsx(V,{dataKey:"month",tickLine:!1,axisLine:!1,tick:{fontSize:12,fill:"#71717A"}}),e.jsx($,{yAxisId:"left",tickLine:!1,axisLine:!1,tick:{fontSize:12,fill:"#71717A"},tickFormatter:i=>`$${i/1e3}k`}),e.jsx($,{yAxisId:"right",orientation:"right",tickLine:!1,axisLine:!1,tick:{fontSize:12,fill:"#71717A"}}),e.jsx(G,{vertical:!1,strokeDasharray:"3 3",stroke:"#E4E4E7"}),e.jsx(J,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},formatter:(i,l)=>[l==="Students"?i:`$${Number(i).toLocaleString()}`,l]}),e.jsx(ct,{}),e.jsx(W,{yAxisId:"left",type:"monotone",dataKey:"revenue",name:"Revenue",stroke:"#3B82F6",strokeWidth:3,dot:!1}),e.jsx(W,{yAxisId:"left",type:"monotone",dataKey:"expenses",name:"Expenses",stroke:"#EF4444",strokeWidth:2,strokeDasharray:"5 5",dot:!1}),e.jsx(W,{yAxisId:"right",type:"monotone",dataKey:"students",name:"Students",stroke:"#8B5CF6",strokeWidth:2,dot:!1})]}):e.jsxs(q,{data:b,margin:{top:10,right:30,left:10,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"colorRevenue",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.1}),e.jsx("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:0})]}),e.jsxs("linearGradient",{id:"colorProfit",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10B981",stopOpacity:.1}),e.jsx("stop",{offset:"95%",stopColor:"#10B981",stopOpacity:0})]})]}),e.jsx(V,{dataKey:"students",tickLine:!1,axisLine:!1,tick:{fontSize:12,fill:"#71717A"},label:{value:"Number of Students",position:"insideBottomRight",offset:-10,fontSize:12,fill:"#71717A"}}),e.jsx($,{tickLine:!1,axisLine:!1,tick:{fontSize:12,fill:"#71717A"},tickFormatter:i=>`$${i/1e3}k`}),e.jsx(G,{vertical:!1,strokeDasharray:"3 3",stroke:"#E4E4E7"}),e.jsx(J,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgb(0 0 0 / 0.1)"},formatter:i=>[`$${Number(i).toLocaleString()}`,""]}),e.jsx(_,{type:"monotone",dataKey:"revenue",name:"Revenue",stroke:"#3B82F6",fillOpacity:1,fill:"url(#colorRevenue)",strokeWidth:2}),e.jsx(_,{type:"monotone",dataKey:"expenses",name:"Expenses",stroke:"#EF4444",fill:"none",strokeWidth:2,strokeDasharray:"5 5"}),e.jsx(_,{type:"monotone",dataKey:"profit",name:"Net Profit",stroke:"#10B981",fillOpacity:1,fill:"url(#colorProfit)",strokeWidth:2}),e.jsx(ut,{x:r.studentCount,stroke:"#F59E0B",strokeDasharray:"3 3",label:{position:"top",value:"Current",fill:"#F59E0B",fontSize:12}})]})})]})]})]})}function E({label:t,value:a,onChange:s}){return e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-sm font-medium text-zinc-700 dark:text-zinc-300",children:t}),e.jsx("input",{type:"number",value:a,onChange:n=>s(n.target.value),className:"w-full px-3 py-2 bg-zinc-50 dark:bg-zinc-800 border border-zinc-200 dark:border-zinc-700 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none transition-all"})]})}function Ht(t=!1){const[a,s]=o.useState(!1);return o.useEffect(()=>{if(typeof window<"u"){const n=localStorage.getItem("admin_show_financials")==="true";s(!n)}},[]),{isPrivacyMode:a}}const Na=Ce(function(){const{tenant:a}=Ae(),[s,n]=o.useState("financials"),[c,x]=o.useState(!0),[d,m]=o.useState(null),[r,h]=o.useState(null),[g,b]=o.useState("30d"),[f,v]=o.useState(!1);o.useEffect(()=>{v(!!localStorage.getItem("impersonation_token"))},[]);const{isPrivacyMode:k}=Ht(),y=f&&k;o.useEffect(()=>{S()},[s,g]);const S=async()=>{x(!0);const i=new Date,l=new Date;g==="30d"&&l.setDate(i.getDate()-30),g==="90d"&&l.setDate(i.getDate()-90),g==="1y"&&l.setFullYear(i.getFullYear()-1);const u=await window.Clerk?.session?.getToken();try{if(s==="financials"){const p=await re(`/reports/revenue?startDate=${l.toISOString()}&endDate=${i.toISOString()}`,u);m(p)}else{const p=await re(`/reports/attendance?startDate=${l.toISOString()}&endDate=${i.toISOString()}`,u);h(p)}}catch(p){console.error("Failed to fetch report data",p)}finally{x(!1)}};return c&&!d&&!r?e.jsx("div",{className:"p-8 flex justify-center",children:e.jsx(pt,{className:"animate-spin text-zinc-400"})}):e.jsxs("div",{className:"p-8 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-zinc-900 dark:text-zinc-100",children:"Analytics"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400",children:"Performance metrics and insights."})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(Ie,{to:"custom",className:"px-4 py-2 text-sm font-medium rounded-md bg-zinc-900 dark:bg-zinc-100 text-white dark:text-zinc-900 shadow hover:opacity-90 transition-opacity",children:"Custom Query"}),e.jsxs("div",{className:"flex bg-zinc-100 dark:bg-zinc-800 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>n("financials"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${s==="financials"?"bg-white dark:bg-zinc-700 shadow text-zinc-900 dark:text-zinc-100":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-700"}`,children:"Financials"}),e.jsx("button",{onClick:()=>n("attendance"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${s==="attendance"?"bg-white dark:bg-zinc-700 shadow text-zinc-900 dark:text-zinc-100":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-700"}`,children:"Attendance"}),e.jsx("button",{onClick:()=>n("projections"),className:`px-4 py-2 text-sm font-medium rounded-md transition-all ${s==="projections"?"bg-white dark:bg-zinc-700 shadow text-zinc-900 dark:text-zinc-100":"text-zinc-500 dark:text-zinc-400 hover:text-zinc-700"}`,children:"Projections"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[s==="financials"&&d&&e.jsxs(e.Fragment,{children:[e.jsx(F,{title:"Gross Volume (Period)",value:e.jsx(U,{revealed:!y,placeholder:"***",children:`$${(d.grossVolume/100).toFixed(2)}`}),icon:e.jsx(Y,{size:20,className:"text-green-500"})}),e.jsx(F,{title:"Monthly Recurring Revenue",value:e.jsx(U,{revealed:!y,placeholder:"***",children:`$${(d.mrr/100).toFixed(2)}`}),subtext:"Active subscriptions snapshot",icon:e.jsx(K,{size:20,className:"text-blue-500"})}),e.jsx(F,{title:"Sales Breakdown",value:e.jsx(U,{revealed:!y,placeholder:"***",children:`${(d.breakdown.retail/(d.grossVolume||1)*100).toFixed(0)}% Retail`}),subtext:`$${(d.breakdown.packs/100).toFixed(0)} Packs`,icon:e.jsx(Y,{size:20,className:"text-purple-500"})})]}),s==="attendance"&&r&&e.jsxs(e.Fragment,{children:[e.jsx(F,{title:"Total Bookings",value:r.totalBookings,icon:e.jsx(xe,{size:20,className:"text-blue-500"})}),e.jsx(F,{title:"Check-in Rate",value:`${(r.totalCheckins/(r.totalBookings||1)*100).toFixed(0)}%`,subtext:`${r.totalCheckins} Checked-in`,icon:e.jsx(ht,{size:20,className:"text-green-500"})})]})]}),s==="projections"?e.jsx(Yt,{}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm relative",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:s==="financials"?"Revenue Trends":"Attendance Trends"}),y&&s==="financials"&&e.jsx("div",{className:"absolute inset-0 z-10 backdrop-blur-md bg-white/30 dark:bg-black/30 flex items-center justify-center rounded-xl",children:e.jsx("div",{className:"bg-white dark:bg-zinc-800 px-4 py-2 rounded-lg shadow lg text-sm font-medium",children:"Privacy Mode Enabled"})}),e.jsxs("div",{className:"h-80 w-full flex items-center justify-center text-zinc-400 text-sm",children:[s==="financials"&&d?.chartData?le(d.chartData)?e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-2",children:"No revenue data for this period"}),e.jsx("div",{className:"text-xs text-zinc-500",children:"Record sales in POS to see trends"})]}):e.jsx(H,{width:"100%",height:"100%",children:e.jsxs(q,{data:d.chartData,children:[e.jsx(G,{strokeDasharray:"3 3",vertical:!1,stroke:"#E4E4E7"}),e.jsx(V,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#71717A",fontSize:12},dy:10,tickFormatter:i=>ce(i)}),e.jsx($,{axisLine:!1,tickLine:!1,tick:{fill:"#71717A",fontSize:12}}),e.jsx(J,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"},formatter:i=>[`$${Number(i).toFixed(2)}`,"Revenue"],labelFormatter:i=>new Date(i).toLocaleDateString()}),e.jsx(_,{type:"monotone",dataKey:"value",stroke:"#3B82F6",fill:"#EFF6FF",strokeWidth:2})]})}):null,s==="attendance"&&r?.chartData?le(r.chartData)?e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"mb-2",children:"No attendance data for this period"})}):e.jsx(H,{width:"100%",height:"100%",children:e.jsxs(q,{data:r.chartData,children:[e.jsx(G,{strokeDasharray:"3 3",vertical:!1,stroke:"#E4E4E7"}),e.jsx(V,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#71717A",fontSize:12},dy:10,tickFormatter:i=>ce(i)}),e.jsx($,{axisLine:!1,tickLine:!1,tick:{fill:"#71717A",fontSize:12}}),e.jsx(J,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"},formatter:i=>[i,"Attendees"],labelFormatter:i=>new Date(i).toLocaleDateString()}),e.jsx(_,{type:"monotone",dataKey:"value",stroke:"#10B981",fill:"#ECFDF5",strokeWidth:2})]})}):null]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm relative",children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:s==="financials"?"Top Selling":"Top Classes"}),y&&s==="financials"&&e.jsx("div",{className:"absolute inset-0 z-10 backdrop-blur-md bg-white/30 dark:bg-black/30 flex items-center justify-center rounded-xl"}),s==="attendance"&&r?.topClasses&&e.jsxs("div",{className:"space-y-4",children:[r.topClasses.map((i,l)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium truncate max-w-[180px]",children:i.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 h-2 bg-zinc-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500",style:{width:`${Math.min(i.attendees/50*100,100)}%`}})}),e.jsx("span",{className:"text-xs text-zinc-500 w-6 text-right",children:i.attendees})]})]},l)),r.topClasses.length===0&&e.jsx("div",{className:"text-center text-sm text-zinc-500 py-8",children:"No data available"})]}),s==="financials"&&d?.breakdown&&e.jsxs("div",{className:"space-y-4",children:[Object.entries(d.breakdown).map(([i,l])=>{const u=Number(l);if(u===0)return null;const p=d.grossVolume||1,j=u/p*100;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium capitalize text-zinc-700 dark:text-zinc-300",children:i}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-24 h-2 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500",style:{width:`${j}%`}})}),e.jsxs("span",{className:"text-xs font-mono text-zinc-500 w-16 text-right",children:["$",(u/100).toFixed(2)]})]})]},i)}),Object.values(d.breakdown).every(i=>i===0)&&e.jsx("div",{className:"text-center text-sm text-zinc-500 py-8",children:"No specific sales data recorded."})]})]})]})]})});function F({title:t,value:a,subtext:s,icon:n}){return e.jsxs("div",{className:"bg-white dark:bg-zinc-900 p-6 rounded-xl border border-zinc-200 dark:border-zinc-800 shadow-sm",children:[e.jsx("div",{className:"flex justify-between items-start mb-4",children:e.jsx("div",{className:"p-2 bg-zinc-50 dark:bg-zinc-800 rounded-lg",children:n})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-zinc-500 dark:text-zinc-400 font-medium mb-1",children:t}),e.jsx("div",{className:"text-2xl font-bold text-zinc-900 dark:text-zinc-100",children:a}),s&&e.jsx("p",{className:"text-xs text-zinc-500 mt-2",children:s})]})]})}function le(t){return!t||t.length===0?!0:t.every(a=>a.value===0)}function ce(t){const a=new Date(t);return`${a.getMonth()+1}/${a.getDate()}`}export{Na as default};
