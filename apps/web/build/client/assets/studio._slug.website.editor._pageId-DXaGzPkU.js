import{w as v,u as j,b as w,d as N}from"./chunk-JMJ3UQ3L-DR3wp0kw.js";import{j as e,P as S}from"./vendor-puck-By1A5E5K.js";import{a as z}from"./api-OnQO3erh.js";import{a as i}from"./vendor-sentry-BD1MTpLq.js";import{p as k}from"./puck-config-D34Hj8dc.js";import{t as x}from"./index-C_1Jy3MY.js";import{u as y}from"./chunk-OT5FTIRN-CmWa3m3H.js";import"./index-Xo0PvBUi.js";import{A as p}from"./arrow-left-CpQHwIrP.js";import{E as P}from"./eye-BvvqFSJ3.js";import{S as C}from"./save-f-wzAblY.js";import"./index-BwDAyMBX.js";import"./vendor-charts-CK0X_C8n.js";import"./chunk-VMBS36YX-C9jOpDEG.js";import"./runtimeEnvironment-BB2sO-19-DQnzQjGy.js";import"./chunk-6WD75OPE-Bi9DYK3s.js";import"./createLucideIcon-DgXJrNmH.js";const H=v(function(){const{page:s,error:r,slug:t}=j(),{getToken:u}=y(),o=w(),g=N(),[n,c]=i.useState(!1),[l,h]=i.useState(null),[d,f]=i.useState(s?.content||{root:{props:{}},content:[]}),m=async b=>{c(!0);try{const a=await u();await z(`/website/pages/${g.pageId}`,a,{method:"PUT",headers:{"X-Tenant-Slug":t},body:JSON.stringify({content:b})}),h(new Date),x.success("Page saved")}catch(a){x.error("Failed to save: "+a.message)}finally{c(!1)}};return r?e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg",children:["Error: ",r]}),e.jsxs("button",{onClick:()=>o(`/studio/${t}/website/pages`),className:"mt-4 text-blue-600 hover:underline flex items-center gap-2",children:[e.jsx(p,{size:16})," Back to Pages"]})]}):e.jsxs("div",{className:"h-screen flex flex-col",children:[e.jsxs("div",{className:"bg-white border-b border-zinc-200 px-4 py-3 flex items-center justify-between z-50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>o(`/studio/${t}/website/pages`),className:"flex items-center gap-2 text-zinc-600 hover:text-zinc-900",children:[e.jsx(p,{size:18}),e.jsx("span",{className:"text-sm",children:"Back"})]}),e.jsx("div",{className:"h-6 w-px bg-zinc-200"}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-medium text-zinc-900",children:s?.title}),e.jsxs("p",{className:"text-xs text-zinc-500",children:["/",s?.slug]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[l&&e.jsxs("span",{className:"text-xs text-zinc-400",children:["Saved ",l.toLocaleTimeString()]}),e.jsxs("button",{onClick:()=>window.open(`/site/${t}/${s?.slug}`,"_blank"),className:"flex items-center gap-2 px-3 py-1.5 text-sm text-zinc-600 hover:bg-zinc-100 rounded-lg",children:[e.jsx(P,{size:16}),"Preview"]}),e.jsxs("button",{onClick:()=>m(d),disabled:n,className:"flex items-center gap-2 px-4 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(C,{size:16}),n?"Saving...":"Save"]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(S,{config:k,data:d,onPublish:m,onChange:f})})]})});export{H as default};
