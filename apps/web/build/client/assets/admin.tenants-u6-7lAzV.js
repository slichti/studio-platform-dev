import{w as ps,u as bs,b as hs,L as gs}from"./chunk-JZWAC4HX-Cg_gv2PJ.js";import{j as e}from"./vendor-puck-D_CB0wXL.js";import{a as c,A as fs}from"./api-ChCisjdG.js";import{a}from"./vendor-sentry-DugYw-Ne.js";import{M as C}from"./Modal-D1QwNVP6.js";import{E as js,C as q}from"./Dialogs-3wFUFLtR.js";import{P as ys}from"./PrivacyBlur-C1P7xzcg.js";import{X as vs}from"./x-Bbpoc0N5.js";import{L as Ns}from"./loader-circle-DYdrNEzV.js";import{c as Ne}from"./createLucideIcon-BOpDDQ2B.js";import{D as zs}from"./download-n7hfDIUv.js";import{u as ht}from"./chunk-OT5FTIRN-BVuv9f9K.js";import{T as Ge}from"./triangle-alert-D-FhYK0e.js";import{A as G}from"./activity-C3dHyf29.js";import{S as ws}from"./smartphone-Dzgf_AGk.js";import{G as ks}from"./globe-B06hed9d.js";import{M as Ss}from"./messages-square-Bzy0mBGX.js";import{C as mt}from"./credit-card-DLBXRPDY.js";import{V as Cs}from"./video-CVMUcJJa.js";import{S as Os}from"./shopping-cart-MI4rn_wV.js";import{M as Ts}from"./message-square-DTFkDR1q.js";import{M as Ps}from"./mail-CN8bGPSX.js";import{C as As}from"./chevron-down-vKXUNxJK.js";import{C as Es}from"./chevron-right-Chwzro3y.js";import{B as Ds}from"./bell-C98WhqnS.js";import{S as $s}from"./settings-Bx0CIaKD.js";import"./index-BNXeXtNe.js";import"./vendor-charts-BaZHU4KA.js";const Ms=[["path",{d:"m10 17 5-5-5-5",key:"1bsop3"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}]],Is=Ne("log-in",Ms);const Ls=[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]],Rs=Ne("monitor",Ls);const Us=[["path",{d:"M21 10.656V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h12.344",key:"2acyp4"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],pt=Ne("square-check-big",Us);const Fs=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],bt=Ne("square",Fs),_s={subscribers:{title:"Subscribers",endpoint:"subscribers",columns:[{key:"email",label:"Email"},{key:"firstName",label:"First Name"},{key:"lastName",label:"Last Name"},{key:"roles",label:"Roles"},{key:"status",label:"Status"},{key:"joinedAt",label:"Joined"}]},financials:{title:"Financial Transactions",endpoint:"transactions",columns:[{key:"memberEmail",label:"Member Email"},{key:"memberName",label:"Member Name"},{key:"planName",label:"Plan"},{key:"amount",label:"Amount"},{key:"status",label:"Status"},{key:"createdAt",label:"Date"}]},products:{title:"Products",endpoint:"products",columns:[{key:"sku",label:"SKU"},{key:"name",label:"Name"},{key:"price",label:"Price"},{key:"quantity",label:"Qty"},{key:"category",label:"Category"},{key:"isActive",label:"Active"}]}};function qs({isOpen:Q,onClose:X,tenantId:K,tenantName:h,dataType:y}){const[k,E]=a.useState([]),[d,u]=a.useState(new Set),[I,V]=a.useState(!1),[ee,O]=a.useState(null),{getToken:l}=ht(),g=_s[y];a.useEffect(()=>{Q?S():(E([]),u(new Set),O(null))},[Q,K,y]);const S=async()=>{V(!0),O(null);try{const m=await l(),v=await c(`/admin/tenants/${K}/${g.endpoint}`,m);E(v)}catch(m){O(m.message)}finally{V(!1)}},L=m=>{const v=new Set(d);v.has(m)?v.delete(m):v.add(m),u(v)},te=()=>{d.size===k.length?u(new Set):u(new Set(k.map(m=>m.id)))},R=()=>{const m=k.filter(T=>d.has(T.id));if(m.length===0)return;const v=g.columns.map(T=>T.label),N=m.map(T=>g.columns.map(P=>{let f=T[P.key];return(f instanceof Date||typeof f=="number"&&P.key.includes("At"))&&(f=new Date(f).toLocaleDateString()),typeof f=="boolean"&&(f=f?"Yes":"No"),(P.key==="amount"||P.key==="price"||P.key==="costPrice")&&(f=`$${(f/100).toFixed(2)}`),typeof f=="string"&&(f.includes(",")||f.includes('"'))&&(f=`"${f.replace(/"/g,'""')}"`),f??""}).join(",")),B=[v.join(","),...N].join(`
`),se=new Blob([B],{type:"text/csv"}),ne=URL.createObjectURL(se),D=document.createElement("a");D.href=ne,D.download=`${h.replace(/\s+/g,"_")}_${y}_export.csv`,document.body.appendChild(D),D.click(),document.body.removeChild(D),URL.revokeObjectURL(ne)};return Q?e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-xl w-full max-w-5xl max-h-[90vh] flex flex-col shadow-2xl",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-zinc-200 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-zinc-900",children:g.title}),e.jsx("p",{className:"text-sm text-zinc-500",children:h})]}),e.jsx("button",{onClick:X,className:"p-2 hover:bg-zinc-100 rounded-lg",children:e.jsx(vs,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:I?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Ns,{className:"animate-spin text-blue-600",size:32}),e.jsx("span",{className:"ml-3 text-zinc-600",children:"Loading data..."})]}):ee?e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg",children:["Error: ",ee]}):k.length===0?e.jsxs("div",{className:"text-center py-12 text-zinc-500",children:["No ",g.title.toLowerCase()," found for this tenant."]}):e.jsx("div",{className:"border border-zinc-200 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"bg-zinc-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-12 px-4 py-3 text-left",children:e.jsx("button",{onClick:te,className:"text-zinc-600 hover:text-zinc-900",children:d.size===k.length?e.jsx(pt,{size:18,className:"text-blue-600"}):e.jsx(bt,{size:18})})}),g.columns.map(m=>e.jsx("th",{className:"px-4 py-3 text-left font-medium text-zinc-700",children:m.label},m.key))]})}),e.jsx("tbody",{className:"divide-y divide-zinc-100",children:k.map(m=>e.jsxs("tr",{className:`hover:bg-zinc-50 ${d.has(m.id)?"bg-blue-50":""}`,onClick:()=>L(m.id),children:[e.jsx("td",{className:"px-4 py-3",children:d.has(m.id)?e.jsx(pt,{size:18,className:"text-blue-600"}):e.jsx(bt,{size:18,className:"text-zinc-400"})}),g.columns.map(v=>{let N=m[v.key];return(N instanceof Date||typeof N=="number"&&v.key.includes("At"))&&(N=new Date(N).toLocaleDateString()),typeof N=="boolean"&&(N=N?e.jsx("span",{className:"text-green-600",children:"Yes"}):e.jsx("span",{className:"text-zinc-400",children:"No"})),(v.key==="amount"||v.key==="price")&&(N=`$${((N||0)/100).toFixed(2)}`),e.jsx("td",{className:"px-4 py-3 text-zinc-700",children:N??"-"},v.key)})]},m.id))})]})})}),e.jsxs("div",{className:"px-6 py-4 border-t border-zinc-200 flex items-center justify-between bg-zinc-50",children:[e.jsxs("div",{className:"text-sm text-zinc-600",children:[d.size," of ",k.length," selected"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:X,className:"px-4 py-2 text-zinc-600 hover:bg-zinc-100 rounded-lg",children:"Cancel"}),e.jsxs("button",{onClick:R,disabled:d.size===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(zs,{size:16}),"Export Selected to CSV"]})]})]})]})}):null}const yn=ps(function(){const{tenants:X,platformConfig:K}=bs(),[h,y]=a.useState(X),[k,E]=a.useState(!1),[d,u]=a.useState(!1),[I,V]=a.useState(!1),[ee,O]=a.useState(!1),[l,g]=a.useState({tenantName:"",tenantSlug:"",ownerCount:1,instructorCount:2,studentCount:10,tier:"growth",features:[],featureMode:"all"}),[S,L]=a.useState(new Set),[te,R]=a.useState({}),[m,v]=a.useState({}),[N,B]=a.useState({}),[se,ne]=a.useState({}),[D,T]=a.useState(!1),[P,f]=a.useState(null),[Ve,U]=a.useState(!1),[Be,Je]=a.useState(null),[ae,ie]=a.useState(""),[ze,We]=a.useState("requested_by_customer"),[He,we]=a.useState(""),[gt,ke]=a.useState(!1),[re,ft]=a.useState(null),[jt,Se]=a.useState(!1),[F,yt]=a.useState(null),[J,le]=a.useState(null),Ce=[{key:"mobile_app",label:"White-Label Mobile App",icon:ws,sections:"Settings > Mobile App"},{key:"website_builder",label:"Website Builder",icon:ks,sections:"Settings > Website Widgets"},{key:"chat",label:"Chat System",icon:Ss,sections:"Settings > Chat Settings, Chat Widget"},{key:"financials",label:"Financials & Payouts",icon:mt,sections:"Management > Finances, My Payouts"},{key:"vod",label:"Video on Demand",icon:Cs,sections:"Operations > Media Library"},{key:"zoom",label:"Zoom Integration",icon:Rs,sections:"Backend Integrations"},{key:"pos",label:"POS & Retail",icon:Os,sections:"Commerce > POS, Coupons, Gift Cards"},{key:"sms",label:"SMS Messaging",icon:Ts,sections:"Backend Capability (Notifications)"},{key:"marketing",label:"Marketing & CRM",icon:Ps,sections:"CRM > Email Automations"},{key:"payroll",label:"Payroll & Compensation",icon:mt,sections:"Management > Payroll Admin"}],[Oe,x]=a.useState({isOpen:!1,message:""}),[ce,j]=a.useState({isOpen:!1,message:""}),[oe,Te]=a.useState(null),[de,Pe]=a.useState(null),[ue,Ae]=a.useState(null),[xe,Ee]=a.useState(null),[W,De]=a.useState(null),[vt,me]=a.useState(!1),[$e,pe]=a.useState(null),[Ze,be]=a.useState(""),[Ye,Qe]=a.useState(!1),[Me,he]=a.useState(null),[Xe,ge]=a.useState(""),[Ke,et]=a.useState(!1),[Nt,fe]=a.useState(!1),[tt,zt]=a.useState(null),[st,nt]=a.useState(""),[at,it]=a.useState(""),[wt,Ie]=a.useState(!1),[Le,kt]=a.useState(null),[rt,St]=a.useState(""),{getToken:p}=ht();hs();const[z,H]=a.useState({name:"",slug:"",ownerEmail:"",plan:"basic"}),[Gs,Vs]=a.useState(new Set),[A,Ct]=a.useState("createdAt"),[$,lt]=a.useState("desc"),[Re,Ot]=a.useState("all"),[Ue,Tt]=a.useState("all"),[Z,Pt]=a.useState(()=>typeof window<"u"?localStorage.getItem("admin_show_financials")==="true":!1),[At,je]=a.useState(!1),[ct,Et]=a.useState(null),[M,ye]=a.useState({accountId:"",clientId:"",clientSecret:""}),Dt=t=>{Et(t),ye({accountId:"",clientId:"",clientSecret:""}),je(!0)},$t=async t=>{if(t.preventDefault(),!!ct){u(!0);try{const s=await p(),n=await c(`/admin/tenants/${ct}/credentials/zoom`,s,{method:"PUT",body:JSON.stringify(M)});if(n.error)throw new Error(n.error);j({isOpen:!0,message:"Zoom credentials updated successfully."}),je(!1)}catch(s){x({isOpen:!0,message:s.message})}finally{u(!1)}}},[Mt,Fe]=a.useState(!1),[_e,It]=a.useState(null),Lt=t=>{It(t),Fe(!0)},Rt=async()=>{if(_e){u(!0);try{const t=await p(),s=await c(`/admin/tenants/${_e.id}/impersonate`,t,{method:"POST"});if(s.error)throw new Error(s.error);localStorage.setItem("impersonation_token",s.token),window.location.href=s.redirectUrl||`/studio/${s.slug||"studio"}`}catch(t){x({isOpen:!0,message:t.message||"Impersonation failed"})}finally{u(!1),Fe(!1)}}},Ut=t=>{zt(t),it("System Notification"),nt(""),fe(!0)},Ft=async t=>{if(t.preventDefault(),!!tt){u(!0);try{const s=await p(),n=await c(`/admin/tenants/${tt}/notify`,s,{method:"POST",body:JSON.stringify({subject:at,message:st,level:"info"})});if(n.error)throw new Error(n.error);j({isOpen:!0,message:"Notification sent successfully."}),fe(!1)}catch(s){x({isOpen:!0,message:s.message||"Failed to send notification"})}finally{u(!1)}}},_t=()=>{const t=!Z;Pt(t),localStorage.setItem("admin_show_financials",String(t))},Y=t=>{A===t?lt($==="asc"?"desc":"asc"):(Ct(t),lt("asc"))},_=()=>{if(!Array.isArray(h))return[];let t=[...h];return Re!=="all"&&(t=t.filter(s=>(s.status||"active")===Re)),Ue!=="all"&&(t=t.filter(s=>(s.tier||"basic")===Ue)),t.sort((s,n)=>{const i=(w,xs)=>xs.split(".").reduce((xt,ms)=>xt&&xt[ms],w),r=i(s,A),o=i(n,A);if(r===o)return 0;const b=r>o?1:-1;return $==="asc"?b:-b})},qt=async t=>{t.preventDefault(),u(!0);try{const s=await p(),n=await c("/admin/tenants",s,{method:"POST",body:JSON.stringify({name:z.name,slug:z.slug,tier:z.plan,trialDays:z.trialDays})});n.error?x({isOpen:!0,message:n.error}):(y([...h,n]),E(!1),H({name:"",slug:"",ownerEmail:"",plan:"basic"}),j({isOpen:!0,message:`Tenant ${n.name} (${n.slug}) has been provisioned successfully.`}))}catch(s){console.error(s),x({isOpen:!0,message:s.message||"Failed to create tenant. Please try again."})}finally{u(!1)}},ve=async(t,s)=>{try{const n=await p(),i=await c(`/admin/tenants/${t}/status`,n,{method:"PATCH",body:JSON.stringify({status:s})});i.error?x({isOpen:!0,message:i.error}):(y(h.map(r=>r.id===t?{...r,status:s}:r)),j({isOpen:!0,message:`Tenant status updated to ${s}.`}))}catch(n){x({isOpen:!0,message:n.message||"Failed to update status."})}},Gt=(t,s)=>{Te({id:t,tier:s})},Vt=async()=>{if(!oe)return;const{id:t,tier:s}=oe;try{const n=await p(),i=await c(`/admin/tenants/${t}/tier`,n,{method:"PATCH",body:JSON.stringify({tier:s})});i.error?x({isOpen:!0,message:i.error}):(y(h.map(r=>r.id===t?{...r,tier:s}:r)),j({isOpen:!0,message:`Tenant tier updated to ${s}.`}))}catch(n){x({isOpen:!0,message:n.message||"Failed to update tier."})}finally{Te(null)}},Bt=(t,s)=>{Pe({id:t,interval:s})},Jt=async()=>{if(!de)return;const{id:t,interval:s}=de;u(!0);try{const n=await p(),i=await c(`/admin/tenants/${t}/subscription`,n,{method:"PATCH",body:JSON.stringify({interval:s})});if(i.error)throw new Error(i.error);j({isOpen:!0,message:"Subscription interval updated."});const r=await c(`/admin/tenants/${t}/billing/details`,n);B(o=>({...o,[t]:r}))}catch(n){x({isOpen:!0,message:n.message})}finally{u(!1),Pe(null)}},Wt=t=>{ft(t),ke(!0)},Ht=async()=>{if(!re)return;u(!0);const t=!1;try{const s=await p(),n=await c(`/admin/tenants/${re}/subscription/cancel`,s,{method:"POST",body:JSON.stringify({immediate:t})});if(n.error)throw new Error(n.error);j({isOpen:!0,message:"Subscription set to cancel at end of period."});const i=await c(`/admin/tenants/${re}/billing/details`,s);B(r=>({...r,[re]:i})),ke(!1)}catch(s){x({isOpen:!0,message:s.message})}finally{u(!1)}},ot=async t=>{if(t.preventDefault(),!!Be){u(!0);try{const s=await p(),n=await c(`/admin/tenants/${Be}/billing/refund`,s,{method:"POST",body:JSON.stringify({paymentIntentId:He,amount:ae?Math.round(parseFloat(ae)*100):void 0,reason:ze})});if(n.error)throw new Error(n.error);j({isOpen:!0,message:"Refund processed successfully."}),U(!1)}catch(s){x({isOpen:!0,message:s.message})}finally{u(!1)}}},Zt=t=>{Je(t),ie(""),we(""),U(!0)},dt=async(t,s)=>{try{const n=await p(),i=await c(`/admin/tenants/${t}/subscription`,n,{method:"PATCH",body:JSON.stringify({trialDays:s})});if(i.error)throw new Error(i.error);const r=await c("/admin/tenants",n);y(r)}catch(n){x({isOpen:!0,message:n.message})}},Yt=async(t,s)=>{if(s)try{const n=await p(),i=await c(`/admin/tenants/${t}/subscription`,n,{method:"PATCH",body:JSON.stringify({currentPeriodEnd:s})});if(i.error)throw new Error(i.error);const r=await c("/admin/tenants",n);y(r)}catch(n){x({isOpen:!0,message:n.message})}},Qt=async()=>{W&&(await Yt(W.id,W.date),De(null))},qe=async(t,s,n)=>{try{const i=await p(),r=await c(`/admin/tenants/${t}/quotas`,i,{method:"PATCH",body:JSON.stringify({[s]:n})});if(r.error)throw new Error(r.error);y(h.map(o=>o.id===t?{...o,[s]:n}:o))}catch(i){x({isOpen:!0,message:i.message})}},Xt=t=>{Ae(t)},Kt=async()=>{if(ue){u(!0);try{const t=await p(),s=await c(`/admin/tenants/${ue}/billing/waive`,t,{method:"POST"});if(s.error)throw new Error(s.error);j({isOpen:!0,message:"Usage waived and counters reset to 0."}),y(h.map(n=>n.id===ue?{...n,smsUsage:0,emailUsage:0,streamingUsage:0}:n))}catch(t){x({isOpen:!0,message:t.message})}finally{u(!1),Ae(null)}}},ut=async(t,s)=>{f(s);try{const n=await p(),i=await fetch(`${fs}/admin/tenants/${t}/export?type=${s}`,{headers:{Authorization:`Bearer ${n}`}});if(!i.ok)throw new Error("Export failed");const r=await i.blob(),o=window.URL.createObjectURL(r),b=document.createElement("a");b.href=o,b.download=`export_${s}_${t}.csv`,document.body.appendChild(b),b.click(),b.remove()}catch{x({isOpen:!0,message:"Export failed"})}finally{f(null)}},es=(t,s)=>{yt({id:t,enabled:s}),Se(!0)},ts=async()=>{if(!F)return;const{id:t,enabled:s}=F;u(!0);try{const n=await p(),i=await c(`/admin/tenants/${t}/lifecycle/grace-period`,n,{method:"POST",body:JSON.stringify({enabled:s})});if(i.error)throw new Error(i.error);y(h.map(r=>r.id===t?{...r,studentAccessDisabled:s}:r)),j({isOpen:!0,message:`Student access ${s?"disabled (Grace Period started)":"re-enabled"}.`}),Se(!1)}catch(n){x({isOpen:!0,message:n.message})}finally{u(!1)}},ss=t=>{he(t),ge("")},ns=t=>{Ee(t)},as=async()=>{if(xe)try{const t=await p(),s=await c(`/admin/tenants/${xe}/lifecycle/restore`,t,{method:"POST"});if(s.error)throw new Error(s.error);y(h.map(n=>n.id===xe?{...n,status:"active",studentAccessDisabled:!1}:n)),j({isOpen:!0,message:"Tenant restored successfully."})}catch(t){x({isOpen:!0,message:t.message})}finally{Ee(null)}},is=async t=>{if(S.has(t)){const n=new Set(S);n.delete(t),L(n);return}const s=new Set(S);s.add(t),L(s),T(!0);try{const n=await p(),[i,r,o,b]=await Promise.all([c(`/admin/tenants/${t}/features`,n),c(`/admin/tenants/${t}/stats`,n),c(`/admin/tenants/${t}/billing/details`,n).catch(()=>({})),c(`/admin/tenants/${t}/billing/history`,n).catch(()=>({invoices:[]}))]);R(w=>({...w,[t]:i.features||[]})),R(w=>({...w,[t]:i.features})),v(w=>({...w,[t]:r})),B(w=>({...w,[t]:o})),ne(w=>({...w,[t]:b.invoices||[]}))}catch(n){console.error(n)}finally{T(!1)}},rs=()=>{S.size===_().length?L(new Set):(L(new Set(_().map(t=>t.id))),_().map(t=>t.id))},ls=async(t,s,n)=>{const i=te[t]||{},r={...i,[s]:{...i[s],enabled:!n,source:"manual"}};R(o=>({...o,[t]:r}));try{const o=await p();await c(`/admin/tenants/${t}/features`,o,{method:"POST",body:JSON.stringify({featureKey:s,enabled:!n,source:"manual"})})}catch(o){console.error(o),R(b=>({...b,[t]:{...i,[s]:{...i[s],enabled:n}}}))}},cs=async()=>{V(!0);try{const t=await p();let s=[];l.featureMode==="all"?s=Ce.map(r=>r.key):l.featureMode==="custom"&&(s=l.features);const n=await c("/admin/tenants/seed",t,{method:"POST",body:JSON.stringify({...l,features:s})});if(n.error)throw new Error(n.error);const i=await c("/admin/tenants",t);y(i),j({isOpen:!0,message:`Test Tenant "${n.tenant?.name}" created successfully!`}),O(!1),g({tenantName:"",tenantSlug:"",ownerCount:1,instructorCount:2,studentCount:10,tier:"growth",features:[],featureMode:"all"})}catch(t){x({isOpen:!0,message:t.message||"Seeding failed"})}finally{V(!1)}},os=async()=>{if($e){Qe(!0);try{const t=await p(),s=await c(`/admin/tenants/${$e}`,t,{method:"DELETE"});if(s.error)throw new Error(s.error);y(h.filter(n=>n.id!==$e)),j({isOpen:!0,message:"Tenant deleted successfully."}),me(!1),pe(null),be("")}catch(t){x({isOpen:!0,message:t.message||"Deletion failed"})}finally{Qe(!1)}}},ds=async()=>{if(Me){et(!0);try{const t=await p();await c(`/admin/tenants/${Me}/status`,t,{method:"PUT",body:JSON.stringify({status:"archived"})});const s=await c("/admin/tenants",t);y(s),j({isOpen:!0,message:"Tenant archived successfully."}),he(null),ge("")}catch(t){x({isOpen:!0,message:t.message||"Archive failed"})}finally{et(!1)}}},us=async t=>{if(t.preventDefault(),!!Le){u(!0);try{const s=await p(),n=await c(`/admin/tenants/${Le.id}/owner`,s,{method:"PATCH",body:JSON.stringify({email:rt})});if(n.error)throw new Error(n.error);j({isOpen:!0,message:"Owner email updated successfully."}),Ie(!1),kt(null)}catch(s){x({isOpen:!0,message:s.message||"Update failed"})}finally{u(!1)}}};return e.jsxs("div",{className:"dark:text-zinc-100",children:[e.jsx(js,{isOpen:Oe.isOpen,onClose:()=>x({...Oe,isOpen:!1}),title:"Error",message:Oe.message}),e.jsx(C,{isOpen:ce.isOpen,onClose:()=>j({...ce,isOpen:!1}),title:"Success",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:ce.message}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>j({...ce,isOpen:!1}),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium",children:"Dismiss"})})]})}),e.jsx(q,{isOpen:!!oe,onClose:()=>Te(null),onConfirm:Vt,title:"Change Tenant Tier",message:`Are you sure you want to change this tenant to ${oe?.tier}?`,confirmText:"Change Tier"}),e.jsx(q,{isOpen:!!de,onClose:()=>Pe(null),onConfirm:Jt,title:"Change Billing Interval",message:`Switch billing interval to ${de?.interval}? This will update the Stripe Subscription immediately.`,confirmText:"Update Interval"}),e.jsx(q,{isOpen:!!W,onClose:()=>De(null),onConfirm:Qt,title:"Update Renewal Date",message:`Are you sure you want to update the renewal date to ${W?.date}?`,confirmText:"Update Date"}),e.jsx(q,{isOpen:!!ue,onClose:()=>Ae(null),onConfirm:Kt,title:"Waive Usage",message:"Are you sure you want to WAIVE all current usage for this tenant? This resets counters to 0.",confirmText:"Waive Usage",isDestructive:!0}),e.jsx(q,{isOpen:!!xe,onClose:()=>Ee(null),onConfirm:as,title:"Restore Tenant",message:"Restore this tenant to active status?",confirmText:"Restore"}),e.jsx(C,{isOpen:!!Me,onClose:()=>he(null),title:"Archive Tenant",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-red-50 dark:bg-red-950/30 text-red-800 dark:text-red-200 rounded-lg text-sm border border-red-100 dark:border-red-900/50 flex gap-3",children:[e.jsx(Ge,{className:"shrink-0 mt-0.5",size:16}),e.jsxs("div",{children:[e.jsx("strong",{children:"Warning:"})," This will disable all access for the tenant. Data will be retained but the studio will be offline."]})]}),e.jsxs("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:["To confirm, please type ",e.jsx("strong",{children:"ARCHIVE"})," below:"]}),e.jsx("input",{type:"text",className:"w-full border border-zinc-300 dark:border-zinc-700 rounded-lg px-3 py-2 text-sm bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100 focus:ring-2 focus:ring-red-500 outline-none",placeholder:"Type ARCHIVE",value:Xe,onChange:t=>ge(t.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx("button",{onClick:()=>{ge(""),he(null)},className:"px-3 py-2 text-zinc-600 dark:text-zinc-400 text-sm",children:"Cancel"}),e.jsxs("button",{onClick:ds,disabled:Xe!=="ARCHIVE"||Ke,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-medium disabled:opacity-50 flex items-center gap-2",children:[Ke&&e.jsx(G,{className:"animate-spin",size:14}),"Archive Tenant"]})]})]})}),e.jsx(C,{isOpen:vt,onClose:()=>{me(!1),pe(null),be("")},title:"Delete Tenant",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-3 bg-red-50 text-red-700 text-sm rounded border border-red-100 flex items-start gap-2",children:[e.jsx(Ge,{className:"shrink-0 mt-0.5",size:16}),e.jsxs("div",{children:[e.jsx("span",{className:"font-bold block mb-1",children:"Danger: Irreversible Action"}),"This will explicitly delete the tenant and all associated data."]})]}),e.jsxs("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:["To confirm, please type ",e.jsx("strong",{children:"DELETE"})," below:"]}),e.jsx("input",{type:"text",className:"w-full text-sm border border-zinc-300 dark:border-zinc-700 rounded px-3 py-2 bg-white dark:bg-zinc-800",placeholder:"DELETE",value:Ze,onChange:t=>be(t.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx("button",{onClick:()=>{me(!1),pe(null),be("")},className:"px-3 py-2 text-zinc-600 dark:text-zinc-400 text-sm",children:"Cancel"}),e.jsxs("button",{onClick:os,disabled:Ze!=="DELETE"||Ye,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm font-medium flex items-center gap-2 disabled:opacity-50",children:[Ye&&e.jsx(G,{className:"animate-spin",size:14}),"Delete Tenant"]})]})]})}),e.jsx(C,{isOpen:ee,onClose:()=>O(!1),title:"Seed Test Tenant",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-zinc-600 dark:text-zinc-400",children:"Configure the parameters for the generated test tenant."}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-700 dark:text-zinc-300 mb-1",children:"Tenant Name (Optional)"}),e.jsx("input",{type:"text",className:"w-full text-sm border border-zinc-300 dark:border-zinc-700 rounded px-2 py-1.5 bg-white dark:bg-zinc-800",placeholder:"Auto-generated",value:l.tenantName,onChange:t=>g({...l,tenantName:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-700 dark:text-zinc-300 mb-1",children:"Slug (Optional)"}),e.jsx("input",{type:"text",className:"w-full text-sm border border-zinc-300 dark:border-zinc-700 rounded px-2 py-1.5 bg-white dark:bg-zinc-800",placeholder:"Auto-generated",value:l.tenantSlug,onChange:t=>g({...l,tenantSlug:t.target.value})})]})]}),e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-700 dark:text-zinc-300 mb-1",children:"Tier"}),e.jsxs("select",{className:"w-full text-sm border border-zinc-300 dark:border-zinc-700 rounded px-2 py-1.5 bg-white dark:bg-zinc-800",value:l.tier,onChange:t=>g({...l,tier:t.target.value}),children:[e.jsx("option",{value:"basic",children:"Launch"}),e.jsx("option",{value:"growth",children:"Growth"}),e.jsx("option",{value:"scale",children:"Scale"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("label",{className:"block text-xs font-semibold text-zinc-700 dark:text-zinc-300",children:"Features"}),e.jsxs("div",{className:"flex gap-2 text-xs",children:[e.jsx("button",{className:`px-2 py-0.5 rounded border ${l.featureMode==="all"?"bg-blue-50 border-blue-200 text-blue-700":"bg-transparent border-zinc-200 text-zinc-500"}`,onClick:()=>g({...l,featureMode:"all"}),children:"All"}),e.jsx("button",{className:`px-2 py-0.5 rounded border ${l.featureMode==="none"?"bg-blue-50 border-blue-200 text-blue-700":"bg-transparent border-zinc-200 text-zinc-500"}`,onClick:()=>g({...l,featureMode:"none"}),children:"None"}),e.jsx("button",{className:`px-2 py-0.5 rounded border ${l.featureMode==="custom"?"bg-blue-50 border-blue-200 text-blue-700":"bg-transparent border-zinc-200 text-zinc-500"}`,onClick:()=>g({...l,featureMode:"custom"}),children:"Custom"})]})]}),l.featureMode==="custom"&&e.jsx("div",{className:"grid grid-cols-2 gap-2 p-2 bg-zinc-50 dark:bg-zinc-800/50 rounded border border-zinc-100 dark:border-zinc-800 h-24 overflow-y-auto",children:Ce.map(t=>e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"rounded border-zinc-300 text-blue-600 focus:ring-blue-500",checked:l.features.includes(t.key),onChange:s=>{const n=s.target.checked?[...l.features,t.key]:l.features.filter(i=>i!==t.key);g({...l,features:n})}}),e.jsx("span",{className:"text-xs text-zinc-600 dark:text-zinc-400",children:t.label})]},t.key))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs font-medium mb-1",children:[e.jsx("span",{children:"Owners"}),e.jsx("span",{children:l.ownerCount})]}),e.jsx("input",{type:"range",min:"1",max:"5",step:"1",className:"w-full accent-blue-600 h-1.5 bg-zinc-200 rounded-lg appearance-none cursor-pointer dark:bg-zinc-700",value:l.ownerCount,onChange:t=>g({...l,ownerCount:parseInt(t.target.value)})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs font-medium mb-1",children:[e.jsx("span",{children:"Instructors"}),e.jsx("span",{children:l.instructorCount})]}),e.jsx("input",{type:"range",min:"0",max:"10",step:"1",className:"w-full accent-blue-600 h-1.5 bg-zinc-200 rounded-lg appearance-none cursor-pointer dark:bg-zinc-700",value:l.instructorCount,onChange:t=>g({...l,instructorCount:parseInt(t.target.value)})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs font-medium mb-1",children:[e.jsx("span",{children:"Customers (Students)"}),e.jsx("span",{children:l.studentCount})]}),e.jsx("input",{type:"range",min:"0",max:"50",step:"1",className:"w-full accent-blue-600 h-1.5 bg-zinc-200 rounded-lg appearance-none cursor-pointer dark:bg-zinc-700",value:l.studentCount,onChange:t=>g({...l,studentCount:parseInt(t.target.value)})})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx("button",{onClick:()=>O(!1),className:"px-3 py-2 text-zinc-600 dark:text-zinc-400 text-sm",children:"Cancel"}),e.jsxs("button",{onClick:cs,disabled:I,className:"px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 text-sm font-medium flex items-center gap-2 disabled:opacity-50",children:[I&&e.jsx(G,{className:"animate-spin",size:14}),"Generate Tenant"]})]})]})}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Tenant Management"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs("select",{className:"text-xs border border-zinc-300 dark:border-zinc-700 rounded px-2 py-1 bg-white dark:bg-zinc-800 focus:outline-none focus:ring-2 focus:ring-blue-500",value:Re,onChange:t=>Ot(t.target.value),children:[e.jsx("option",{value:"all",children:"Status: All"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"paused",children:"Paused"}),e.jsx("option",{value:"suspended",children:"Suspended"}),e.jsx("option",{value:"archived",children:"Archived"})]}),e.jsxs("select",{className:"text-sm border border-zinc-300 dark:border-zinc-700 rounded-md px-2 py-1 bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100 outline-none focus:ring-2 focus:ring-blue-500",value:Ue,onChange:t=>Tt(t.target.value),children:[e.jsx("option",{value:"all",children:"All Tiers"}),e.jsx("option",{value:"basic",children:"Launch"}),e.jsx("option",{value:"growth",children:"Growth"}),e.jsx("option",{value:"scale",children:"Scale"})]}),e.jsx("div",{className:"h-6 w-px bg-zinc-300 dark:bg-zinc-700 mx-2"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:rs,className:"text-xs font-medium text-zinc-600 dark:text-zinc-400 hover:text-zinc-900 dark:hover:text-zinc-200 bg-zinc-100 dark:bg-zinc-800 px-3 py-1 rounded-md transition-colors",children:S.size===_().length&&_().length>0?"Collapse All":"Expand All"})}),e.jsx("div",{className:"h-6 w-px bg-zinc-300 dark:bg-zinc-700 mx-2"}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:()=>O(!0),disabled:I,className:"text-xs font-medium bg-emerald-100 text-emerald-700 hover:bg-emerald-200 px-3 py-1 rounded-md transition-colors flex items-center gap-1.5 disabled:opacity-50",children:[I?e.jsx(G,{className:"animate-spin",size:12}):e.jsx(G,{size:12}),"Seed Test Tenant"]})}),e.jsx("div",{className:"h-6 w-px bg-zinc-300 dark:bg-zinc-700 mx-2"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:_t,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 ${Z?"bg-indigo-600":"bg-zinc-200 dark:bg-zinc-700"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${Z?"translate-x-6":"translate-x-1"}`})}),e.jsx("span",{className:"text-sm text-zinc-600 dark:text-zinc-400 font-medium",children:Z?"Financials Visible":"Privacy Mode"})]})]})]}),e.jsxs("button",{onClick:()=>E(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 font-medium text-sm flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"+"})," Spin Up Tenant"]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg overflow-hidden shadow-sm",children:[h?.error&&e.jsxs("div",{className:"p-4 bg-red-50 text-red-700 border-b border-red-100 mb-4",children:[e.jsxs("div",{className:"font-bold",children:["Access Denied: ",h.error]}),h.debug&&e.jsx("pre",{className:"mt-2 text-xs bg-red-100 p-2 rounded overflow-auto",children:JSON.stringify(h.debug,null,2)}),e.jsx("p",{className:"text-xs mt-2",children:"Try refreshing to re-trigger admin bootstrapping."})]}),e.jsxs("table",{className:"w-full text-left text-zinc-900 dark:text-zinc-100",children:[e.jsx("thead",{className:"bg-zinc-50 dark:bg-zinc-950/50 border-b border-zinc-200 dark:border-zinc-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-8"}),e.jsxs("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wider cursor-pointer hover:bg-zinc-100 dark:hover:bg-zinc-900",onClick:()=>Y("name"),children:["Tenant ",A==="name"&&($==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 uppercase tracking-wider cursor-pointer hover:bg-zinc-100",onClick:()=>Y("tier"),children:["Tier ",A==="tier"&&($==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wider text-center cursor-pointer hover:bg-zinc-100 dark:hover:bg-zinc-900",onClick:()=>Y("stats.owners"),children:["People ",A==="stats.owners"&&($==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 uppercase tracking-wider text-center cursor-pointer hover:bg-zinc-100",onClick:()=>Y("storageUsage"),children:["Usage ",A==="storageUsage"&&($==="asc"?"↑":"↓")]}),e.jsxs("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 dark:text-zinc-400 uppercase tracking-wider cursor-pointer hover:bg-zinc-100 dark:hover:bg-zinc-900",onClick:()=>Y("status"),children:["Status ",A==="status"&&($==="asc"?"↑":"↓")]}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-100",children:_().map(t=>e.jsxs(a.Fragment,{children:[e.jsxs("tr",{className:"hover:bg-zinc-50 dark:hover:bg-zinc-800/50 transition-colors cursor-pointer",onClick:()=>is(t.id),children:[e.jsx("td",{className:"pl-4",children:S.has(t.id)?e.jsx(As,{size:16,className:"text-zinc-400"}):e.jsx(Es,{size:16,className:"text-zinc-400"})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-medium text-zinc-900 dark:text-zinc-100",children:t.name}),e.jsx("div",{className:"text-zinc-500 dark:text-zinc-400 text-xs font-mono mt-0.5 bg-zinc-100 dark:bg-zinc-800 inline-block px-1 rounded",children:t.slug})]}),e.jsx("td",{className:"px-6 py-4",onClick:s=>s.stopPropagation(),children:e.jsx("div",{className:"relative",children:e.jsxs("select",{value:t.tier||"basic",onChange:s=>Gt(t.id,s.target.value),className:`appearance-none cursor-pointer inline-flex items-center pl-2 pr-6 py-0.5 rounded text-xs font-medium uppercase tracking-wide border outline-none focus:ring-2 focus:ring-offset-1 focus:ring-blue-500 ${t.tier==="scale"?"bg-purple-100 text-purple-800 border-purple-200 dark:bg-purple-900/30 dark:text-purple-300 dark:border-purple-800":t.tier==="growth"?"bg-blue-100 text-blue-800 border-blue-200 dark:bg-blue-900/30 dark:text-blue-300 dark:border-blue-800":"bg-zinc-100 text-zinc-600 border-zinc-200 dark:bg-zinc-800 dark:text-zinc-400 dark:border-zinc-700"}`,children:[e.jsx("option",{value:"basic",children:"Launch"}),e.jsx("option",{value:"growth",children:"Growth"}),e.jsx("option",{value:"scale",children:"Scale"})]})})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-4 justify-center",children:[e.jsxs("div",{className:"flex flex-col items-center",title:"Owners",children:[e.jsx("span",{className:"text-[10px] text-zinc-400 font-bold uppercase tracking-tighter",children:"Own"}),e.jsx("span",{className:"text-sm font-bold text-zinc-700",children:t.stats?.owners||0})]}),e.jsxs("div",{className:"flex flex-col items-center",title:"Instructors",children:[e.jsx("span",{className:"text-[10px] text-zinc-400 font-bold uppercase tracking-tighter",children:"Inst"}),e.jsx("span",{className:"text-sm font-bold text-zinc-700",children:t.stats?.instructors||0})]}),e.jsxs("div",{className:"flex flex-col items-center",title:"Subscribers",children:[e.jsx("span",{className:"text-[10px] text-zinc-400 font-bold uppercase tracking-tighter",children:"Cust"}),e.jsx(ys,{revealed:Z,placeholder:"***",children:e.jsx("span",{className:"text-sm font-bold text-blue-600",children:t.stats?.subscribers||0})})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex gap-4 justify-center",children:[e.jsxs("div",{className:"flex flex-col items-center",title:"Storage GB",children:[e.jsx("span",{className:"text-[10px] text-zinc-400 font-bold uppercase tracking-tighter",children:"Storage"}),e.jsxs("span",{className:"text-xs font-bold text-zinc-700",children:[(t.storageUsage/(1024*1024*1024)).toFixed(1),"G"]})]}),e.jsxs("div",{className:"flex flex-col items-center",title:"VOD Minutes",children:[e.jsx("span",{className:"text-[10px] text-zinc-400 font-bold uppercase tracking-tighter",children:"VOD"}),e.jsxs("span",{className:"text-xs font-bold text-zinc-700",children:[t.streamingUsage||0,"m"]})]}),e.jsxs("div",{className:"flex flex-col items-center",title:"Emails",children:[e.jsx("span",{className:"text-[10px] text-zinc-400 font-bold uppercase tracking-tighter",children:"Email"}),e.jsx("span",{className:"text-xs font-bold text-zinc-700",children:t.emailUsage||0})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${t.status==="suspended"?"bg-red-100 text-red-800":t.status==="paused"?"bg-amber-100 text-amber-800":"bg-green-100 text-green-800"}`,children:t.status||"Active"})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(gs,{to:`/studio/${t.slug}`,className:"text-blue-600 hover:text-blue-800 text-xs font-semibold uppercase tracking-wide border border-blue-200 bg-blue-50 px-3 py-1 rounded-full hover:bg-blue-100 transition-colors",onClick:s=>s.stopPropagation(),children:"Enter"}),e.jsx("div",{className:"h-4 w-px bg-zinc-200"}),e.jsx("button",{className:"text-zinc-400 hover:text-indigo-600 transition-colors",onClick:s=>{s.stopPropagation(),Lt({id:t.id,name:t.name})},title:"Log in as Owner",children:e.jsx(Is,{size:16})}),e.jsx("button",{className:"text-zinc-400 hover:text-blue-600 transition-colors",onClick:s=>{s.stopPropagation(),Ut(t.id)},title:"Send Notification",children:e.jsx(Ds,{size:16})}),e.jsx("div",{className:"h-4 w-px bg-zinc-200"}),(t.status==="active"||t.status==="paused")&&(t.status==="paused"?e.jsx("button",{className:"text-emerald-600 hover:text-emerald-700 text-xs font-medium transition-colors",onClick:s=>{s.stopPropagation(),ve(t.id,"active")},children:"Resume"}):e.jsx("button",{className:"text-zinc-500 hover:text-amber-600 text-xs font-medium transition-colors",onClick:s=>{s.stopPropagation(),ve(t.id,"paused")},children:"Pause"})),(t.status==="active"||t.status==="paused"||t.status==="suspended")&&(t.status==="suspended"?e.jsx("button",{className:"text-emerald-600 hover:text-emerald-700 text-xs font-medium transition-colors",onClick:s=>{s.stopPropagation(),ve(t.id,"active")},children:"Activate"}):e.jsx("button",{className:"text-zinc-500 hover:text-red-600 text-xs font-medium transition-colors",onClick:s=>{s.stopPropagation(),ve(t.id,"suspended")},children:"Suspend"})),t.status==="archived"&&e.jsx("button",{className:"text-red-600 hover:text-red-800 text-xs font-medium transition-colors bg-red-50 px-2 py-0.5 rounded border border-red-100",onClick:s=>{s.stopPropagation(),pe(t.id),me(!0)},children:"Delete"})]})})]}),S.has(t.id)&&e.jsx("tr",{className:"bg-zinc-50/50 dark:bg-zinc-900/30",children:e.jsx("td",{colSpan:7,className:"px-6 pb-6 pt-2",children:e.jsxs("div",{className:"bg-white dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 rounded-lg p-6 shadow-inner space-y-6",children:[e.jsxs("div",{className:"bg-zinc-50 dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg p-4 flex flex-col md:flex-row gap-6 justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] uppercase text-zinc-500 font-bold mb-1",children:"Subscription Information"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium capitalize ${t.subscriptionStatus==="active"?"bg-green-100 text-green-800":t.subscriptionStatus==="past_due"?"bg-orange-100 text-orange-800":t.subscriptionStatus==="canceled"?"bg-red-100 text-red-800":"bg-zinc-200 text-zinc-800"}`,children:t.subscriptionStatus==="past_due"?"Past Due":t.subscriptionStatus||"trialing"}),e.jsxs("select",{className:"text-xs bg-white dark:bg-zinc-800 border border-zinc-300 dark:border-zinc-700 rounded px-2 py-1 outline-none focus:border-blue-500 text-zinc-900 dark:text-zinc-100",value:N[t.id]?.interval||"monthly",onChange:s=>Bt(t.id,s.target.value),children:[e.jsx("option",{value:"monthly",children:"Monthly"}),e.jsx("option",{value:"annual",children:"Annual"})]})]}),N[t.id]?.cancelAtPeriodEnd&&e.jsx("div",{className:"text-[10px] text-red-600 font-medium mt-1",children:"Cancels at end of period"})]}),e.jsx("div",{className:"h-8 w-px bg-zinc-200 dark:bg-zinc-800 hidden md:block"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] uppercase text-zinc-500 font-bold mb-1",children:"Period Ends"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"date",className:"text-xs border border-zinc-300 dark:border-zinc-700 rounded px-2 py-1 bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100 hover:border-zinc-400 transition-colors",defaultValue:t.currentPeriodEnd?new Date(t.currentPeriodEnd).toISOString().split("T")[0]:"",onBlur:s=>{s.target.value&&s.target.value!==(t.currentPeriodEnd?new Date(t.currentPeriodEnd).toISOString().split("T")[0]:"")&&De({id:t.id,date:s.target.value})}}),e.jsxs("div",{className:"flex text-[10px] gap-1",children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),dt(t.id,30)},className:"px-1.5 py-0.5 bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"+30d"}),e.jsx("button",{onClick:s=>{s.stopPropagation(),dt(t.id,9999)},className:"px-1.5 py-0.5 bg-zinc-100 dark:bg-zinc-700 text-zinc-600 dark:text-zinc-300 rounded hover:bg-zinc-200 dark:hover:bg-zinc-600",children:"∞"})]})]}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),Wt(t.id)},className:"text-[10px] text-red-600 hover:underline",children:"Cancel Subs"}),e.jsx("button",{onClick:s=>{s.stopPropagation(),Zt(t.id)},className:"text-[10px] text-zinc-500 hover:text-zinc-800 hover:underline",children:"Refund"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-6 border-l border-zinc-200 dark:border-zinc-800 pl-6 border-l-0 md:border-l",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase text-zinc-400 font-bold block mb-1",children:"SMS Limit"}),e.jsx("input",{type:"number",className:`w-20 text-xs border rounded px-2 py-1 ${t.billingExempt?"bg-zinc-100 dark:bg-zinc-800/50 text-zinc-400 dark:text-zinc-500":"bg-white dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700 text-zinc-900 dark:text-zinc-100"}`,defaultValue:t.smsLimit||0,onBlur:s=>qe(t.id,"smsLimit",parseInt(s.target.value))}),e.jsx("div",{className:"mt-2 w-full",children:t.billingExempt?e.jsx("div",{className:"text-center",children:e.jsx("span",{className:"text-[10px] uppercase font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full",children:"Unlimited"})}):e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-[10px] text-zinc-500",children:[e.jsxs("span",{children:[t.smsUsage||0," sent"]}),e.jsxs("span",{children:[Math.round((t.smsUsage||0)/(t.smsLimit||1)*100),"%"]})]}),e.jsx("div",{className:"h-1.5 w-24 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all ${(t.smsUsage||0)>=(t.smsLimit||0)?"bg-red-500":(t.smsUsage||0)/(t.smsLimit||1)>.8?"bg-amber-400":"bg-emerald-500"}`,style:{width:`${Math.min(100,(t.smsUsage||0)/(t.smsLimit||1)*100)}%`}})}),e.jsxs("div",{className:"text-[10px] text-zinc-400 text-right",children:[t.smsLimit||0," limit"]})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] uppercase text-zinc-400 font-bold block mb-1",children:"Email Limit"}),e.jsx("input",{type:"number",className:`w-20 text-xs border rounded px-2 py-1 ${t.billingExempt?"bg-zinc-100 dark:bg-zinc-800/50 text-zinc-400 dark:text-zinc-500":"bg-white dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700 text-zinc-900 dark:text-zinc-100"}`,defaultValue:t.emailLimit||0,onBlur:s=>qe(t.id,"emailLimit",parseInt(s.target.value))}),e.jsx("div",{className:"mt-2 w-full",children:t.billingExempt?e.jsx("div",{className:"text-center",children:e.jsx("span",{className:"text-[10px] uppercase font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded-full",children:"Unlimited"})}):e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between text-[10px] text-zinc-500",children:[e.jsxs("span",{children:[t.emailUsage||0," sent"]}),e.jsxs("span",{children:[Math.round((t.emailUsage||0)/(t.emailLimit||1)*100),"%"]})]}),e.jsx("div",{className:"h-1.5 w-24 bg-zinc-100 dark:bg-zinc-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all ${(t.emailUsage||0)>=(t.emailLimit||0)?"bg-red-500":(t.emailUsage||0)/(t.emailLimit||1)>.8?"bg-amber-400":"bg-emerald-500"}`,style:{width:`${Math.min(100,(t.emailUsage||0)/(t.emailLimit||1)*100)}%`}})}),e.jsxs("div",{className:"text-[10px] text-zinc-400 text-right",children:[t.emailLimit||0," limit"]})]})})]}),e.jsxs("div",{className:"flex flex-col gap-1 pt-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",id:`exempt-${t.id}`,className:"rounded border-zinc-300 dark:border-zinc-700 dark:bg-zinc-800 text-blue-600 focus:ring-blue-500",defaultChecked:!!t.billingExempt,onChange:s=>qe(t.id,"billingExempt",s.target.checked)}),e.jsx("label",{className:"text-xs text-zinc-700 dark:text-zinc-300 cursor-pointer select-none font-medium",htmlFor:`exempt-${t.id}`,children:"Billing Exempt"})]}),t.billingExempt&&e.jsx("span",{className:"text-[10px] text-zinc-400 pl-5",children:"Limits ignored"}),!t.billingExempt&&e.jsx("button",{onClick:s=>{s.stopPropagation(),Xt(t.id)},className:"mt-2 text-[10px] text-zinc-400 hover:text-blue-600 hover:underline text-left pl-5",children:"Waive Usage (Reset)"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-950 border border-zinc-200 dark:border-zinc-800 rounded-lg p-4 mt-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"text-[10px] uppercase text-zinc-500 font-bold",children:"Lifecycle & Data"}),e.jsx("div",{className:"flex gap-2",children:t.status==="archived"?e.jsx("button",{onClick:s=>{s.stopPropagation(),ns(t.id)},className:"text-xs bg-emerald-100 text-emerald-800 px-2 py-1 rounded hover:bg-emerald-200",children:"Restore Tenant"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),es(t.id,!t.studentAccessDisabled)},className:`text-xs px-3 py-1.5 rounded-md border font-medium transition-colors ${t.studentAccessDisabled?"bg-amber-100 border-amber-200 text-amber-800 hover:bg-amber-200":"bg-white border-zinc-300 text-zinc-700 hover:bg-zinc-50"}`,children:t.studentAccessDisabled?"Enable Student Access":"Start Grace Period"}),e.jsx("button",{onClick:s=>{s.stopPropagation(),ss(t.id)},className:"text-xs bg-red-50 text-red-600 border border-red-100 px-2 py-1 rounded hover:bg-red-100",children:"Archive"})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:[e.jsxs("button",{onClick:s=>{s.stopPropagation(),le({isOpen:!0,tenantId:t.id,tenantName:t.name,dataType:"subscribers"})},className:"text-left bg-zinc-50 border border-zinc-200 rounded p-2 hover:bg-zinc-100 group transition-all",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx("span",{className:"bg-white p-0.5 rounded border border-zinc-200 text-zinc-500 group-hover:text-blue-600 text-[10px]",children:"⬇"}),e.jsx("span",{className:"text-xs font-bold text-zinc-700",children:"Subscribers"})]}),e.jsx("div",{className:"text-[10px] text-zinc-500 truncate",children:"View & select members"})]}),e.jsxs("button",{onClick:s=>{s.stopPropagation(),le({isOpen:!0,tenantId:t.id,tenantName:t.name,dataType:"financials"})},className:"text-left bg-zinc-50 border border-zinc-200 rounded p-2 hover:bg-zinc-100 group transition-all",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx("span",{className:"bg-white p-0.5 rounded border border-zinc-200 text-zinc-500 group-hover:text-green-600 text-[10px]",children:"⬇"}),e.jsx("span",{className:"text-xs font-bold text-zinc-700",children:"Financials"})]}),e.jsx("div",{className:"text-[10px] text-zinc-500 truncate",children:"View & select transactions"})]}),e.jsxs("button",{onClick:s=>{s.stopPropagation(),le({isOpen:!0,tenantId:t.id,tenantName:t.name,dataType:"products"})},className:"text-left bg-zinc-50 border border-zinc-200 rounded p-2 hover:bg-zinc-100 group transition-all",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx("span",{className:"bg-white p-0.5 rounded border border-zinc-200 text-zinc-500 group-hover:text-purple-600 text-[10px]",children:"⬇"}),e.jsx("span",{className:"text-xs font-bold text-zinc-700",children:"Products"})]}),e.jsx("div",{className:"text-[10px] text-zinc-500 truncate",children:"View & select products"})]}),e.jsxs("button",{onClick:s=>{s.stopPropagation(),ut(t.id,"classes")},disabled:!!P,className:"text-left bg-zinc-50 border border-zinc-200 rounded p-2 hover:bg-zinc-100 disabled:opacity-50 group transition-all",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx("span",{className:"bg-white p-0.5 rounded border border-zinc-200 text-zinc-500 group-hover:text-amber-600 text-[10px]",children:"⬇"}),e.jsx("span",{className:"text-xs font-bold text-zinc-700",children:"Classes"})]}),e.jsx("div",{className:"text-[10px] text-zinc-500 truncate",children:"Schedule & Attendance"})]}),e.jsxs("button",{onClick:s=>{s.stopPropagation(),ut(t.id,"vod")},disabled:!!P,className:"text-left bg-zinc-50 border border-zinc-200 rounded p-2 hover:bg-zinc-100 disabled:opacity-50 group transition-all",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[e.jsx("span",{className:"bg-white p-0.5 rounded border border-zinc-200 text-zinc-500 group-hover:text-red-500 text-[10px]",children:"⬇"}),e.jsx("span",{className:"text-xs font-bold text-zinc-700",children:"VOD Usage"})]}),e.jsx("div",{className:"text-[10px] text-zinc-500 truncate",children:"Storage & Streaming"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-zinc-500 uppercase tracking-wider mb-3",children:"Recent Payments"}),e.jsx("div",{className:"bg-white border border-zinc-200 rounded-lg overflow-hidden",children:e.jsxs("table",{className:"w-full text-left text-xs",children:[e.jsx("thead",{className:"bg-zinc-50 border-b border-zinc-200 text-zinc-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 font-medium",children:"Date"}),e.jsx("th",{className:"px-4 py-2 font-medium",children:"Amount"}),e.jsx("th",{className:"px-4 py-2 font-medium",children:"Status"}),e.jsx("th",{className:"px-4 py-2 font-medium text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-100",children:se[t.id]?.length?se[t.id].map(s=>e.jsxs("tr",{className:"hover:bg-zinc-50",children:[e.jsx("td",{className:"px-4 py-2 text-zinc-600",children:new Date(s.date).toLocaleDateString()}),e.jsxs("td",{className:"px-4 py-2 font-medium text-zinc-900",children:["$",(s.amount/100).toFixed(2)]}),e.jsx("td",{className:"px-4 py-2",children:e.jsx("span",{className:`inline-flex px-1.5 py-0.5 rounded text-[10px] font-medium capitalize ${s.status==="paid"?"bg-emerald-100 text-emerald-800":s.status==="open"?"bg-blue-100 text-blue-800":"bg-zinc-100 text-zinc-600"}`,children:s.status})}),e.jsxs("td",{className:"px-4 py-2 text-right flex justify-end gap-3",children:[s.hostedUrl&&e.jsx("a",{href:s.hostedUrl,target:"_blank",rel:"noreferrer",className:"text-blue-600 hover:underline",children:"Invoice"}),s.paymentIntentId&&s.amount>0&&s.status==="paid"&&e.jsx("button",{onClick:()=>{Je(t.id),we(s.paymentIntentId),ie(""),U(!0)},className:"text-zinc-500 hover:text-red-600",children:"Refund"})]})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"px-4 py-4 text-center text-zinc-400 italic",children:"No payment history available"})})})]})})]}),D?e.jsx("div",{className:"text-sm text-zinc-500 py-2",children:"Loading capabilities..."}):e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Ce.map(s=>{const n=(te[t.id]||{})[s.key]||{enabled:!1,source:"manual"},i=`feature_${s.key}`,r=K?.find(b=>b.key===i),o=!r||!r.enabled;return e.jsxs("div",{className:`flex items-center justify-between p-3 border rounded-md ${o?"bg-zinc-100 opacity-60":"bg-zinc-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(s.icon,{size:18,className:o?"text-zinc-400":"text-zinc-500"}),e.jsxs("div",{children:[e.jsx("div",{className:`text-sm font-medium ${o?"text-zinc-500":"text-zinc-900"}`,children:s.label}),e.jsx("div",{className:"text-xs text-zinc-500",children:o?"Disabled by Platform":`Source: ${n.source}`}),e.jsx("div",{className:"text-[10px] text-zinc-400 mt-0.5 truncate max-w-[180px]",title:s.sections,children:s.sections})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.key==="zoom"&&n.enabled&&!o&&e.jsx("button",{onClick:b=>{b.stopPropagation(),Dt(t.id)},className:"p-1 text-zinc-500 hover:text-blue-600 hover:bg-zinc-200 rounded",title:"Configure Zoom Credentials",children:e.jsx($s,{size:16})}),e.jsx("button",{onClick:b=>{b.stopPropagation(),!o&&ls(t.id,s.key,n.enabled)},disabled:o,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 ${o?"bg-zinc-300 cursor-not-allowed":n.enabled?"bg-blue-600":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${n.enabled?"translate-x-6":"translate-x-1"}`})})]})]},s.key)})})})]})})})]},t.id))})]}),(!Array.isArray(h)||h.length===0)&&e.jsx("div",{className:"p-8 text-center text-zinc-500",children:"No tenants found. Create one to get started."})]}),e.jsxs(C,{isOpen:At,onClose:()=>je(!1),title:"Configure Zoom Integration",children:[e.jsx("div",{className:"mb-4 text-sm text-zinc-500",children:"Provide the Server-to-Server OAuth credentials from the Zoom App Marketplace. This allows the platform to create meetings on behalf of this tenant."}),e.jsxs("form",{onSubmit:$t,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Account ID"}),e.jsx("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:M.accountId,onChange:t=>ye({...M,accountId:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Client ID"}),e.jsx("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:M.clientId,onChange:t=>ye({...M,clientId:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Client Secret"}),e.jsx("input",{type:"password",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:M.clientSecret,onChange:t=>ye({...M,clientSecret:t.target.value})})]}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>je(!1),className:"flex-1 px-4 py-2 border border-zinc-300 text-zinc-700 rounded-md hover:bg-zinc-50 font-medium",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:d,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium disabled:opacity-50",children:d?"Saving...":"Save Credentials"})]})]})]}),e.jsxs(C,{isOpen:Ve,onClose:()=>U(!1),title:"Issue Refund",children:[e.jsx("div",{className:"mb-4 text-sm text-zinc-500",children:"Refund a payment for this tenant. You need the Stripe Payment Intent ID (from Stripe Dashboard)."}),e.jsxs("form",{onSubmit:ot,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Payment Intent ID"}),e.jsx("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"pi_...",value:He,onChange:t=>we(t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Amount (Optional - leave empty for full)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-2 text-zinc-500",children:"$"}),e.jsx("input",{type:"number",step:"0.01",className:"w-full pl-8 pr-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"0.00",value:ae,onChange:t=>ie(t.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Reason"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:ze,onChange:t=>We(t.target.value),children:[e.jsx("option",{value:"requested_by_customer",children:"Requested by Customer"}),e.jsx("option",{value:"duplicate",children:"Duplicate"}),e.jsx("option",{value:"fraudulent",children:"Fraudulent"})]})]}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>U(!1),className:"flex-1 px-4 py-2 border border-zinc-300 text-zinc-700 rounded-md hover:bg-zinc-50 font-medium",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:d,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 font-medium disabled:opacity-50",children:d?"Processing...":"Issue Refund"})]})]})]}),e.jsxs(C,{isOpen:k,onClose:()=>E(!1),title:"Spin Up New Tenant",children:[e.jsx("div",{className:"mb-6",children:e.jsx("p",{className:"text-zinc-500 text-sm",children:"Automated provisioning: This will create a database record, set up initial owner permissions, and allocate resources."})}),e.jsxs("form",{onSubmit:qt,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Studio Name"}),e.jsx("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"e.g. Zen Garden Yoga",value:z.name,onChange:t=>{const s=t.target.value;H(n=>{const i=b=>b.toLowerCase().replace(/[^a-z0-9]/g,"-"),r=i(n.name),o=!n.slug||n.slug===r;return{...n,name:s,slug:o?i(s):n.slug}})}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"URL Slug"}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"inline-flex items-center px-3 rounded-l-md border border-r-0 border-zinc-300 bg-zinc-50 text-zinc-500 text-sm",children:"/studio/"}),e.jsx("input",{type:"text",required:!0,className:"flex-1 px-3 py-2 border border-zinc-300 rounded-r-md focus:ring-2 focus:ring-blue-500 outline-none font-mono text-sm",placeholder:"zen-garden",value:z.slug,onChange:t=>H({...z,slug:t.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Plan Tier"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none bg-white",value:z.plan,onChange:t=>H({...z,plan:t.target.value}),children:[e.jsx("option",{value:"basic",children:"Launch (Basic)"}),e.jsx("option",{value:"growth",children:"Growth"}),e.jsx("option",{value:"scale",children:"Scale"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Trial Period (Days)"}),e.jsx("input",{type:"number",min:"0",className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"14",value:z.trialDays||"",onChange:t=>H({...z,trialDays:parseInt(t.target.value)})}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Leave empty for no trial"})]})]}),e.jsx("p",{className:"text-xs text-zinc-500",children:"This studio will be created under your admin account with billing bypassed."}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>E(!1),className:"flex-1 px-4 py-2 border border-zinc-300 text-zinc-700 rounded-md hover:bg-zinc-50 font-medium",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:d,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium disabled:opacity-50",children:d?"Provisioning...":"Launch Studio"})]})]})]}),Ve&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full shadow-xl",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Process Refund"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-700 mb-1",children:"Amount (Leave empty for full refund)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-2 text-zinc-500",children:"$"}),e.jsx("input",{type:"number",step:"0.01",className:"w-full pl-6 border border-zinc-300 rounded px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 outline-none",placeholder:"0.00",value:ae,onChange:t=>ie(t.target.value)})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-700 mb-1",children:"Reason"}),e.jsxs("select",{className:"w-full border border-zinc-300 rounded px-3 py-2 text-sm",value:ze,onChange:t=>We(t.target.value),children:[e.jsx("option",{value:"requested_by_customer",children:"Requested by Customer"}),e.jsx("option",{value:"duplicate",children:"Duplicate"}),e.jsx("option",{value:"fraudulent",children:"Fraudulent"})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>U(!1),className:"px-4 py-2 text-sm text-zinc-600 hover:bg-zinc-100 rounded",children:"Cancel"}),e.jsx("button",{onClick:ot,disabled:d,className:"px-4 py-2 text-sm bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:d?"Processing...":"Confirm Refund"})]})]})}),gt&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full shadow-xl border border-red-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 text-red-600",children:[e.jsx(Ge,{className:"h-6 w-6"}),e.jsx("h3",{className:"text-lg font-bold",children:"Cancel Subscription?"})]}),e.jsx("p",{className:"text-sm text-zinc-600 mb-6",children:"Are you sure you want to cancel the subscription for this tenant? This action will disable billing at the end of the current period."}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>ke(!1),className:"px-4 py-2 text-sm text-zinc-600 hover:bg-zinc-100 rounded",children:"No, Keep It"}),e.jsx("button",{onClick:Ht,disabled:d,className:"px-4 py-2 text-sm bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50 font-medium",children:d?"Cancelling...":"Yes, Cancel Subscription"})]})]})}),jt&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full shadow-xl border border-amber-100",children:[e.jsxs("div",{className:"flex items-center gap-3 text-amber-600 mb-4 bg-amber-50 p-3 rounded-lg",children:[e.jsx(G,{className:"h-6 w-6"}),e.jsx("span",{className:"font-bold",children:F?.enabled?"Start Grace Period":"End Grace Period"})]}),F?.enabled?e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-zinc-600 text-sm mb-4",children:["Enabling ",e.jsx("strong",{children:"Grace Period"})," will disable access to the Student Portal and Mobile App immediately."]}),e.jsxs("p",{className:"text-zinc-600 text-sm mb-6",children:["- Admins will retain access.",e.jsx("br",{}),"- Public schedules will be hidden.",e.jsx("br",{}),'- Tenant status remains "Active" for billing purposes unless changed.']})]}):e.jsx("p",{className:"text-zinc-600 text-sm mb-6",children:"Re-enabling access will restore Student Portal and Mobile App functionality immediately."}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>Se(!1),className:"px-4 py-2 text-sm text-zinc-600 hover:bg-zinc-100 rounded",children:"Cancel"}),e.jsx("button",{onClick:ts,disabled:d,className:`px-4 py-2 text-sm font-medium text-white rounded-md disabled:opacity-50 ${F?.enabled?"bg-amber-600 hover:bg-amber-700":"bg-green-600 hover:bg-green-700"}`,children:d?"Processing...":F?.enabled?"Disable Access":"Restore Access"})]})]})}),e.jsx(C,{isOpen:wt,onClose:()=>Ie(!1),title:`Edit Tenant: ${Le?.name}`,children:e.jsxs("form",{onSubmit:us,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Owner Email"}),e.jsx("input",{type:"email",required:!0,className:"w-full px-3 py-2 border border-zinc-300 rounded-md focus:ring-2 focus:ring-blue-500 outline-none",value:rt,onChange:t=>St(t.target.value)}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"This will update the login email for the user account associated with the 'Owner' role."})]}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>Ie(!1),className:"flex-1 px-4 py-2 border border-zinc-300 text-zinc-700 rounded-md hover:bg-zinc-50 font-medium",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:d,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-medium disabled:opacity-50",children:d?"Saving...":"Update Owner"})]})]})}),J&&e.jsx(qs,{isOpen:J.isOpen,onClose:()=>le(null),tenantId:J.tenantId,tenantName:J.tenantName,dataType:J.dataType}),e.jsx(q,{isOpen:Mt,onClose:()=>Fe(!1),onConfirm:Rt,title:"Impersonate Tenant Owner",message:`Are you sure you want to log in as the owner of ${_e?.name}? You will be logged out of your admin account.`,confirmText:"Log In as Owner",isDestructive:!1}),e.jsx(C,{isOpen:Nt,onClose:()=>fe(!1),title:"Send System Notification",children:e.jsxs("form",{onSubmit:Ft,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Subject"}),e.jsx("input",{type:"text",value:at,onChange:t=>it(t.target.value),className:"w-full px-3 py-2 border border-zinc-300 dark:border-zinc-700 rounded-md bg-white dark:bg-zinc-800",placeholder:"System Notification"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Message"}),e.jsx("textarea",{value:st,onChange:t=>nt(t.target.value),className:"w-full px-3 py-2 border border-zinc-300 dark:border-zinc-700 rounded-md bg-white dark:bg-zinc-800 min-h-[100px]",placeholder:"Enter message to send to the tenant owner...",required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[e.jsx("button",{type:"button",onClick:()=>fe(!1),className:"px-4 py-2 text-zinc-600 hover:bg-zinc-100 rounded-md",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 flex items-center gap-2",children:d?"Sending...":e.jsx(e.Fragment,{children:"Send Notification"})})]})]})})]})});export{yn as default};
