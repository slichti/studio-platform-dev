import{w as g,u as f,a as z}from"./chunk-JMJ3UQ3L-DsmOvVYk.js";import{j as e}from"./vendor-puck-Ox9nZAW8.js";import{a as j}from"./api-OnQO3erh.js";import{t as p}from"./index-Cb5OqxoU.js";import{a as k}from"./vendor-sentry-JepEA2vj.js";import{M as N}from"./mail-BspoxSMS.js";import{R as y}from"./refresh-cw-CjtOPibf.js";import{S as w}from"./search-DuKLkEI3.js";import{S as v}from"./send-ClowdSfz.js";import{C as S}from"./circle-check-big-CSQBoMuh.js";import{C}from"./circle-x-CTW3GYJg.js";import{f as R}from"./vendor-date-fns-0CaSm0ev.js";import"./createLucideIcon-CZ3UnH4h.js";const G=g(function(){const{logs:d,pagination:r,params:i,error:l}=f(),[P,n]=z(),[o,x]=k.useState(null),h=t=>{t.preventDefault();const a=new FormData(t.target).get("search");n(c=>(c.set("search",a),c.set("page","1"),c))},m=(t,s)=>{n(a=>(s==="all"?a.delete(t):a.set(t,s),a.set("page","1"),a))},u=async t=>{x(t);try{const s=await window.Clerk?.session?.getToken();await j(`/admin/communications/resend/${t}`,s,{method:"POST"}),p.success("Email resent successfully")}catch(s){p.error("Failed to resend: "+s.message)}finally{x(null)}},b=({status:t,errorMsg:s})=>t==="sent"?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300",children:[e.jsx(S,{className:"w-3 h-3"})," Sent"]}):t==="failed"?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300",title:s,children:[e.jsx(C,{className:"w-3 h-3"})," Failed"]}):e.jsx("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-medium bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-300",children:t});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold tracking-tight text-zinc-900 dark:text-zinc-100 flex items-center gap-2",children:[e.jsx(N,{className:"text-blue-600"}),"Email Logs"]}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400",children:"Monitor and manage platform communication logs."})]}),e.jsxs("button",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-md border border-zinc-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 hover:bg-zinc-50 dark:hover:bg-zinc-700 text-sm font-medium transition",onClick:()=>window.location.reload(),children:[e.jsx(y,{className:"w-4 h-4"})," Refresh"]})]}),l&&e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 p-3 rounded-lg text-sm",children:l}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-100 dark:border-zinc-800 flex flex-col sm:flex-row gap-4 justify-between",children:[e.jsxs("form",{onSubmit:h,className:"flex gap-2 w-full sm:w-auto",children:[e.jsx("input",{name:"search",placeholder:"Search subject or recipient...",defaultValue:i.search,className:"flex-1 sm:w-[300px] px-3 py-2 text-sm border border-zinc-200 dark:border-zinc-700 rounded-md bg-transparent dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none"}),e.jsx("button",{type:"submit",className:"px-3 py-2 bg-zinc-100 dark:bg-zinc-800 hover:bg-zinc-200 dark:hover:bg-zinc-700 rounded-md transition",children:e.jsx(w,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{onChange:t=>m("status",t.target.value),defaultValue:i.status||"all",className:"h-9 px-3 text-sm border border-zinc-200 dark:border-zinc-700 rounded-md bg-transparent dark:text-white focus:ring-2 focus:ring-blue-500 outline-none",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"failed",children:"Failed"})]}),e.jsxs("select",{onChange:t=>m("type",t.target.value),defaultValue:i.type||"all",className:"h-9 px-3 text-sm border border-zinc-200 dark:border-zinc-700 rounded-md bg-transparent dark:text-white focus:ring-2 focus:ring-blue-500 outline-none",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"transactional",children:"Transactional"}),e.jsx("option",{value:"campaign",children:"Marketing"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-zinc-50 dark:bg-zinc-900/50 border-b border-zinc-200 dark:border-zinc-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 font-semibold text-xs uppercase text-zinc-500 dark:text-zinc-400",children:"Sent At"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-xs uppercase text-zinc-500 dark:text-zinc-400",children:"Recipient"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-xs uppercase text-zinc-500 dark:text-zinc-400",children:"Subject"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-xs uppercase text-zinc-500 dark:text-zinc-400",children:"Type"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-xs uppercase text-zinc-500 dark:text-zinc-400",children:"Tenant"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-xs uppercase text-zinc-500 dark:text-zinc-400",children:"Status"}),e.jsx("th",{className:"px-4 py-3 font-semibold text-xs uppercase text-zinc-500 dark:text-zinc-400 text-right",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:d.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,className:"text-center py-12 text-zinc-500 dark:text-zinc-400",children:"No logs found."})}):d.map(t=>e.jsxs("tr",{className:"hover:bg-zinc-50 dark:hover:bg-zinc-800/50 transition",children:[e.jsx("td",{className:"px-4 py-3 font-mono text-xs text-zinc-500 dark:text-zinc-400 whitespace-nowrap",children:R(new Date(t.sentAt),"MMM d, HH:mm:ss")}),e.jsx("td",{className:"px-4 py-3 text-zinc-900 dark:text-zinc-100",children:t.recipient}),e.jsx("td",{className:"px-4 py-3 max-w-[300px] truncate text-zinc-700 dark:text-zinc-300",title:t.subject,children:t.subject}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:"inline-flex px-2 py-0.5 rounded text-xs font-medium bg-zinc-100 dark:bg-zinc-800 text-zinc-600 dark:text-zinc-300 font-mono",children:t.templateId||(t.campaignId?"Campaign":"Generic")})}),e.jsx("td",{className:"px-4 py-3 text-zinc-600 dark:text-zinc-300",children:t.tenantName||"-"}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx(b,{status:t.status,errorMsg:t.error}),t.error&&e.jsx("div",{className:"text-xs text-red-500 mt-1 truncate max-w-[200px]",title:t.error,children:t.error})]}),e.jsx("td",{className:"px-4 py-3 text-right",children:e.jsx("button",{className:"p-2 hover:bg-zinc-100 dark:hover:bg-zinc-700 rounded-md transition",onClick:()=>u(t.id),disabled:o===t.id,title:"Resend Email",children:e.jsx(v,{className:`w-4 h-4 ${o===t.id?"animate-pulse":""}`})})})]},t.id))})]})}),e.jsxs("div",{className:"p-4 border-t border-zinc-100 dark:border-zinc-800 flex items-center justify-end gap-4",children:[e.jsx("button",{className:"px-3 py-1.5 text-sm border border-zinc-200 dark:border-zinc-700 rounded-md hover:bg-zinc-50 dark:hover:bg-zinc-800 disabled:opacity-50 transition",onClick:()=>n(t=>(t.set("page",(r.page-1).toString()),t)),disabled:r.page<=1,children:"Previous"}),e.jsxs("span",{className:"text-sm text-zinc-500 dark:text-zinc-400",children:["Page ",r.page," of ",r.pages||1]}),e.jsx("button",{className:"px-3 py-1.5 text-sm border border-zinc-200 dark:border-zinc-700 rounded-md hover:bg-zinc-50 dark:hover:bg-zinc-800 disabled:opacity-50 transition",onClick:()=>n(t=>(t.set("page",(r.page+1).toString()),t)),disabled:r.page>=r.pages,children:"Next"})]})]})]})});export{G as default};
