import{w as v,u as j,b as N,d as w}from"./chunk-JMJ3UQ3L-D6qeZyod.js";import{j as e,P as S}from"./vendor-puck-C9fWOLBg.js";import{a as z}from"./api-D1U4i9fn.js";import{a as t}from"./vendor-sentry-D-95zPX-.js";import{p as P}from"./puck-config-ixY1-ifD.js";import{E as k}from"./Dialogs-5SVcnpQt.js";import{A as g}from"./arrow-left-DJMYnRSG.js";import{E as y}from"./eye-CFAXC14I.js";import{S as E}from"./save-Ckn4PCZ8.js";import{u as C}from"./chunk-OT5FTIRN-B828R5Z6.js";import"./Modal-AfMv2c7i.js";import"./createLucideIcon-Qes_Sb9D.js";import"./index-B5GN05BP.js";import"./vendor-charts-8PN1tkI-.js";const G=v(function(){const{page:s,error:n}=j(),{getToken:u}=C(),o=N(),f=w(),[l,c]=t.useState(!1),[m,h]=t.useState(null),[d,b]=t.useState(s?.content||{root:{props:{}},content:[]}),[a,x]=t.useState({isOpen:!1,message:""}),p=async i=>{c(!0);try{const r=await u();await z(`/platform-pages/pages/${f.pageId}`,r,{method:"PUT",body:JSON.stringify({content:i})}),h(new Date)}catch(r){x({isOpen:!0,message:"Failed to save: "+r.message})}finally{c(!1)}};return n?e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg",children:["Error: ",n]}),e.jsxs("button",{onClick:()=>o("/admin/website"),className:"mt-4 text-blue-600 hover:underline flex items-center gap-2",children:[e.jsx(g,{size:16})," Back to Pages"]})]}):e.jsxs("div",{className:"h-screen flex flex-col",children:[e.jsx(k,{isOpen:a.isOpen,onClose:()=>x({...a,isOpen:!1}),message:a.message}),e.jsxs("div",{className:"bg-white border-b border-zinc-200 px-4 py-3 flex items-center justify-between z-50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>o("/admin/website"),className:"flex items-center gap-2 text-zinc-600 hover:text-zinc-900",children:[e.jsx(g,{size:18}),e.jsx("span",{className:"text-sm",children:"Back"})]}),e.jsx("div",{className:"h-6 w-px bg-zinc-200"}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-medium text-zinc-900",children:s?.title}),e.jsxs("p",{className:"text-xs text-zinc-500",children:["/",s?.slug," â€¢ Platform Page"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[m&&e.jsxs("span",{className:"text-xs text-zinc-400",children:["Saved ",m.toLocaleTimeString()]}),e.jsxs("button",{onClick:()=>{const i=s?.slug==="home"?"/":`/${s?.slug}`;window.open(i,"_blank")},className:"flex items-center gap-2 px-3 py-1.5 text-sm text-zinc-600 hover:bg-zinc-100 rounded-lg",children:[e.jsx(y,{size:16}),"Preview"]}),e.jsxs("button",{onClick:()=>p(d),disabled:l,className:"flex items-center gap-2 px-4 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(E,{size:16}),l?"Saving...":"Save"]})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(S,{config:P,data:d,onPublish:p,onChange:b})})]})});export{G as default};
