import{w as u,d as g,g as p}from"./chunk-JMJ3UQ3L-CSq87dux.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{C as t,a,b as n,d as i,c}from"./Card-IOiQbqBT.js";import{B as o}from"./Badge-BS0VuEA_.js";import{A as m}from"./activity-DPEUK82J.js";import{c as x}from"./createLucideIcon-pjmwgCcP.js";import{S as y}from"./shield-check-GNw2d3kk.js";import{C as N}from"./circle-check-big-9PYF1s1z.js";import{C as b}from"./circle-x-CE6Q7WKW.js";const w=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],v=x("database",w);const k=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],C=x("server",k),W=u(function(){const{env:h}=g(),r=p(),j=async()=>{r.load("/admin/diagnostics/run")},s=r.data,d=r.state==="loading";return e.jsxs("div",{className:"container mx-auto py-10 space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"System Diagnostics"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Real-time health checks and integration status."})]}),e.jsxs("button",{onClick:j,disabled:d,className:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background bg-zinc-900 text-white hover:bg-zinc-900/90 h-11 px-8",children:[d?e.jsx(m,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(m,{className:"mr-2 h-4 w-4"}),"Run Diagnostics"]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs(t,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Environment"}),e.jsx(C,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(i,{children:[e.jsx("div",{className:"text-2xl font-bold capitalize",children:h}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Running on Cloudflare Workers"})]})]}),e.jsxs(t,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"Database Latency"}),e.jsx(v,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(i,{children:s?.latency?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:[s.latency.database_read_ms||s.latency.database_ms,"ms"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Read check to D1"})]}):e.jsx("div",{className:"text-2xl font-bold text-muted-foreground",children:"-"})})]}),e.jsxs(t,{children:[e.jsxs(a,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(n,{className:"text-sm font-medium",children:"System Status"}),e.jsx(y,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(i,{children:s?e.jsx("div",{className:"flex items-center space-x-2",children:s.status==="ok"?e.jsx(o,{variant:"default",className:"bg-green-600 hover:bg-green-700",children:"Operational"}):e.jsx(o,{variant:"error",children:"Degraded"})}):e.jsx("div",{className:"text-2xl font-bold text-muted-foreground",children:"-"})})]})]}),s?.integrations&&e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsx(n,{children:"Integrations"}),e.jsx(c,{children:"Status of third-party connections"})]}),e.jsx(i,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.entries(s.integrations).map(([l,f])=>e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[e.jsx("span",{className:"capitalize font-medium",children:l.replace("_"," ")}),f?e.jsx(N,{className:"h-5 w-5 text-green-500"}):e.jsx(b,{className:"h-5 w-5 text-red-500"})]},l))})})]}),s?.worker&&e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsx(n,{children:"Worker Performance"}),e.jsx(c,{children:"Edge execution details"})]}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Memory Usage"}),e.jsxs("span",{className:"font-mono text-sm",children:[s.worker.memory_used_mb," MB"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"PoP (Point of Presence)"}),e.jsx("span",{className:"font-mono text-sm",children:s.worker.colo})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Region"}),e.jsxs("span",{className:"font-mono text-sm",children:[s.worker.city,", ",s.worker.country]})]})]})]}),e.jsxs(t,{children:[e.jsxs(a,{children:[e.jsx(n,{children:"Database Performance"}),e.jsx(c,{children:"D1 Read/Write Latency"})]}),e.jsxs(i,{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Read Latency"}),e.jsxs("span",{className:"font-mono text-sm",children:[s.latency?.database_read_ms," ms"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium",children:"Query Latency (Write/Mixed)"}),e.jsxs("span",{className:"font-mono text-sm",children:[s.latency?.database_query_ms," ms"]})]})]})]})]})]})});export{W as default};
