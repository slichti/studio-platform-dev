import{p as I,q as P,G as $,a as n,j as e,aG as b,K as D,az as z,a1 as E,aw as B,ag as y,aH as F,X as C,T as w,aI as R,aJ as G}from"./vendor-react-D59Q0YKK.js";import"./vendor-puck-RN2Ey-av.js";import"./vendor-charts-Dp-zC2wb.js";const S=[{id:"new_member",label:"New Member Signs Up",icon:z},{id:"class_booked",label:"Class Booked",icon:E},{id:"class_missed",label:"Class No-Show",icon:B},{id:"inactive_days",label:"Inactive for X Days",icon:y},{id:"birthday",label:"Member Birthday",icon:F},{id:"membership_expiring",label:"Membership Expiring",icon:y},{id:"product_purchase",label:"Product Purchased",icon:b},{id:"subscription_canceled",label:"Subscription Canceled (Period End)",icon:C},{id:"subscription_terminated",label:"Subscription Terminated",icon:w},{id:"student_updated",label:"Student Profile Updated",icon:z}],W=I(function(){const{automations:m,stats:i}=P(),c=$(),[d,r]=n.useState(!1),o=s=>{c({intent:"toggle",id:s},{method:"post"})},u=s=>{confirm("Delete this automation?")&&c({intent:"delete",id:s},{method:"post"})};return e.jsxs("div",{className:"flex flex-col h-full bg-zinc-50",children:[e.jsx("header",{className:"bg-white border-b border-zinc-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-violet-500 to-purple-600 rounded-lg text-white",children:e.jsx(b,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold text-zinc-900",children:"Automations"}),e.jsx("p",{className:"text-sm text-zinc-500",children:"Set up automated email & SMS campaigns"})]})]}),e.jsxs("button",{onClick:()=>r(!0),className:"px-4 py-2 bg-zinc-900 text-white rounded-lg text-sm font-medium hover:bg-zinc-800 flex items-center gap-2",children:[e.jsx(D,{size:16})," Create Automation"]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[i&&e.jsxs("div",{className:"grid grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-zinc-900",children:i.totalAutomations||0}),e.jsx("div",{className:"text-xs text-zinc-500",children:"Total Automations"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:i.activeCount||0}),e.jsx("div",{className:"text-xs text-zinc-500",children:"Active"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:i.emailsSent||0}),e.jsx("div",{className:"text-xs text-zinc-500",children:"Emails Sent (30d)"})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-zinc-200 p-4",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:i.smsSent||0}),e.jsx("div",{className:"text-xs text-zinc-500",children:"SMS Sent (30d)"})]})]}),m.length===0?e.jsxs("div",{className:"text-center py-20 bg-white rounded-xl border border-zinc-200",children:[e.jsx(b,{size:48,className:"mx-auto mb-4 text-zinc-300"}),e.jsx("p",{className:"text-zinc-500 mb-4",children:"No automations yet"}),e.jsx("button",{onClick:()=>r(!0),className:"text-sm text-zinc-900 underline",children:"Create your first"})]}):e.jsx("div",{className:"space-y-4",children:m.map(s=>{const a=S.find(h=>h.id===s.trigger),l=a?.icon||b;return e.jsx("div",{className:`bg-white rounded-xl border ${s.isActive?"border-green-200":"border-zinc-200"} p-5`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:`p-3 rounded-xl ${s.isActive?"bg-green-100":"bg-zinc-100"}`,children:e.jsx(l,{size:24,className:s.isActive?"text-green-600":"text-zinc-400"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold text-zinc-900",children:s.name}),e.jsx("span",{className:`px-2 py-0.5 rounded-full text-xs font-medium ${s.isActive?"bg-green-100 text-green-700":"bg-zinc-100 text-zinc-500"}`,children:s.isActive?"Active":"Paused"})]}),e.jsxs("p",{className:"text-sm text-zinc-500 mt-1",children:["Trigger: ",a?.label||s.trigger]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-zinc-400",children:[e.jsxs("span",{children:["Actions: ",s.actions?.length||0]}),e.jsxs("span",{children:["Runs: ",s.runCount||0]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>o(s.id),className:`p-2 rounded-lg ${s.isActive?"hover:bg-yellow-50 text-yellow-600":"hover:bg-green-50 text-green-600"}`,title:s.isActive?"Pause":"Activate",children:s.isActive?e.jsx(R,{size:16}):e.jsx(G,{size:16})}),e.jsx("button",{onClick:()=>u(s.id),className:"p-2 hover:bg-red-50 rounded-lg text-red-500",children:e.jsx(w,{size:16})})]})]})},s.id)})})]}),d&&e.jsx(U,{onClose:()=>r(!1),onSave:s=>{const a=new FormData;a.append("intent","create");for(const l of Object.keys(s))typeof s[l]=="object"?a.append(l,JSON.stringify(s[l])):a.append(l,s[l]);c(a,{method:"post"}),r(!1)}})]})});function U({onClose:N,onSave:m}){const[i,c]=n.useState(1),[d,r]=n.useState(""),[o,u]=n.useState("new_student"),[s,a]=n.useState("all"),[l,h]=n.useState(""),[g,k]=n.useState(""),[x,v]=n.useState("simple"),[j,A]=n.useState(""),[f,T]=n.useState(""),[p,M]=n.useState(""),_=()=>{const t={name:d,trigger:o,triggerConfig:{},actions:[],isActive:!0};s==="filter"&&(t.audienceFilter={},l&&(t.audienceFilter.ageMin=parseInt(l)),g&&(t.audienceFilter.ageMax=parseInt(g))),x==="template"?(t.templateId=p,t.subject=j||"Notification",t.content="Template: "+p):(t.subject=j,t.content=f),m(t)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-lg w-full animate-in fade-in zoom-in duration-200",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-200 flex justify-between items-center",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Create Automation"}),e.jsx("button",{onClick:N,children:e.jsx(C,{size:20,className:"text-zinc-400 hover:text-zinc-600"})})]}),e.jsxs("div",{className:"p-6",children:[i===1&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Automation Name"}),e.jsx("input",{type:"text",value:d,onChange:t=>r(t.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg",placeholder:"e.g., Welcome Series"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-2",children:"Trigger"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 h-64 overflow-y-auto",children:S.map(t=>e.jsxs("button",{onClick:()=>u(t.id),className:`p-3 rounded-lg border text-left flex items-center gap-2 ${o===t.id?"border-purple-500 bg-purple-50":"border-zinc-200 hover:bg-zinc-50"}`,children:[e.jsx(t.icon,{size:16,className:o===t.id?"text-purple-600":"text-zinc-400"}),e.jsx("span",{className:"text-sm",children:t.label})]},t.id))})]})]}),i===2&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium text-zinc-900",children:"Audience Targeting"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"aud",checked:s==="all",onChange:()=>a("all")}),e.jsx("span",{children:"All Members"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",name:"aud",checked:s==="filter",onChange:()=>a("filter")}),e.jsx("span",{children:"Filtered"})]})]}),s==="filter"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 p-4 bg-zinc-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-500 mb-1",children:"Min Age"}),e.jsx("input",{type:"number",value:l,onChange:t=>h(t.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg",placeholder:"18"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-zinc-500 mb-1",children:"Max Age"}),e.jsx("input",{type:"number",value:g,onChange:t=>k(t.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg",placeholder:"65"})]})]})]}),i===3&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-medium text-zinc-900",children:"Email Content"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Subject Line"}),e.jsx("input",{type:"text",value:j,onChange:t=>A(t.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg",placeholder:"Welcome!"})]}),e.jsxs("div",{className:"flex gap-4 border-b border-zinc-100 pb-2",children:[e.jsx("button",{onClick:()=>v("simple"),className:`pb-2 text-sm font-medium ${x==="simple"?"text-purple-600 border-b-2 border-purple-600":"text-zinc-500"}`,children:"Simple Text"}),e.jsx("button",{onClick:()=>v("template"),className:`pb-2 text-sm font-medium ${x==="template"?"text-purple-600 border-b-2 border-purple-600":"text-zinc-500"}`,children:"Resend Template"})]}),x==="simple"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Message Body"}),e.jsx("textarea",{value:f,onChange:t=>T(t.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg h-32",placeholder:"Start typing... Use {{firstName}} for variables."})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Template ID"}),e.jsx("input",{type:"text",value:p,onChange:t=>M(t.target.value),className:"w-full px-3 py-2 border border-zinc-200 rounded-lg",placeholder:"re_123456789"}),e.jsxs("p",{className:"text-xs text-zinc-500 mt-1",children:["Variables sent: generic data + ",e.jsx("code",{children:"title"}),", ",e.jsx("code",{children:"address"}),", ",e.jsx("code",{children:"firstName"}),", ",e.jsx("code",{children:"couponCode"}),"."]})]})]})]}),e.jsxs("div",{className:"p-4 border-t border-zinc-200 flex justify-between",children:[i>1&&e.jsx("button",{onClick:()=>c(i-1),className:"px-4 py-2 text-sm text-zinc-500",children:"Back"}),i<3?e.jsx("button",{onClick:()=>c(i+1),disabled:!d&&i===1,className:"ml-auto px-4 py-2 bg-zinc-900 text-white rounded-lg text-sm disabled:opacity-50",children:"Next"}):e.jsx("button",{onClick:_,disabled:x==="simple"?!f:!p,className:"ml-auto px-4 py-2 bg-zinc-900 text-white rounded-lg text-sm disabled:opacity-50",children:"Create Automation"})]})]})})}export{W as default};
