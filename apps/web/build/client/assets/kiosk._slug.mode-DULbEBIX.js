import{w,d as b,g as v,b as y}from"./chunk-JMJ3UQ3L-D5-P_Fux.js";import{j as e}from"./vendor-puck-Ox9nZAW8.js";import{a as n}from"./vendor-sentry-JepEA2vj.js";import{t as f}from"./index-Cb5OqxoU.js";import{S as p}from"./search-DuKLkEI3.js";import{C as z}from"./circle-x-CTW3GYJg.js";import{U as C}from"./user-DrfMgmZN.js";import{C as I}from"./calendar-vWMk9t_Y.js";import{C as $}from"./circle-check-big-CSQBoMuh.js";import"./createLucideIcon-CZ3UnH4h.js";const F=w(function(){const{tenant:k}=b(),s=v(),l=y(),[o,d]=n.useState(""),[x,r]=n.useState([]),[j,m]=n.useState(!1),[h,g]=n.useState(null);n.useEffect(()=>{localStorage.getItem(`kiosk_token_${s.slug}`)||l(`/kiosk/${s.slug}/login`)},[s.slug,l]),n.useEffect(()=>{const t=setTimeout(async()=>{if(o.length<2){r([]);return}m(!0);try{const a=localStorage.getItem(`kiosk_token_${s.slug}`),i=window.ENV.API_URL,c=await fetch(`${i}/kiosk/search?q=${encodeURIComponent(o)}`,{headers:{Authorization:`Bearer ${a}`}});if(c.status===401){l(`/kiosk/${s.slug}/login`);return}const u=await c.json();r(Array.isArray(u)?u:[])}catch(a){console.error(a)}finally{m(!1)}},300);return()=>clearTimeout(t)},[o,s.slug,l]);const N=async(t,a)=>{g(t);try{const i=localStorage.getItem(`kiosk_token_${s.slug}`),c=window.ENV.API_URL;if(!(await fetch(`${c}/kiosk/checkin/${t}`,{method:"POST",headers:{Authorization:`Bearer ${i}`}})).ok)throw new Error("Check-in failed");f.success(`Welcome, ${a}!`),setTimeout(()=>{d(""),r([])},2e3)}catch{f.error("Could not check in. Please see desk.")}finally{g(null)}};return e.jsxs("div",{className:"h-full flex flex-col items-center pt-20 px-6 max-w-2xl mx-auto",children:[e.jsxs("h1",{className:"text-4xl font-bold mb-2",children:["Welcome to ",k.name]}),e.jsx("p",{className:"text-zinc-500 mb-10 text-lg",children:"Search for your name to check in."}),e.jsxs("div",{className:"relative w-full mb-12",children:[e.jsx(p,{className:"absolute left-6 top-1/2 -translate-y-1/2 h-8 w-8 text-zinc-400"}),e.jsx("input",{type:"text",autoFocus:!0,value:o,onChange:t=>d(t.target.value),placeholder:"Type your name...",className:"w-full h-20 pl-20 pr-6 rounded-2xl border-2 border-zinc-200 dark:border-zinc-800 bg-white dark:bg-zinc-800 shadow-sm text-2xl outline-none focus:border-purple-500 focus:ring-4 focus:ring-purple-500/20 transition-all"}),o&&e.jsx("button",{onClick:()=>{d(""),r([])},className:"absolute right-6 top-1/2 -translate-y-1/2 p-2 hover:bg-zinc-100 dark:hover:bg-zinc-700 rounded-full",children:e.jsx(z,{className:"h-6 w-6 text-zinc-400"})})]}),e.jsx("div",{className:"w-full space-y-4",children:x.map(t=>e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl p-4 shadow-sm flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-zinc-100 dark:bg-zinc-800 rounded-full flex items-center justify-center overflow-hidden",children:t.portraitUrl?e.jsx("img",{src:t.portraitUrl,alt:"",className:"w-full h-full object-cover"}):e.jsx(C,{className:"h-6 w-6 text-zinc-400"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-lg",children:[t.firstName," ",t.lastName]}),t.nextBooking?e.jsxs("div",{className:"flex items-center gap-2 text-green-600 text-sm font-medium",children:[e.jsx(I,{className:"h-4 w-4"}),t.nextBooking.className]}):e.jsx("div",{className:"text-zinc-400 text-sm",children:"No bookings today"})]})]}),e.jsx("div",{children:t.nextBooking?t.nextBooking.checkedInAt?e.jsxs("div",{className:"px-4 py-2 bg-green-100 text-green-700 rounded-lg font-medium flex items-center gap-2",children:[e.jsx($,{className:"h-5 w-5"}),"Checked In"]}):e.jsx("button",{onClick:()=>N(t.nextBooking.id,t.firstName),disabled:!!h,className:"bg-purple-600 hover:bg-purple-700 text-white px-6 py-3 rounded-lg font-bold text-lg shadow-sm active:scale-95 transition-all disabled:opacity-50",children:h===t.nextBooking.id?"...":"Check In"}):e.jsx("span",{className:"text-zinc-400 text-sm font-medium",children:"See Front Desk"})})]},t.memberId))}),x.length===0&&o.length>2&&!j&&e.jsxs("div",{className:"text-zinc-400 mt-10 flex flex-col items-center",children:[e.jsx(p,{className:"h-12 w-12 mb-4 opacity-50"}),e.jsxs("p",{children:['No students found matching "',o,'"']})]})]})});export{F as default};
