import{w as N,c as z,d as w,r as u,L as c}from"./chunk-JMJ3UQ3L-Cjm2z498.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{a as y}from"./api-D1U4i9fn.js";import{M as C}from"./Modal-AFqyleoL.js";import{M as S}from"./message-circle-B08tYoH5.js";import{S as k}from"./settings-DTx71_I0.js";import{E as T}from"./external-link-BjQ6m7h_.js";import{U as E}from"./user-B7iYjdF9.js";import{S as M}from"./shield-A-2rOIlb.js";import{P as A}from"./plus-DEHhyUAe.js";import"./createLucideIcon-DkPcMMCg.js";const R=N(function(){const{rooms:r,tenant:p,token:h,error:d}=z(),{slug:i}=w(),[f,n]=u.useState(!1),[t,a]=u.useState(p?.settings?.chatConfig||{timezone:"UTC",offlineEmail:"",schedule:{Mon:["09:00","17:00"],Tue:["09:00","17:00"],Wed:["09:00","17:00"],Thu:["09:00","17:00"],Fri:["09:00","17:00"]}}),g=async()=>{try{await y("/tenant/settings",h,{method:"PATCH",body:JSON.stringify({settings:{chatConfig:t}})}),n(!1)}catch{alert("Failed to save settings")}},o=(s,b)=>{const j=["Mon","Tue","Wed","Thu","Fri"],m={...t.schedule};j.forEach(v=>{m[v]=[s,b]}),a({...t,schedule:m})};if(d)return e.jsxs("div",{className:"p-8 text-red-600",children:["Error: ",d]});const l=r.filter(s=>s.metadata?.source==="widget"||s.customerEmail),x=r.filter(s=>!s.customerEmail&&s.metadata?.source!=="widget");return e.jsxs("div",{className:"p-8 max-w-6xl mx-auto h-full flex flex-col",children:[e.jsxs("div",{className:"mb-8 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-zinc-900 flex items-center gap-2",children:[e.jsx(S,{className:"text-blue-600"}),"Messages"]}),e.jsx("p",{className:"text-zinc-500 mt-1",children:"Manage customer support inquiries and platform tickets"})]}),e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>n(!0),className:"flex items-center gap-2 text-sm text-zinc-600 hover:text-zinc-900 mr-4",children:[e.jsx(k,{size:14}),"Chat Settings"]}),e.jsxs(c,{to:`/embed/${i}/chat`,target:"_blank",className:"flex items-center gap-2 text-sm text-blue-600 hover:underline",children:[e.jsx(T,{size:14}),"Test Widget"]})]})]}),e.jsx(C,{isOpen:f,onClose:()=>n(!1),title:"Chat Settings",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Offline Email"}),e.jsx("input",{type:"email",className:"w-full border border-zinc-300 rounded-lg p-2 text-sm",placeholder:"support@example.com",value:t.offlineEmail,onChange:s=>a({...t,offlineEmail:s.target.value})}),e.jsx("p",{className:"text-xs text-zinc-500 mt-1",children:"Visitors will be asked to email this address when you are offline."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Timezone"}),e.jsxs("select",{className:"w-full border border-zinc-300 rounded-lg p-2 text-sm",value:t.timezone,onChange:s=>a({...t,timezone:s.target.value}),children:[e.jsx("option",{value:"UTC",children:"UTC"}),e.jsx("option",{value:"America/New_York",children:"Eastern Time (US)"}),e.jsx("option",{value:"America/Chicago",children:"Central Time (US)"}),e.jsx("option",{value:"America/Denver",children:"Mountain Time (US)"}),e.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (US)"}),e.jsx("option",{value:"Europe/London",children:"London (UK)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 mb-1",children:"Weekday Hours (Mon-Fri)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"time",className:"border border-zinc-300 rounded-lg p-2 text-sm",value:t.schedule?.Mon?.[0]||"09:00",onChange:s=>o(s.target.value,t.schedule?.Mon?.[1]||"17:00")}),e.jsx("span",{className:"text-zinc-400",children:"to"}),e.jsx("input",{type:"time",className:"border border-zinc-300 rounded-lg p-2 text-sm",value:t.schedule?.Mon?.[1]||"17:00",onChange:s=>o(t.schedule?.Mon?.[0]||"09:00",s.target.value)})]})]}),e.jsx("div",{className:"pt-4 flex justify-end",children:e.jsx("button",{onClick:g,className:"bg-blue-600 text-white px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-700",children:"Save Settings"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-zinc-200 overflow-hidden flex flex-col h-[600px]",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-200 bg-zinc-50 flex justify-between items-center",children:[e.jsxs("h2",{className:"font-semibold text-zinc-900 flex items-center gap-2",children:[e.jsx(E,{size:18,className:"text-blue-600"}),"Customer Inquiries"]}),e.jsx("span",{className:"text-xs bg-zinc-200 text-zinc-600 px-2 py-0.5 rounded-full",children:l.length})]}),e.jsx("div",{className:"flex-1 overflow-y-auto divide-y divide-zinc-100",children:l.length===0?e.jsx("div",{className:"p-8 text-center text-zinc-500 text-sm",children:"No customer messages yet."}):l.map(s=>e.jsxs(c,{to:`/studio/${i}/chat/${s.id}`,className:"block p-4 hover:bg-zinc-50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:"font-medium text-zinc-900",children:s.name}),e.jsx("span",{className:"text-xs text-zinc-400",children:new Date(s.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-zinc-500",children:[s.customerEmail&&e.jsx("span",{children:s.customerEmail}),e.jsx("span",{className:`px-1.5 py-0.5 rounded capitalize ${s.status==="open"?"bg-green-100 text-green-700":s.status==="closed"?"bg-zinc-100 text-zinc-500":"bg-blue-50 text-blue-700"}`,children:s.status||"open"})]})]},s.id))})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-zinc-200 overflow-hidden flex flex-col h-[600px]",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-200 bg-zinc-50 flex justify-between items-center",children:[e.jsxs("h2",{className:"font-semibold text-zinc-900 flex items-center gap-2",children:[e.jsx(M,{size:18,className:"text-purple-600"}),"Platform Support Tickets"]}),e.jsxs("button",{className:"text-xs flex items-center gap-1 bg-purple-100 text-purple-700 px-2 py-1 rounded hover:bg-purple-200 transition-colors",children:[e.jsx(A,{size:12}),"New Ticket"]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto divide-y divide-zinc-100",children:x.length===0?e.jsx("div",{className:"p-8 text-center text-zinc-500 text-sm",children:"No active support tickets with Platform Admin."}):x.map(s=>e.jsxs(c,{to:`/studio/${i}/chat/${s.id}`,className:"block p-4 hover:bg-zinc-50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:"font-medium text-zinc-900",children:s.name}),e.jsx("span",{className:"text-xs text-zinc-400",children:new Date(s.createdAt).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-zinc-500",children:[e.jsx("span",{className:`px-1.5 py-0.5 rounded capitalize ${s.status==="open"?"bg-green-100 text-green-700":s.status==="closed"?"bg-zinc-100 text-zinc-500":"bg-blue-50 text-blue-700"}`,children:s.status||"open"}),s.assignedToId&&e.jsx("span",{className:"bg-purple-50 text-purple-700 px-1.5 py-0.5 rounded",children:"Assigned"})]})]},s.id))})]})]})]})});export{R as default};
