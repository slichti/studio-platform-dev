import{w as k,v as y,r as i}from"./chunk-JMJ3UQ3L-BbiJBYoX.js";import{j as e}from"./jsx-runtime-u17CrQMm.js";import{a as m}from"./api-piI5qlNr.js";import{M as w}from"./Modal-BOLa-nOz.js";import{P as C}from"./plus-CFavzZjE.js";import{S}from"./search-DWKTImQn.js";import{M as L}from"./mail-BH-ldGQc.js";import{c as A}from"./createLucideIcon-DiSUMwKo.js";import{C as M}from"./clock-DqjrEi5j.js";import{C as O}from"./circle-alert-B1V5VnQn.js";import{f as T}from"./format-gSCb7gQz.js";const P=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],D=A("phone",P),B=k(function(){const{leads:g,token:l,slug:d}=y(),[u,p]=i.useState(g),[f,c]=i.useState(!1),[h,b]=i.useState(!1),[o,z]=i.useState(""),[s,r]=i.useState({firstName:"",lastName:"",email:"",phone:"",source:"",notes:""}),j=async t=>{t.preventDefault(),b(!0);try{const a=await m("/leads",l,{method:"POST",headers:{"X-Tenant-Slug":d},body:JSON.stringify(s)});if(a.error)alert(a.error);else{const n=await m("/leads",l,{headers:{"X-Tenant-Slug":d}});p(n.leads||[]),c(!1),r({firstName:"",lastName:"",email:"",phone:"",source:"",notes:""})}}catch(a){alert("Failed to create lead: "+a.message)}finally{b(!1)}},N=async(t,a)=>{p(u.map(n=>n.id===t?{...n,status:a}:n));try{await m(`/leads/${t}`,l,{method:"PATCH",headers:{"X-Tenant-Slug":d},body:JSON.stringify({status:a})})}catch(n){console.error(n)}},x=u.filter(t=>t.email.toLowerCase().includes(o.toLowerCase())||(t.firstName+" "+t.lastName).toLowerCase().includes(o.toLowerCase())),v=t=>{switch(t){case"new":return"bg-blue-100 text-blue-800";case"contacted":return"bg-yellow-100 text-yellow-800";case"trialing":return"bg-purple-100 text-purple-800";case"converted":return"bg-green-100 text-green-800";case"lost":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"p-8 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-zinc-900 dark:text-zinc-100",children:"Leads CRM"}),e.jsx("p",{className:"text-zinc-500 dark:text-zinc-400 mt-1",children:"Track and manage prospective students."})]}),e.jsxs("button",{onClick:()=>c(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-blue-700 flex items-center gap-2 shadow-sm transition-all hover:translate-y-[-1px]",children:[e.jsx(C,{size:18}),"Add New Lead"]})]}),e.jsxs("div",{className:"bg-white dark:bg-zinc-900 border border-zinc-200 dark:border-zinc-800 rounded-xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-zinc-200 dark:border-zinc-800 flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(S,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-zinc-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search leads...",value:o,onChange:t=>z(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-zinc-300 dark:border-zinc-700 rounded-lg text-sm bg-zinc-50 dark:bg-zinc-800 focus:ring-2 focus:ring-blue-500 outline-none"})]}),e.jsxs("div",{className:"text-sm text-zinc-500",children:[x.length," leads found"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-zinc-50 dark:bg-zinc-800/50 border-b border-zinc-200 dark:border-zinc-800",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 uppercase tracking-wider",children:"Source"}),e.jsx("th",{className:"px-6 py-3 text-xs font-semibold text-zinc-500 uppercase tracking-wider",children:"Added"})]})}),e.jsxs("tbody",{className:"divide-y divide-zinc-100 dark:divide-zinc-800",children:[x.map(t=>e.jsxs("tr",{className:"hover:bg-zinc-50 dark:hover:bg-zinc-800/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center font-bold text-xs uppercase",children:[t.firstName?.[0],t.lastName?.[0]]}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium text-zinc-900 dark:text-zinc-100",children:[t.firstName," ",t.lastName]}),t.notes&&e.jsx("div",{className:"text-xs text-zinc-400 truncate max-w-[200px]",title:t.notes,children:t.notes})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col gap-1 text-sm text-zinc-600 dark:text-zinc-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{size:14,className:"text-zinc-400"}),e.jsx("span",{children:t.email})]}),t.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(D,{size:14,className:"text-zinc-400"}),e.jsx("span",{children:t.phone})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("select",{value:t.status,onChange:a=>N(t.id,a.target.value),className:`text-xs font-bold uppercase px-2 py-1 rounded border-none outline-none cursor-pointer focus:ring-2 focus:ring-blue-500/50 ${v(t.status)}`,children:[e.jsx("option",{value:"new",children:"New"}),e.jsx("option",{value:"contacted",children:"Contacted"}),e.jsx("option",{value:"trialing",children:"Trialing"}),e.jsx("option",{value:"converted",children:"Converted"}),e.jsx("option",{value:"lost",children:"Lost"})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-zinc-600 dark:text-zinc-400",children:t.source?e.jsx("span",{className:"bg-zinc-100 dark:bg-zinc-800 px-2 py-1 rounded text-xs border border-zinc-200 dark:border-zinc-700",children:t.source}):e.jsx("span",{className:"text-zinc-400 text-xs italic",children:"Unknown"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-zinc-500",children:e.jsxs("div",{className:"flex items-center gap-1",title:new Date(t.createdAt).toLocaleString(),children:[e.jsx(M,{size:14,className:"text-zinc-400"}),T(new Date(t.createdAt),"MMM d")]})})]},t.id)),x.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-12 text-center text-zinc-500",children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx(O,{size:32,className:"text-zinc-300"}),e.jsx("p",{children:"No leads found matching your criteria."})]})})})]})]})})]}),e.jsx(w,{isOpen:f,onClose:()=>c(!1),title:"Add New Lead",children:e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"First Name"}),e.jsx("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-zinc-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100",value:s.firstName,onChange:t=>r({...s,firstName:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Last Name"}),e.jsx("input",{type:"text",className:"w-full px-3 py-2 border border-zinc-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100",value:s.lastName,onChange:t=>r({...s,lastName:t.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",required:!0,className:"w-full px-3 py-2 border border-zinc-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100",value:s.email,onChange:t=>r({...s,email:t.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Phone (Optional)"}),e.jsx("input",{type:"tel",className:"w-full px-3 py-2 border border-zinc-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100",value:s.phone,onChange:t=>r({...s,phone:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Source"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-zinc-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100",value:s.source,onChange:t=>r({...s,source:t.target.value}),children:[e.jsx("option",{value:"",children:"Select source..."}),e.jsx("option",{value:"Walk-in",children:"Walk-in"}),e.jsx("option",{value:"Website",children:"Website"}),e.jsx("option",{value:"Referral",children:"Referral"}),e.jsx("option",{value:"Social Media",children:"Social Media"}),e.jsx("option",{value:"Other",children:"Other"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-zinc-700 dark:text-zinc-300 mb-1",children:"Notes"}),e.jsx("textarea",{className:"w-full px-3 py-2 border border-zinc-300 dark:border-zinc-700 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none h-24 bg-white dark:bg-zinc-800 text-zinc-900 dark:text-zinc-100",value:s.notes,onChange:t=>r({...s,notes:t.target.value}),placeholder:"Interests, goals, availability..."})]}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>c(!1),className:"flex-1 px-4 py-2 border border-zinc-300 dark:border-zinc-700 text-zinc-700 dark:text-zinc-300 rounded-lg hover:bg-zinc-50 dark:hover:bg-zinc-800 font-medium transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:h,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium disabled:opacity-50",children:h?"Adding...":"Add Lead"})]})]})})]})});export{B as default};
